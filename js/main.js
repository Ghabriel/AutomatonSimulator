var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)};define("lists/MachineList",["require","exports"],function(t,e){"use strict";!function(t){t[t.FA=0]="FA",t[t.PDA=1]="PDA",t[t.LBA=2]="LBA"}(e.Machine||(e.Machine={}));e.Machine}),define("Browser",["require","exports"],function(t,e){"use strict";var i;!function(t){function e(){var t=navigator.userAgent.toLowerCase(),e=function(e){return e.test(t)},i={msie:e(/msie/)||e(/trident/),edge:e(/edge/),firefox:e(/mozilla/)&&e(/firefox/),chrome:e(/webkit/)&&e(/chrome/)&&!e(/edge/),safari:e(/safari/)&&e(/applewebkit/)&&!e(/chrome/),opera:e(/opera/)},n="",s="Unknown";for(var r in i)if(i.hasOwnProperty(r)&&i[r]){n=r;var o=new RegExp(r+"( |/)([0-9]+)"),a=t.match(o);a?s=a[2]:(a=t.match(/rv:([0-9]+)/))&&(s=a[1])}return{name:n,version:s}}var i=e();t.name=i.name,t.version=i.version}(i=e.Browser||(e.Browser={}))}),define("interface/Renderer",["require","exports"],function(t,e){"use strict";var i=function(){function t(){}return t.prototype.bind=function(t){this.node=t,this.onBind()},t.prototype.render=function(){this.node&&this.onRender()},t.prototype.onBind=function(){},t}();e.Renderer=i}),define("StatePalette",["require","exports"],function(t,e){"use strict"}),define("Utils",["require","exports"],function(t,e){"use strict";var i;!function(t){function e(t){return document.querySelector(t)}function i(t){return e("#"+t)}function n(t,e){var i=document.createElement(t);return e&&this.foreach(e,function(t,e){"click"==t?i.addEventListener("click",e):i[t]=e}),i}function s(t,e){for(var i in t)if(t.hasOwnProperty(i)&&e(i,t[i])===!1)break}function r(t){return"which"in t?3==t.which:"button"in t?2==t.button:(console.log("[WARNING] Right click events will not work properly in this browser."),!1)}function o(t,e,i,n){return"M"+t+" "+e+" L"+i+" "+n}function a(t,e,i,n,s){var r=t.path(this.linePath(e,i,n,s));return r.attr("stroke","black"),r}function l(t){return t*Math.PI/180}function u(t){return 180*t/Math.PI}function c(t,e,i){var n=Math.sin(i),s=Math.cos(i),r={x:t.x,y:t.y};r.x-=e.x,r.y-=e.y;var o={x:r.x*s-r.y*n,y:r.x*n+r.y*s};return{x:o.x+e.x,y:o.y+e.y}}function h(t,e){return t&&e&&t.x==e.x&&t.y==e.y}function p(t){setTimeout(t,0)}function d(t){return t.join(" ").toLowerCase()}function g(t){return t.length<=1}function f(t){return 1==t.length}t.select=e,t.id=i,t.create=n,t.foreach=s,t.isRightClick=r,t.linePath=o,t.line=a,t.toRadians=l,t.toDegrees=u,t.rotatePoint=c,t.samePoint=h,t.async=p,t.printShortcut=d,t.optionalSymbolValidator=g,t.singleSymbolValidator=f}(i=e.utils||(e.utils={}))}),define("interface/State",["require","exports","Browser","Settings","Utils"],function(t,e,i,n,s){"use strict";var r=function(){function t(){this.initial=!1,this.final=!1,this.name="",this.initialMarkOffsets=[],this.defaultPalette={fillColor:n.Settings.stateFillColor,strokeColor:n.Settings.stateStrokeColor,strokeWidth:n.Settings.stateStrokeWidth,ringStrokeWidth:n.Settings.stateRingStrokeWidth},this.palette=this.defaultPalette,this.body=null,this.ring=null,this.arrowParts=[],this.textContainer=null,this.radius=n.Settings.stateRadius}return t.prototype.setPosition=function(t,e){this.x=t,this.y=e},t.prototype.getPosition=function(){return{x:this.x,y:this.y}},t.prototype.setInitial=function(t){this.initial=t},t.prototype.isInitial=function(){return this.initial},t.prototype.setFinal=function(t){this.final=t},t.prototype.isFinal=function(){return this.final},t.prototype.setName=function(t){this.name=t},t.prototype.getName=function(){return this.name},t.prototype.applyPalette=function(t){this.palette=t},t.prototype.removePalette=function(){this.palette=this.defaultPalette},t.prototype.remove=function(){this.body&&(this.body.remove(),this.body=null),this.ring&&(this.ring.remove(),this.ring=null);for(var t=0,e=this.arrowParts;t<e.length;t++){var i=e[t];i.remove()}this.arrowParts=[],this.textContainer&&(this.textContainer.remove(),this.textContainer=null)},t.prototype.render=function(t){this.renderBody(t),this.renderInitialMark(t),this.renderFinalMark(t),this.renderText(t)},t.prototype.node=function(){return this.body},t.prototype.html=function(){return this.body?this.body.node:null},t.prototype.drag=function(t,e){var n,s=this,r=function(t,e,i){var n=s.getPosition();return this.ox=n.x,this.oy=n.y,null},o=0;n="chrome"==i.Browser.name?3:4;var a=function(e,i,r,a,l){return s.setVisualPosition(this.ox+e,this.oy+i),0==o&&t.call(this,l),o=(o+1)%n,null},l=function(i){var n=s.getPosition(),r=n.x-this.ox,o=n.y-this.oy,a=r*r+o*o,l=e.call(this,a,i);return l||0==r&&0==o||s.setVisualPosition(this.ox,this.oy),t.call(this,i),null};this.body.drag(a,r,l),this.textContainer&&this.textContainer.drag(a,r,l)},t.prototype.fillColor=function(){return this.palette.fillColor},t.prototype.strokeColor=function(){return this.palette.strokeColor},t.prototype.strokeWidth=function(){return this.palette.strokeWidth},t.prototype.ringStrokeWidth=function(){return this.palette.ringStrokeWidth},t.prototype.renderBody=function(t){this.body?this.body.attr({cx:this.x,cy:this.y}):this.body=t.circle(this.x,this.y,this.radius),this.body.attr("fill",this.fillColor()),this.body.attr("stroke",this.strokeColor()),this.body.attr("stroke-width",this.strokeWidth())},t.prototype.updateInitialMarkOffsets=function(){if(!this.initialMarkOffsets.length){var t=n.Settings.stateInitialMarkLength,e=this.x-this.radius,i=this.y,r=n.Settings.stateInitialMarkHeadLength,o=n.Settings.stateInitialMarkAngle,a=1-r/t,l={x:e-t+a*t,y:i},u={x:e,y:i},c=s.utils.rotatePoint(l,u,o),h=s.utils.rotatePoint(l,u,-o);this.initialMarkOffsets=[{x:c.x-e,y:c.y-i},{x:h.x-e,y:h.y-i}]}},t.prototype.renderInitialMark=function(t){if(this.initial){var e=n.Settings.stateInitialMarkLength,i=this.x-this.radius,r=this.y;if(this.arrowParts.length){var o=this.arrowParts,a=o[0],l=o[1],u=o[2];a.attr("path",s.utils.linePath(i-e,r,i,r)),this.updateInitialMarkOffsets();var c=this.initialMarkOffsets[0],h=this.initialMarkOffsets[1];l.attr("path",s.utils.linePath(c.x+i,c.y+r,i,r)),u.attr("path",s.utils.linePath(h.x+i,h.y+r,i,r))}else{var p=n.Settings.stateInitialMarkColor,d=n.Settings.stateInitialMarkThickness,a=s.utils.line(t,i-e,r,i,r);a.attr("stroke",p),a.attr("stroke-width",d),this.updateInitialMarkOffsets();var c=this.initialMarkOffsets[0],h=this.initialMarkOffsets[1],l=s.utils.line(t,c.x+i,c.y+r,i,r);l.attr("stroke",p),l.attr("stroke-width",d);var u=s.utils.line(t,h.x+i,h.y+r,i,r);u.attr("stroke",p),u.attr("stroke-width",d);var o=this.arrowParts;o.push(a),o.push(l),o.push(u)}}else for(var o=this.arrowParts;o.length;)o[o.length-1].remove(),o.pop()},t.prototype.renderFinalMark=function(t){this.final?(this.ring?this.ring.attr({cx:this.x,cy:this.y}):this.ring=t.circle(this.x,this.y,n.Settings.stateRingRadius),this.ring.attr("stroke",this.strokeColor()),this.ring.attr("stroke-width",this.ringStrokeWidth())):this.ring&&(this.ring.remove(),this.ring=null)},t.prototype.renderText=function(t){this.textContainer?(this.textContainer.attr("x",this.x),this.textContainer.attr("y",this.y),this.textContainer.attr("text",this.name)):(this.textContainer=t.text(this.x,this.y,this.name),this.textContainer.attr("font-family",n.Settings.stateLabelFontFamily),this.textContainer.attr("font-size",n.Settings.stateLabelFontSize),this.textContainer.attr("stroke",n.Settings.stateLabelFontColor),this.textContainer.attr("fill",n.Settings.stateLabelFontColor))},t.prototype.setVisualPosition=function(t,e){this.setPosition(t,e),this.body.attr({cx:t,cy:e}),this.ring&&this.ring.attr({cx:t,cy:e}),this.initial&&this.renderInitialMark(),this.renderText()},t}();e.State=r}),define("Controller",["require","exports"],function(t,e){"use strict"}),define("datastructures/Queue",["require","exports"],function(t,e){"use strict";var i=function(){function t(){this.data=[],this.pointer=0}return t.prototype.push=function(t){this.data.push(t)},t.prototype.front=function(){return this.data[this.pointer]},t.prototype.pop=function(){var t=this.front();return this.pointer++,this.pointer>=this.size()/2&&(this.data=this.data.slice(this.pointer),this.pointer=0),t},t.prototype.clear=function(){this.data=[],this.pointer=0},t.prototype.empty=function(){return 0==this.size()},t.prototype.size=function(){return this.data.length-this.pointer},t}();e.Queue=i}),define("datastructures/UnorderedSet",["require","exports"],function(t,e){"use strict";var i=function(){function t(){this.data={},this.count=0}return t.prototype.insert=function(t){this.contains(t)||this.count++,this.data[t]=!0,this.type=typeof t},t.prototype.erase=function(t){this.contains(t)&&this.count--,delete this.data[t]},t.prototype.contains=function(t){return!!this.data[t]},t.prototype.clear=function(){this.data={},this.count=0},t.prototype.empty=function(){return 0==this.size()},t.prototype.size=function(){return this.count},t.prototype.forEach=function(t){for(var e in this.data)if(this.data.hasOwnProperty(e)){var i=e;if("number"==this.type&&(i=parseFloat(e)),t(i)===!1)break}},t.prototype.asList=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t}();e.UnorderedSet=i}),define("machines/FA/FA",["require","exports","datastructures/Queue","datastructures/UnorderedSet","Utils"],function(t,e,i,n,s){"use strict";var r=function(){function t(){this.stateList=[],this.alphabetSet={},this.transitions={},this.epsilonTransitions={},this.initialState=-1,this.finalStates=new n.UnorderedSet,this.numRemovedStates=0,this.currentStates=new n.UnorderedSet}return t.prototype.addState=function(t){this.stateList.push(t);var e=this.realNumStates()-1;return this.transitions[e]={},this.epsilonTransitions[e]=new n.UnorderedSet,this.initialState==-1&&(this.initialState=e,this.reset()),e},t.prototype.removeState=function(t){var e=this;s.utils.foreach(this.transitions,function(i,n){var r=parseInt(i);s.utils.foreach(n,function(i){n[i].contains(t)&&e.removeTransition(r,t,i),r==t&&n[i].forEach(function(n){e.removeTransition(t,n,i)})})}),delete this.transitions[t],this.initialState==t&&this.unsetInitialState(),this.finalStates.erase(t),this.stateList[t]=void 0,this.numRemovedStates++},t.prototype.renameState=function(t,e){this.stateList[t]=e},t.prototype.addTransition=function(t,e,i){var s=this.transitions[t];""==i?this.epsilonTransitions[t].insert(e):(s.hasOwnProperty(i)||(s[i]=new n.UnorderedSet),s[i].insert(e),this.alphabetSet.hasOwnProperty(i)||(this.alphabetSet[i]=0),this.alphabetSet[i]++)},t.prototype.removeTransition=function(t,e,i){var n=this.transitions[t];if(""==i){var s=this.epsilonTransitions;s[t].erase(e),s[i].empty()&&delete s[i]}else n.hasOwnProperty(i)&&(n[i].erase(e),n[i].empty()&&delete n[i],this.alphabetSet[i]--,0==this.alphabetSet[i]&&delete this.alphabetSet[i])},t.prototype.setInitialState=function(t){t<this.realNumStates()&&(this.initialState=t)},t.prototype.unsetInitialState=function(){this.initialState=-1},t.prototype.getInitialState=function(){return this.stateList[this.initialState]},t.prototype.addAcceptingState=function(t){this.finalStates.insert(t)},t.prototype.removeAcceptingState=function(t){this.finalStates.erase(t)},t.prototype.getAcceptingStates=function(){var t=[],e=this;return this.finalStates.forEach(function(i){t.push(e.stateList[i])}),t},t.prototype.getCurrentStates=function(){var t=[],e=this;return this.currentStates.forEach(function(i){t.push(e.stateList[i])}),t},t.prototype.getStates=function(){return this.stateList.filter(function(t){return void 0!==t})},t.prototype.transitionIteration=function(t){var e=this,i=function(i){if(n.transitions.hasOwnProperty(i)){var s=e.stateList[i],r=n.transitions[i],o=function(i){r.hasOwnProperty(i)&&r[i].forEach(function(n){var r=e.stateList[n];t(s,r,i)})};for(var a in r)o(a)}},n=this;for(var s in this.transitions)i(s);var r=function(i){if(o.transitions.hasOwnProperty(i)){var n=e.stateList[i],s=o.epsilonTransitions[i];s.forEach(function(i){var s=e.stateList[i];t(n,s,"")})}},o=this;for(var s in this.epsilonTransitions)r(s)},t.prototype.alphabet=function(){var t=[];for(var e in this.alphabetSet)this.alphabetSet.hasOwnProperty(e)&&t.push(e);return t},t.prototype.read=function(t){var e=new n.UnorderedSet,i=this;this.currentStates.forEach(function(n){var s=i.transition(n,t);s&&s.forEach(function(t){e.insert(t)})}),this.expandSpontaneous(e),this.currentStates=e},t.prototype.reset=function(){this.currentStates.clear(),this.initialState!=-1&&(this.currentStates.insert(this.initialState),this.expandSpontaneous(this.currentStates))},t.prototype.clear=function(){this.stateList=[],this.alphabetSet={},this.transitions={},this.epsilonTransitions={},this.unsetInitialState(),this.finalStates.clear(),this.numRemovedStates=0,this.currentStates.clear()},t.prototype.accepts=function(){var t=!1,e=this;return this.finalStates.forEach(function(i){return!e.currentStates.contains(i)||(t=!0,!1)}),t},t.prototype.error=function(){return 0==this.currentStates.size()},t.prototype.numStates=function(){return this.stateList.length-this.numRemovedStates},t.prototype.realNumStates=function(){return this.stateList.length},t.prototype.transition=function(t,e){return this.transitions[t][e]},t.prototype.expandSpontaneous=function(t){var e=new i.Queue;for(t.forEach(function(t){e.push(t)});!e.empty();){var n=e.pop(),s=this.epsilonTransitions[n];s.forEach(function(i){t.contains(i)||(t.insert(i),e.push(i))})}},t}();e.FA=r}),define("Keyboard",["require","exports"],function(t,e){"use strict";var i;!function(t){t.keys={A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,ENTER:13,SHIFT:16,SPACE:32,ESC:27,DELETE:46,LEFT:37,UP:38,RIGHT:39,DOWN:40,"+":61,"-":173},t.symbols={delta:"δ",epsilon:"ε",gamma:"Γ",sigma:"Σ",leftArrow:"←",rightArrow:"→"}}(i=e.Keyboard||(e.Keyboard={}))}),define("System",["require","exports","Keyboard","Settings"],function(t,e,i,n){"use strict";function s(t){return t+"Key"}var r=["alt","ctrl","shift"],o=function(){function t(){}return t.changeLanguage=function(t){n.Settings.changeLanguage(t);for(var e=0,i=this.languageChangeObservers;e<i.length;e++){var s=i[e];s.onLanguageChange()}},t.changeMachine=function(t){n.Settings.changeMachine(t);for(var e=0,i=this.machineChangeObservers;e<i.length;e++){var s=i[e];s.onMachineChange()}},t.addLanguageChangeObserver=function(t){this.languageChangeObservers.push(t)},t.addMachineChangeObserver=function(t){this.machineChangeObservers.push(t)},t.emitKeyEvent=function(t){for(var e={preventDefault:function(){}},n=0,o=r;n<o.length;n++){var a=o[n];e[s(a)]=!1}for(var l=0,u=t;l<u.length;l++){var c=u[l];r.indexOf(c)>=0?e[s(c)]=!0:e.keyCode=i.Keyboard.keys[c.toUpperCase()]}this.keyEvent(e)},t.keyEvent=function(t){for(var e=!1,i=0,n=this.keyboardObservers;i<n.length;i++){var s=n[i],r=s.keys;!this.locked(s)&&this.shortcutMatches(t,r)&&(s.callback(),e=!0)}return!e||(t.preventDefault(),!1)},t.bindShortcut=function(t,e,i){this.keyboardObservers.push({keys:t,callback:e,group:i})},t.lockShortcutGroup=function(t){this.lockedGroups[t]=!0},t.unlockShortcutGroup=function(t){delete this.lockedGroups[t]},t.blockEvents=function(){this.eventBlock=!0},t.unblockEvents=function(){this.eventBlock=!1},t.shortcutMatches=function(t,e){if(this.eventBlock)return!1;for(var n=[],o=0,a=e;o<a.length;o++){var l=a[o];if(r.indexOf(l)>=0){if(n.push(l),!t[s(l)])return!1}else if(t.keyCode!=i.Keyboard.keys[l])return!1}for(var u=0,c=r;u<c.length;u++){var h=c[u];if(n.indexOf(h)==-1&&t[s(h)])return!1}return!0},t.locked=function(t){return this.lockedGroups.hasOwnProperty(t.group)},t.keyboardObservers=[],t.languageChangeObservers=[],t.machineChangeObservers=[],t.eventBlock=!1,t.lockedGroups={},t}();e.System=o}),define("Prompt",["require","exports","Keyboard","Settings","System","Utils"],function(t,e,i,n,s,r){"use strict";var o=function(){function t(t){this.inputs=[],this.successCallback=null,this.abortCallback=null,this.message=t}return t.prototype.addInput=function(t){this.inputs.push(t)},t.prototype.onSuccess=function(t){this.successCallback=t},t.prototype.onAbort=function(t){this.abortCallback=t},t.prototype.show=function(){var t=r.utils.create("div",{className:"click_blocker"}),e=r.utils.create("div",{id:"system_prompt"});e.innerHTML=this.message+"<br>";for(var o=r.utils.id(n.Settings.mainbarID),a="system_prompt_input_",l=function(){document.body.removeChild(t),s.System.unblockEvents(),$(e).slideUp(n.Settings.promptSlideInterval,function(){o.removeChild(e)})},u=[],c=this,h=function(){for(var t=0,e=u;t<e.length;t++){var i=e[t],n=i.id.replace(a,""),s=c.inputs[n].validator;if(s&&!s(i.value))return!1}return!0},p=r.utils.create("input",{type:"button",value:n.Strings.PROMPT_CONFIRM,click:function(){for(var t=!0,e=[],i=0,n=u;i<n.length;i++){var s=n[i],r=s.id.replace(a,""),o=c.inputs[r].validator;if(o&&!o(s.value)){t=!1;break}e.push(s.value)}l(),c.successCallback(e)}}),d=r.utils.create("input",{type:"button",value:n.Strings.PROMPT_CANCEL,click:function(){l(),c.abortCallback&&c.abortCallback()}}),g=0;g<this.inputs.length;g++){var f=void 0;f=this.inputs[g].initializer?this.inputs[g].initializer():r.utils.create("input",{type:"text",placeholder:this.inputs[g].placeholder||""}),f.id=a+g;var S=/input/i.test(f.tagName);S=S&&"text"==f.type,S&&(f.addEventListener("keydown",function(t){t.keyCode==i.Keyboard.keys.ENTER?p.click():t.keyCode==i.Keyboard.keys.ESC&&d.click()}),f.addEventListener("keyup",function(t){var e=t.keyCode==i.Keyboard.keys.ENTER,n=t.keyCode==i.Keyboard.keys.ESC;e||n||(p.disabled=!h())})),u.push(f),e.appendChild(f)}p.disabled=!h(),e.appendChild(p),e.appendChild(d),document.body.insertBefore(t,document.body.children[0]),s.System.blockEvents(),$(e).toggle(),o.insertBefore(e,o.children[0]),$(e).slideDown(n.Settings.promptSlideInterval,function(){u[0].focus()})},t.simple=function(t,e,o,a){var l=r.utils.create("div",{className:"click_blocker"}),u=r.utils.create("div",{id:"system_prompt"});u.innerHTML=t+"<br>";for(var c=r.utils.id(n.Settings.mainbarID),h=!1,p=function(){document.body.removeChild(l),s.System.unblockEvents(),$(u).slideUp(n.Settings.promptSlideInterval,function(){c.removeChild(u)})},d=[],g=r.utils.create("input",{type:"button",value:n.Strings.PROMPT_CONFIRM,click:function(){if(!h){h=!0;for(var t=[],e=0,i=d;e<i.length;e++){var n=i[e];t.push(n.value)}p(),o(t)}}}),f=r.utils.create("input",{type:"button",value:n.Strings.PROMPT_CANCEL,click:function(){h||(h=!0,p(),a&&a())}}),S=0;S<e;S++){var y=r.utils.create("input",{type:"text"});y.addEventListener("keydown",function(t){t.keyCode==i.Keyboard.keys.ENTER?g.click():t.keyCode==i.Keyboard.keys.ESC&&f.click()}),d.push(y),u.appendChild(y)}u.appendChild(g),u.appendChild(f),document.body.insertBefore(l,document.body.children[0]),s.System.blockEvents(),$(u).toggle(),c.insertBefore(u,c.children[0]),$(u).slideDown(n.Settings.promptSlideInterval,function(){d[0].focus()})},t}();e.Prompt=o}),define("machines/FA/FAController",["require","exports","machines/FA/FA","Keyboard","Prompt","Settings","Utils"],function(t,e,i,n,s,r,o){"use strict";var a=function(){function t(){this.stateMapping={},this.stepIndex=-1,this.editingCallback=function(){},this.machine=new i.FA}return t.prototype.edgePrompt=function(t,e){var i=this,n=new s.Prompt(r.Strings.FA_ENTER_EDGE_CONTENT);n.addInput({placeholder:r.Strings.FA_ENTER_EDGE_PLACEHOLDER_1,validator:o.utils.optionalSymbolValidator}),n.onSuccess(function(e){t(e,i.edgeDataToText(e))}),n.onAbort(e),n.show()},t.prototype.edgeDataToText=function(t){var e=n.Keyboard.symbols.epsilon;return t[0]||e},t.prototype.createState=function(t){var e=t.getName(),i=this.machine.addState(e);this.stateMapping[e]=i,t.isInitial()&&this.machine.setInitialState(i),t.isFinal()&&this.machine.addAcceptingState(i),this.editingCallback()},t.prototype.createEdge=function(t,e,i){var n=this.index(t),s=this.index(e),r=this.edgeDataToText(i);i[0]||(r=""),this.machine.addTransition(n,s,r),this.editingCallback()},t.prototype.changeInitialFlag=function(t){t.isInitial()?this.machine.setInitialState(this.index(t)):this.machine.unsetInitialState(),this.editingCallback()},t.prototype.changeFinalFlag=function(t){var e=this.index(t);t.isFinal()?this.machine.addAcceptingState(e):this.machine.removeAcceptingState(e),this.editingCallback()},t.prototype.renameState=function(t,e){var i=this.index(t);delete this.stateMapping[t.getName()],this.stateMapping[e]=i,this.machine.renameState(i,e),this.editingCallback()},t.prototype.deleteState=function(t){this.machine.removeState(this.index(t)),this.editingCallback()},t.prototype.deleteEdge=function(t,e,i){var n=this.index(t),s=this.index(e),r=this.edgeDataToText(i);this.machine.removeTransition(n,s,r),this.editingCallback()},t.prototype.clear=function(){this.machine.clear(),this.editingCallback()},t.prototype.fastForward=function(t){this.machine.reset();for(var e=0;e<t.length;e++)this.machine.read(t[e])},t.prototype.step=function(t){if(!this.finished(t)){if(this.stepIndex==-1)this.machine.reset();else{var e=t[this.stepIndex];this.machine.read(e)}this.stepIndex++}},t.prototype.stop=function(){this.stepIndex=-1},t.prototype.reset=function(){this.machine.reset()},t.prototype.finished=function(t){return this.stepIndex>=t.length},t.prototype.isStopped=function(){return this.stepIndex==-1},t.prototype.stepPosition=function(){return this.stepIndex},t.prototype.currentStates=function(){return this.machine.getCurrentStates()},t.prototype.accepts=function(){return this.machine.accepts()},t.prototype.formalDefinition=function(){var t=this.machine,e=n.Keyboard.symbols.delta,i=n.Keyboard.symbols.sigma,s={tupleSequence:["Q",i,e,"q0","F"],parameterSequence:["Q",i,"q0","F",e],parameterValues:{}},r=s.parameterValues;return r.Q=t.getStates(),r[i]=t.alphabet(),r[e]=this.transitionTable(),r.q0=t.getInitialState(),r.F=t.getAcceptingStates(),s},t.prototype.setEditingCallback=function(t){this.editingCallback=t},t.prototype.index=function(t){return this.stateMapping[t.getName()]},t.prototype.transitionTable=function(){var t={list:[]},e=function(e,i,s){s=s||n.Keyboard.symbols.epsilon,t.list.push([e,i,s])};return this.machine.transitionIteration(e),t},t}();e.FAController=a}),define("machines/PDA/PDA",["require","exports","datastructures/UnorderedSet","Utils"],function(t,e,i,n){"use strict";var s=function(){function t(){this.stateList=[],this.inputAlphabet={},this.stackAlphabet={},this.transitions={},this.initialState=-1,this.finalStates=new i.UnorderedSet,this.numRemovedStates=0,this.currentState=null,this.stack=[],this.input=null}return t.prototype.addState=function(t){this.stateList.push(t);var e=this.realNumStates()-1;return this.transitions[e]={},this.initialState==-1&&(this.initialState=e,this.reset()),e},t.prototype.removeState=function(t){n.utils.foreach(this.transitions,function(e,i){var s=parseInt(e);n.utils.foreach(i,function(e,i){n.utils.foreach(i,function(e,i){for(var n=0;n<i.length;)s==t||i[n][0]==t?i.splice(n,1):n++})})}),delete this.transitions[t],this.initialState==t&&this.unsetInitialState(),this.finalStates.erase(t),this.stateList[t]=void 0,this.numRemovedStates++},t.prototype.renameState=function(t,e){this.stateList[t]=e},t.prototype.addTransition=function(t,e,i){var n=this.transitions[t],s=i[0],r=i[1],o=i[2];n.hasOwnProperty(s)||(n[s]={}),n[s].hasOwnProperty(r)||(n[s][r]=[]),n[s][r].push([e,o]),this.addInputSymbol(s),this.addStackSymbol(r);for(var a=0;a<o.length;a++)this.addStackSymbol(o[a])},t.prototype.removeTransition=function(t,e,i){var n=this.transitions[t],s=i[0],r=i[1],o=i[2];if(n.hasOwnProperty(s)&&n[s].hasOwnProperty(r))for(var a=n[s][r],l=0;l<a.length;l++){var u=a[l];if(u[0]==e&&u[1]==o){a.splice(l,1);break}}},t.prototype.setInitialState=function(t){t<this.realNumStates()&&(this.initialState=t)},t.prototype.unsetInitialState=function(){this.initialState=-1},t.prototype.getInitialState=function(){return this.stateList[this.initialState]},t.prototype.addAcceptingState=function(t){this.finalStates.insert(t)},t.prototype.removeAcceptingState=function(t){this.finalStates.erase(t)},t.prototype.getAcceptingStates=function(){var t=[],e=this;return this.finalStates.forEach(function(i){t.push(e.stateList[i])}),t},t.prototype.getCurrentState=function(){return this.stateList[this.currentState]},t.prototype.getStates=function(){return this.stateList.filter(function(t){return void 0!==t})},t.prototype.transitionIteration=function(t){var e=this;n.utils.foreach(this.transitions,function(i,s){n.utils.foreach(s,function(s,r){n.utils.foreach(r,function(n,r){for(var o=e.stateList[i],a=0,l=r;a<l.length;a++){var u=l[a],c=e.stateList[u[0]];t(o,[c,u[1]],s,n)}})})})},t.prototype.getInputAlphabet=function(){var t=[];for(var e in this.inputAlphabet)this.inputAlphabet.hasOwnProperty(e)&&t.push(e);return t},t.prototype.getStackAlphabet=function(){var t=[];for(var e in this.stackAlphabet)this.stackAlphabet.hasOwnProperty(e)&&t.push(e);return t},t.prototype.getStackContent=function(){return this.stack},t.prototype.setInput=function(t){this.input=t,this.stack=["$"]},t.prototype.read=function(){if(!this.error()){var t=!0,e=this.input[0];if(console.log("[INPUT]",this.input),console.log("[STACK]",this.stack),this.transitions.hasOwnProperty(this.currentState+"")){var i=this.transitions[this.currentState];if(i.hasOwnProperty(e)){var n=i[e];console.log(n);var s=this.stack[this.stack.length-1];if(n.hasOwnProperty(s)){var r=n[s];this.currentState=r[0][0],this.input=this.input.substr(1),this.stack.pop();for(var o=r[0][1],a=0;a<o.length;a++)this.stack.push(o[a]);console.log("[INPUT]",this.input),console.log("[STACK]",this.stack),console.log("-----------------------"),t=!1}}}t&&(this.currentState=null)}},t.prototype.halted=function(){return 0==this.input.length},t.prototype.reset=function(){this.initialState==-1?this.currentState=null:this.currentState=this.initialState,this.stack=[]},t.prototype.clear=function(){this.stateList=[],this.inputAlphabet={},this.stackAlphabet={},this.transitions={},this.unsetInitialState(),this.finalStates.clear(),this.numRemovedStates=0,this.currentState=null,this.stack=[]},t.prototype.accepts=function(){return this.finalStates.contains(this.currentState)},t.prototype.error=function(){return null===this.currentState},t.prototype.numStates=function(){return this.stateList.length-this.numRemovedStates},t.prototype.addSymbol=function(t,e){this[t].hasOwnProperty(e)||(this[t][e]=0),this[t][e]++},t.prototype.addInputSymbol=function(t){this.addSymbol("inputAlphabet",t)},t.prototype.addStackSymbol=function(t){this.addSymbol("stackAlphabet",t)},t.prototype.removeSymbol=function(t,e){this[t][e]--,0==this[t][e]&&delete this[t][e]},t.prototype.removeInputSymbol=function(t){this.removeSymbol("inputAlphabet",t)},t.prototype.removeStackSymbol=function(t){this.removeSymbol("stackAlphabet",t)},t.prototype.realNumStates=function(){return this.stateList.length},t}();e.PDA=s}),define("machines/PDA/PDAController",["require","exports","machines/PDA/PDA","Keyboard","Prompt","Settings","Utils"],function(t,e,i,n,s,r,o){"use strict";var a=function(){function t(){this.stateMapping={},this.stepIndex=-1,this.editingCallback=function(){},this.machine=new i.PDA}return t.prototype.edgePrompt=function(t,e){var i=this,n=new s.Prompt(r.Strings.PDA_ENTER_EDGE_CONTENT);n.addInput({placeholder:r.Strings.PDA_ENTER_EDGE_PLACEHOLDER_1,validator:o.utils.optionalSymbolValidator}),n.addInput({placeholder:r.Strings.PDA_ENTER_EDGE_PLACEHOLDER_2,validator:o.utils.optionalSymbolValidator}),n.addInput({placeholder:r.Strings.PDA_ENTER_EDGE_PLACEHOLDER_3}),n.onSuccess(function(e){t(e,i.edgeDataToText(e))}),n.onAbort(e),n.show()},t.prototype.edgeDataToText=function(t){var e=n.Keyboard.symbols.epsilon,i=t[0]||e,s=t[1]||e,r=t[2]||e;return i+","+s+" → "+r},t.prototype.createState=function(t){var e=t.getName(),i=this.machine.addState(e);this.stateMapping[e]=i,t.isInitial()&&this.machine.setInitialState(i),t.isFinal()&&this.machine.addAcceptingState(i),this.editingCallback()},t.prototype.createEdge=function(t,e,i){var n=this.index(t),s=this.index(e);this.machine.addTransition(n,s,i),this.editingCallback()},t.prototype.changeInitialFlag=function(t){t.isInitial()?this.machine.setInitialState(this.index(t)):this.machine.unsetInitialState(),this.editingCallback()},t.prototype.changeFinalFlag=function(t){var e=this.index(t);t.isFinal()?this.machine.addAcceptingState(e):this.machine.removeAcceptingState(e),this.editingCallback()},t.prototype.renameState=function(t,e){var i=this.index(t);delete this.stateMapping[t.getName()],this.stateMapping[e]=i,this.machine.renameState(i,e),this.editingCallback()},t.prototype.deleteState=function(t){this.machine.removeState(this.index(t)),this.editingCallback()},t.prototype.deleteEdge=function(t,e,i){var n=this.index(t),s=this.index(e);this.machine.removeTransition(n,s,i),this.editingCallback()},t.prototype.clear=function(){this.machine.clear(),this.editingCallback()},t.prototype.fastForward=function(t){console.log("PDAController::fastForward() not implemented")},t.prototype.step=function(t){this.finished(t)||(this.stepIndex==-1?(this.machine.reset(),this.machine.setInput(t)):this.machine.read(),this.stepIndex++)},t.prototype.stop=function(){this.stepIndex=-1},t.prototype.reset=function(){this.machine.reset()},t.prototype.finished=function(t){return!1},t.prototype.isStopped=function(){return this.stepIndex==-1},t.prototype.stepPosition=function(){return this.stepIndex},t.prototype.getStackContent=function(){return this.machine.getStackContent()},t.prototype.currentStates=function(){var t=this.machine.getCurrentState(),e=[];return this.machine.error()||e.push(t),e},t.prototype.accepts=function(){return this.machine.accepts()},t.prototype.formalDefinition=function(){var t=this.machine,e=n.Keyboard.symbols.delta,i=n.Keyboard.symbols.gamma,s=n.Keyboard.symbols.sigma,r={tupleSequence:["Q",s,i,e,"q0","Z0","F"],parameterSequence:["Q",s,i,"q0","Z0","F",e],parameterValues:{}},o=r.parameterValues;return o.Q=t.getStates(),o[s]=t.getInputAlphabet(),o[i]=t.getStackAlphabet(),o[e]=this.transitionTable(),o.q0=t.getInitialState(),o.Z0="$",o.F=t.getAcceptingStates(),r},t.prototype.setEditingCallback=function(t){this.editingCallback=t},t.prototype.index=function(t){return this.stateMapping[t.getName()]},t.prototype.transitionTable=function(){var t={list:[]},e=function(e,i,s,r){var o=n.Keyboard.symbols.epsilon;s=s||o,r=r||o;var a=i[1]||o;t.list.push([e,s,r,i[0],a])};return this.machine.transitionIteration(e),t},t}();e.PDAController=a}),define("machines/LBA/LBA",["require","exports","datastructures/UnorderedSet","Utils"],function(t,e,i,n){"use strict";var s;!function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT"}(s||(s={}));var r=function(){function t(){this.stateList=[],this.inputAlphabet={},this.tapeAlphabet={},this.transitions={},this.initialState=-1,this.finalStates=new i.UnorderedSet,this.numRemovedStates=0,this.currentState=null,this.tape=[],this.headPosition=0,this.calculationSteps=0,this.inputLength=0,this.accepting=!1}return t.prototype.addState=function(t){this.stateList.push(t);var e=this.realNumStates()-1;return this.transitions[e]={},this.initialState==-1&&(this.initialState=e,this.reset()),e},t.prototype.removeState=function(t){var e=this;n.utils.foreach(this.transitions,function(i,s){var r=parseInt(i);n.utils.foreach(s,function(i){s[i].state==t&&e.uncheckedRemoveTransition(r,i),r==t&&e.uncheckedRemoveTransition(t,i)})}),delete this.transitions[t],this.initialState==t&&this.unsetInitialState(),this.finalStates.erase(t),this.stateList[t]=void 0,this.numRemovedStates++},t.prototype.renameState=function(t,e){this.stateList[t]=e},t.prototype.addTransition=function(t,e,i){var n=this.transitions[t],s=i[0],r=i[1],o=this.plainTextToDirection(i[2]);n[s]={state:e,tapeSymbol:r,direction:o},this.isInputSymbol(s)&&this.addInputSymbol(s),this.isInputSymbol(r)&&this.addInputSymbol(r),this.addTapeSymbol(s),this.addTapeSymbol(r)},t.prototype.removeTransition=function(t,e,i){var n=this.transitions[t],s=i[0],r=i[1],o=this.plainTextToDirection(i[2]);
if(n.hasOwnProperty(s)){var a=n[s],l=a.state==e;l=l&&a.tapeSymbol==r,l=l&&a.direction==o,l&&this.uncheckedRemoveTransition(t,s)}},t.prototype.uncheckedRemoveTransition=function(t,e){var i=this.transitions[t],n=i[e].tapeSymbol;delete i[e],this.isInputSymbol(e)&&this.removeInputSymbol(e),this.isInputSymbol(n)&&this.removeInputSymbol(n),this.removeTapeSymbol(e),this.removeTapeSymbol(n)},t.prototype.setInitialState=function(t){t<this.realNumStates()&&(this.initialState=t)},t.prototype.unsetInitialState=function(){this.initialState=-1},t.prototype.getInitialState=function(){return this.stateList[this.initialState]},t.prototype.addAcceptingState=function(t){this.finalStates.insert(t)},t.prototype.removeAcceptingState=function(t){this.finalStates.erase(t)},t.prototype.getAcceptingStates=function(){var t=[],e=this;return this.finalStates.forEach(function(i){t.push(e.stateList[i])}),t},t.prototype.getCurrentState=function(){return this.stateList[this.currentState]},t.prototype.getStates=function(){return this.stateList.filter(function(t){return void 0!==t})},t.prototype.transitionIteration=function(t){var e=this;for(var i in this.transitions)if(this.transitions.hasOwnProperty(i)){var n=e.stateList[i],s=this.transitions[i];for(var r in s)if(s.hasOwnProperty(r)){var o=s[r],a={state:this.stateList[o.state],tapeSymbol:o.tapeSymbol,direction:o.direction};t(n,a,r)}}},t.prototype.getInputAlphabet=function(){var t=[];for(var e in this.inputAlphabet)this.inputAlphabet.hasOwnProperty(e)&&t.push(e);return t},t.prototype.getTapeAlphabet=function(){var t=[];for(var e in this.tapeAlphabet)this.tapeAlphabet.hasOwnProperty(e)&&t.push(e);return t},t.prototype.setTapeContent=function(t){this.tape=t,this.headPosition=0,this.calculationSteps=0,this.inputLength=t.length,this.accepting=!1},t.prototype.getTapeContent=function(){return this.tape},t.prototype.getHeadPosition=function(){return this.headPosition},t.prototype.read=function(){if(!this.error()){var t=!0,e=this.tape[this.headPosition];if(this.transitions.hasOwnProperty(this.currentState+"")){var i=this.transitions[this.currentState];if(i.hasOwnProperty(e)){var n=i[e];this.currentState=n.state,this.tape[this.headPosition]=n.tapeSymbol,this.headPosition+=this.directionToOffset(n.direction),this.calculationSteps++,t=!1}}this.exhausted()&&(t=!0),t&&(this.accepts()&&(this.accepting=!0),this.currentState=null)}},t.prototype.halted=function(){return this.error()},t.prototype.reset=function(){this.initialState==-1?this.currentState=null:this.currentState=this.initialState,this.headPosition=0,this.calculationSteps=0,this.accepting=!1},t.prototype.clear=function(){this.stateList=[],this.inputAlphabet={},this.tapeAlphabet={},this.transitions={},this.unsetInitialState(),this.finalStates.clear(),this.numRemovedStates=0,this.currentState=null,this.tape=[],this.headPosition=0,this.calculationSteps=0,this.accepting=!1},t.prototype.accepts=function(){if(this.accepting)return!0;var t=this.finalStates.contains(this.currentState);return t=t&&this.headPosition>=this.tape.length},t.prototype.error=function(){return null===this.currentState},t.prototype.numStates=function(){return this.stateList.length-this.numRemovedStates},t.prototype.exhausted=function(){if(this.accepts())return!1;var t=this.numStates(),e=this.inputLength,i=Object.keys(this.tapeAlphabet).length;return this.calculationSteps>t*e*Math.pow(i,e)},t.prototype.isInputSymbol=function(t){return/[a-z]/.test(t)},t.prototype.plainTextToDirection=function(t){return"<"==t?s.LEFT:s.RIGHT},t.prototype.directionToOffset=function(t){return t==s.LEFT?-1:1},t.prototype.addSymbol=function(t,e){this[t].hasOwnProperty(e)||(this[t][e]=0),this[t][e]++},t.prototype.addInputSymbol=function(t){this.addSymbol("inputAlphabet",t)},t.prototype.addTapeSymbol=function(t){this.addSymbol("tapeAlphabet",t)},t.prototype.removeSymbol=function(t,e){this[t][e]--,0==this[t][e]&&delete this[t][e]},t.prototype.removeInputSymbol=function(t){this.removeSymbol("inputAlphabet",t)},t.prototype.removeTapeSymbol=function(t){this.removeSymbol("tapeAlphabet",t)},t.prototype.realNumStates=function(){return this.stateList.length},t}();e.LBA=r}),define("machines/LBA/LBAController",["require","exports","Keyboard","machines/LBA/LBA","Prompt","Settings","Utils"],function(t,e,i,n,s,r,o){"use strict";var a=function(){function t(){this.stateMapping={},this.stepIndex=-1,this.editingCallback=function(){},this.machine=new n.LBA}return t.prototype.edgePrompt=function(t,e){var n=this,a=new s.Prompt(r.Strings.LBA_ENTER_EDGE_CONTENT);a.addInput({placeholder:r.Strings.LBA_ENTER_EDGE_PLACEHOLDER_1,validator:o.utils.singleSymbolValidator}),a.addInput({placeholder:r.Strings.LBA_ENTER_EDGE_PLACEHOLDER_2,validator:o.utils.singleSymbolValidator}),a.addInput({initializer:function(){var t=o.utils.create("select");return t.appendChild(o.utils.create("option",{innerHTML:i.Keyboard.symbols.leftArrow,value:"<"})),t.appendChild(o.utils.create("option",{innerHTML:i.Keyboard.symbols.rightArrow,value:">"})),t}}),a.onSuccess(function(e){t(e,n.edgeDataToText(e))}),a.onAbort(e),a.show()},t.prototype.edgeDataToText=function(t){var e=i.Keyboard.symbols,n=e.epsilon,s=[t[0]||n,t[1]||n,"<"==t[2]?e.leftArrow:e.rightArrow];return s[0]+", "+s[1]+", "+s[2]},t.prototype.createState=function(t){var e=t.getName(),i=this.machine.addState(e);this.stateMapping[e]=i,t.isInitial()&&this.machine.setInitialState(i),t.isFinal()&&this.machine.addAcceptingState(i),this.editingCallback()},t.prototype.createEdge=function(t,e,i){var n=this.index(t),s=this.index(e);this.machine.addTransition(n,s,i),this.editingCallback()},t.prototype.changeInitialFlag=function(t){t.isInitial()?this.machine.setInitialState(this.index(t)):this.machine.unsetInitialState(),this.editingCallback()},t.prototype.changeFinalFlag=function(t){var e=this.index(t);t.isFinal()?this.machine.addAcceptingState(e):this.machine.removeAcceptingState(e),this.editingCallback()},t.prototype.renameState=function(t,e){var i=this.index(t);delete this.stateMapping[t.getName()],this.stateMapping[e]=i,this.machine.renameState(i,e),this.editingCallback()},t.prototype.deleteState=function(t){this.machine.removeState(this.index(t)),this.editingCallback()},t.prototype.deleteEdge=function(t,e,i){var n=this.index(t),s=this.index(e);this.machine.removeTransition(n,s,i),this.editingCallback()},t.prototype.clear=function(){this.machine.clear(),this.editingCallback()},t.prototype.fastForward=function(t){for(this.machine.reset(),this.machine.setTapeContent(t.split(""));!this.finished(t);)this.machine.read()},t.prototype.step=function(t){this.finished(t)||(this.stepIndex==-1?(this.machine.reset(),this.machine.setTapeContent(t.split(""))):this.machine.read(),this.stepIndex++)},t.prototype.stop=function(){this.stepIndex=-1},t.prototype.reset=function(){this.machine.reset()},t.prototype.finished=function(t){return this.machine.halted()},t.prototype.isStopped=function(){return this.stepIndex==-1},t.prototype.stepPosition=function(){return this.stepIndex},t.prototype.getTapeContent=function(){return this.machine.getTapeContent()},t.prototype.getHeadPosition=function(){return this.machine.getHeadPosition()},t.prototype.currentStates=function(){var t=this.machine.getCurrentState(),e=[];return this.machine.error()||e.push(t),e},t.prototype.accepts=function(){return this.machine.accepts()},t.prototype.exhausted=function(){return this.machine.exhausted()},t.prototype.formalDefinition=function(){var t=this.machine,e=i.Keyboard.symbols.delta,n=i.Keyboard.symbols.gamma,s=i.Keyboard.symbols.sigma,r={tupleSequence:["Q",s,n,e,"q0","B","F"],parameterSequence:["Q",s,n,"q0","B","F",e],parameterValues:{}},o=r.parameterValues;return o.Q=t.getStates(),o[s]=t.getInputAlphabet(),o[n]=t.getTapeAlphabet(),o[e]=this.transitionTable(),o.q0=t.getInitialState(),o.B="_",o.F=t.getAcceptingStates(),r},t.prototype.setEditingCallback=function(t){this.editingCallback=t},t.prototype.index=function(t){return this.stateMapping[t.getName()]},t.prototype.transitionTable=function(){var t={list:[]},e=[i.Keyboard.symbols.leftArrow,i.Keyboard.symbols.rightArrow],n=function(i,n,s){t.list.push([i,s,n.state,n.tapeSymbol,e[n.direction]])};return this.machine.transitionIteration(n),t},t}();e.LBAController=a}),define("lists/ControllerList",["require","exports","machines/FA/FAController","machines/PDA/PDAController","machines/LBA/LBAController"],function(t,e,i,n,s){"use strict";function r(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}r(i),r(n),r(s)}),define("languages/Portuguese",["require","exports"],function(t,e){"use strict";var i;!function(t){t.strings={LANGUAGE_NAME:"Português",SETTINGS:"Configurações do Sistema",CHANGE_LANGUAGE:'Mudar o idioma para "%"?',SYSTEM_LANGUAGE:"Idioma do sistema",UNDO_MAX_COUNT:"Quantidade de 'desfazer'",MEMORY_CONSUMPTION_WARNING:"Aumentar o tamanho do histórico aumenta o consumo de memória. Deseja continuar?",FILE_MENUBAR:"Manipulação de Arquivos",SAVE:"Salvar",OPEN:"Abrir",INVALID_FILE:"Arquivo inválido",PROMPT_CONFIRM:"Confirmar",PROMPT_CANCEL:"Cancelar",SELECTED_ENTITY:"Entidade selecionada",NO_SELECTED_ENTITY:"nenhuma entidade selecionada",ORIGIN:"Origem",TARGET:"Destino",TRANSITIONS:"Transições",STATE_NAME:"Nome",STATE_IS_INITIAL:"É inicial",STATE_IS_FINAL:"É final",RENAME_STATE:"renomear",TOGGLE_PROPERTY:"alternar",CHANGE_PROPERTY:"alterar",DELETE_STATE:"Remover estado",DELETE_SELECTED_TRANSITION:"Remover transição selecionada",DELETE_ALL_TRANSITIONS:"Remover todas as transições",YES:"sim",NO:"não",FORMAL_DEFINITION:"Definição Formal",DEFINITION_WHERE_SUFFIX:", onde:",NO_INITIAL_STATE:"nenhum",NO_TRANSITIONS:"nenhuma transição",SELECT_MACHINE:"Seleção de Máquina",ACTION_LIST:"Ações",CREATE_STATE:"Criar estado",CREATE_EDGE:"Criar aresta",CLEAR_MACHINE:"Limpar máquina",CLEAR_CONFIRMATION:"Deseja realmente limpar o autômato?",UNDO:"Desfazer",CREATE_STATE_INSTRUCTIONS:"clique duplo no local alvo",CREATE_EDGE_INSTRUCTIONS:"clique direito na origem e então clique no destino",STATE_MANUAL_CREATION:"Digite o nome do estado:",EDGE_MANUAL_CREATION:"Escolha a origem e o destino:",DUPLICATE_STATE_NAME:"Nome do estado já em uso",STATE_RENAME_ACTION:"Digite o novo nome do estado:",EDGE_ENTER_NEW_ORIGIN:"Digite a nova origem:",EDGE_ENTER_NEW_TARGET:"Digite o novo destino:",FA:"Autômato Finito",PDA:"Autômato de Pilha",LBA:"Autômato Linearmente Limitado",FA_ENTER_EDGE_CONTENT:"Digite o conteúdo da aresta (até 1 caractere):",FA_ENTER_EDGE_PLACEHOLDER_1:"símbolo",PDA_ENTER_EDGE_CONTENT:"Digite o símbolo de entrada, símbolo de pilha lido e símbolo(s) de pilha escrito(s)",PDA_ENTER_EDGE_PLACEHOLDER_1:"ler (entrada)",PDA_ENTER_EDGE_PLACEHOLDER_2:"ler (pilha)",PDA_ENTER_EDGE_PLACEHOLDER_3:"escrever",LBA_ENTER_EDGE_CONTENT:"Digite o(s) símbolo(s) de fita lido(s), escrito(s) e a direção do movimento",LBA_ENTER_EDGE_PLACEHOLDER_1:"ler",LBA_ENTER_EDGE_PLACEHOLDER_2:"escrever",LBA_ENTER_EDGE_PLACEHOLDER_3:"direção",RECOGNITION:"Reconhecimento",MULTIPLE_RECOGNITION:"Reconhecimento múltiplo",TEST_CASE:"caso de teste",FAST_RECOGNITION:"Reconhecimento rápido (R)",STEP_RECOGNITION:"Reconhecimento passo-a-passo (N)",STOP_RECOGNITION:"Parar reconhecimento passo-a-passo (S)",START_MULTIPLE_RECOGNITION:"Reconhecimento múltiplo (M)",CHANGE_MACHINE_WARNING:"Alterar o tipo de máquina reseta o autômato. Deseja continuar?",INPUT_ACCEPTED:"aceito",INPUT_REJECTED:"rejeitado",INPUT_LOOPING:"rejeitado<br>(looping)",ERROR_INVALID_STATE_NAME:"Nome de estado inválido"}}(i=e.portuguese||(e.portuguese={}))}),define("languages/English",["require","exports"],function(t,e){"use strict";var i;!function(t){t.strings={LANGUAGE_NAME:"English",SETTINGS:"System Settings",CHANGE_LANGUAGE:'Change the language to "%"?',SYSTEM_LANGUAGE:"System language",UNDO_MAX_COUNT:"Undo max count",MEMORY_CONSUMPTION_WARNING:"Increasing the history size increases the memory consumption. Do you wish to continue?",FILE_MENUBAR:"File Manipulation",SAVE:"Save",OPEN:"Open",INVALID_FILE:"Invalid file",PROMPT_CONFIRM:"Confirm",PROMPT_CANCEL:"Cancel",SELECTED_ENTITY:"Selected entity",NO_SELECTED_ENTITY:"no selected entity",ORIGIN:"Origin",TARGET:"Target",TRANSITIONS:"Transitions",STATE_NAME:"Name",STATE_IS_INITIAL:"Is initial",STATE_IS_FINAL:"Is final",RENAME_STATE:"rename",TOGGLE_PROPERTY:"toggle",CHANGE_PROPERTY:"change",DELETE_STATE:"Delete state",DELETE_SELECTED_TRANSITION:"Delete selected transition",DELETE_ALL_TRANSITIONS:"Delete all transitions",YES:"yes",NO:"no",FORMAL_DEFINITION:"Formal Definition",DEFINITION_WHERE_SUFFIX:", where:",NO_INITIAL_STATE:"none",NO_TRANSITIONS:"none",SELECT_MACHINE:"Machine Selection",ACTION_LIST:"Actions",CREATE_STATE:"Create state",CREATE_EDGE:"Create edge",CLEAR_MACHINE:"Clear machine",CLEAR_CONFIRMATION:"Do you really want to reset this automaton?",UNDO:"Undo",CREATE_STATE_INSTRUCTIONS:"double click on target position",CREATE_EDGE_INSTRUCTIONS:"right click on origin then click on target",STATE_MANUAL_CREATION:"Enter the state name:",EDGE_MANUAL_CREATION:"Choose the origin and destination",DUPLICATE_STATE_NAME:"State name already in use",STATE_RENAME_ACTION:"Enter the new state name:",EDGE_ENTER_NEW_ORIGIN:"Enter a new origin:",EDGE_ENTER_NEW_TARGET:"Enter a new target:",FA:"Finite Automaton",PDA:"Pushdown Automaton",LBA:"Linearly Bounded Automaton",FA_ENTER_EDGE_CONTENT:"Enter the edge content (up to 1 character):",FA_ENTER_EDGE_PLACEHOLDER_1:"symbol",PDA_ENTER_EDGE_CONTENT:"Enter the input symbol, stack symbol read and stack symbol(s) written:",PDA_ENTER_EDGE_PLACEHOLDER_1:"read (input)",PDA_ENTER_EDGE_PLACEHOLDER_2:"read (stack)",PDA_ENTER_EDGE_PLACEHOLDER_3:"write",LBA_ENTER_EDGE_CONTENT:"Enter the tape symbol(s) read, tape symbol(s) written and move direction:",LBA_ENTER_EDGE_PLACEHOLDER_1:"read",LBA_ENTER_EDGE_PLACEHOLDER_2:"write",LBA_ENTER_EDGE_PLACEHOLDER_3:"direction",RECOGNITION:"Recognition",MULTIPLE_RECOGNITION:"Multiple recognition",TEST_CASE:"test case",FAST_RECOGNITION:"Fast recognition (R)",STEP_RECOGNITION:"Step-by-step recognition (N)",STOP_RECOGNITION:"Stop step-by-step recognition (S)",START_MULTIPLE_RECOGNITION:"Multiple recognition (M)",CHANGE_MACHINE_WARNING:"Changing the machine type resets the automaton. Do you wish to continue?",INPUT_ACCEPTED:"accepted",INPUT_REJECTED:"rejected",INPUT_LOOPING:"rejected<br>(looping)",ERROR_INVALID_STATE_NAME:"Invalid state name"}}(i=e.english||(e.english={}))}),define("lists/LanguageList",["require","exports","languages/Portuguese","languages/English"],function(t,e,i,n){"use strict";function s(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}s(i),s(n)}),define("interface/Menu",["require","exports","interface/Renderer","Settings","Utils"],function(t,e,i,n,s){"use strict";var r=function(t){function e(e){t.call(this),this.body=null,this.toggled=!1,this.title=e,this.children=[]}return __extends(e,t),e.prototype.add=function(t){this.children.push(t)},e.prototype.clear=function(){this.children=[]},e.prototype.onRender=function(){var t=this.node,e=s.utils.create("div");e.classList.add("menu");var i=s.utils.create("div");i.classList.add("menu_arrow");var r=s.utils.create("div");r.classList.add("title"),r.appendChild(i),r.innerHTML+=this.title,e.appendChild(r);var o=s.utils.create("div");o.classList.add("content");for(var a=0,l=this.children;a<l.length;a++){var u=l[a];o.appendChild(u)}e.appendChild(o),t.appendChild(e);var c=this;r.addEventListener("click",function(){$(o).is(":animated")||$(o).slideToggle(n.Settings.menuSlideInterval,function(){c.updateArrow()})}),this.body=e,this.toggled&&this.internalToggle(),this.updateArrow()},e.prototype.toggle=function(){this.toggled=!this.toggled,this.body&&this.internalToggle()},e.prototype.html=function(){return this.body},e.prototype.content=function(){return this.body.querySelector(".content")},e.prototype.updateArrow=function(){var t=this.body.querySelector(".menu_arrow");"none"==$(this.content()).css("display")?t.innerHTML="&#x25BA;":t.innerHTML="&#x25BC;"},e.prototype.internalToggle=function(){$(this.content()).toggle()},e}(i.Renderer);e.Menu=r}),define("machines/FA/initializer",["require","exports","Keyboard","interface/Menu","Settings","System","Utils"],function(t,e,i,n,s,r,o){"use strict";var a=function(){function t(){this.shortcutGroup="FA",this.boundShortcuts=!1,this.testCaseInput=null,this.fastRecognition=null,this.stepRecognition=null,this.stopRecognition=null,this.progressContainer=null,this.multipleCaseArea=null,this.multipleCaseResults=null,this.multipleCaseButton=null}return t.prototype.init=function(){console.log("[FA] Initializing...");var t=[],e=new n.Menu(s.Strings.RECOGNITION),i=[];this.buildTestCaseInput(i),this.buildRecognitionControls(i),this.buildRecognitionProgress(i),this.addRows(i,e),t.push(e);var r=new n.Menu(s.Strings.MULTIPLE_RECOGNITION);i=[],this.buildMultipleRecognition(i),this.addRows(i,r),t.push(r),this.bindRecognitionEvents(),s.Settings.machines[s.Settings.Machine.FA].sidebar=t,console.log("[FA] Initialized successfully")},t.prototype.onEnter=function(){this.bindShortcuts(),r.System.unlockShortcutGroup(this.shortcutGroup),console.log("[FA] Bound events")},t.prototype.onExit=function(){r.System.lockShortcutGroup(this.shortcutGroup),console.log("[FA] Unbound events")},t.prototype.addRows=function(t,e){for(var i=0,n=t;i<n.length;i++){for(var s=n[i],r=o.utils.create("div",{className:"row"}),a=0,l=s;a<l.length;a++){var u=l[a];r.appendChild(u)}e.add(r)}},t.prototype.testCase=function(){return this.testCaseInput.value},t.prototype.buildTestCaseInput=function(t){this.testCaseInput=o.utils.create("input",{type:"text",placeholder:s.Strings.TEST_CASE}),t.push([this.testCaseInput])},t.prototype.highlightCurrentStates=function(){var t=s.Settings.controller().currentStates();s.Settings.automatonRenderer.recognitionHighlight(t)},t.prototype.buildRecognitionControls=function(t){var e=s.Settings.disabledButtonClass;this.fastRecognition=o.utils.create("img",{className:"image_button",src:"images/fastforward.svg",title:s.Strings.FAST_RECOGNITION}),this.stopRecognition=o.utils.create("img",{className:"image_button "+e,src:"images/stop.svg",title:s.Strings.STOP_RECOGNITION}),this.stepRecognition=o.utils.create("img",{className:"image_button",src:"images/play.svg",title:s.Strings.STEP_RECOGNITION}),t.push([this.fastRecognition,this.stepRecognition,this.stopRecognition])},t.prototype.buildRecognitionProgress=function(t){this.progressContainer=o.utils.create("div",{id:"recognition_progress"}),this.progressContainer.style.display="none",t.push([this.progressContainer])},t.prototype.buildMultipleRecognition=function(t){this.multipleCaseArea=o.utils.create("textarea"),this.multipleCaseArea.rows=s.Settings.multRecognitionAreaRows,this.multipleCaseArea.cols=s.Settings.multRecognitionAreaCols,this.multipleCaseResults=o.utils.create("div");var e=o.utils.create("div",{id:"multiple_recognition"});e.appendChild(this.multipleCaseArea),e.appendChild(this.multipleCaseResults),t.push([e]),this.multipleCaseButton=o.utils.create("img",{className:"image_button",src:"images/play.svg",title:s.Strings.START_MULTIPLE_RECOGNITION}),t.push([this.multipleCaseButton])},t.prototype.showAcceptanceStatus=function(){s.Settings.controller().accepts()?(this.progressContainer.style.color=s.Settings.acceptedTestCaseColor,this.progressContainer.innerHTML=s.Strings.INPUT_ACCEPTED):(this.progressContainer.style.color=s.Settings.rejectedTestCaseColor,this.progressContainer.innerHTML=s.Strings.INPUT_REJECTED)},t.prototype.bindRecognitionEvents=function(){var t=s.Settings.disabledButtonClass,e=!0,i=!0,n=!1,r=this,a=function(i){e=i,r.fastRecognition.classList[i?"remove":"add"](t)},l=function(e){i=e,r.stepRecognition.classList[e?"remove":"add"](t)},u=function(e){n=e,r.stopRecognition.classList[e?"remove":"add"](t)};this.fastRecognition.addEventListener("click",function(){if(e){s.Settings.automatonRenderer.lock();var t=r.testCase(),i=s.Settings.controller();i.fastForward(t),r.highlightCurrentStates(),r.progressContainer.style.display="",r.showAcceptanceStatus(),a(!1),l(!1),u(!0),r.testCaseInput.disabled=!0}}),this.stopRecognition.addEventListener("click",function(){n&&(s.Settings.controller().stop(),s.Settings.automatonRenderer.recognitionDim(),s.Settings.automatonRenderer.unlock(),r.progressContainer.style.color="black",r.progressContainer.style.display="none",a(!0),l(!0),u(!1),r.testCaseInput.disabled=!1)}),this.stepRecognition.addEventListener("click",function(){if(i){a(!1),u(!0),r.testCaseInput.disabled=!0;var t=r.testCase(),e=s.Settings.controller();if(e.isStopped()){s.Settings.automatonRenderer.lock(),r.progressContainer.style.display="";var n=o.utils.id(s.Settings.sidebarID),c=n.offsetWidth;c-=10,c-=1,r.progressContainer.style.width=c+"px"}var h=e.finished(t);h||(e.step(t),r.highlightCurrentStates(),h=e.finished(t));var p=e.stepPosition(),d=t.substr(p);""==d?r.showAcceptanceStatus():r.progressContainer.innerHTML=d,h&&l(!1)}}),this.multipleCaseButton.addEventListener("click",function(){var t=r.multipleCaseArea.value.split("\n"),e=s.Settings.controller();r.multipleCaseResults.innerHTML="";for(var i=0,n=t;i<n.length;i++){var a=n[i];e.fastForward(a);var l=o.utils.create("span");e.accepts()?(l.style.color=s.Settings.acceptedTestCaseColor,l.innerHTML=s.Strings.INPUT_ACCEPTED):(l.style.color=s.Settings.rejectedTestCaseColor,l.innerHTML=s.Strings.INPUT_REJECTED),r.multipleCaseResults.appendChild(l)}})},t.prototype.bindShortcuts=function(){var t=this;this.boundShortcuts||(r.System.bindShortcut(s.Settings.shortcuts.focusTestCase,function(){t.testCaseInput.focus()},this.shortcutGroup),r.System.bindShortcut(s.Settings.shortcuts.fastForward,function(){t.fastRecognition.click()},this.shortcutGroup),r.System.bindShortcut(s.Settings.shortcuts.step,function(){t.stepRecognition.click()},this.shortcutGroup),r.System.bindShortcut(s.Settings.shortcuts.stop,function(){t.stopRecognition.click()},this.shortcutGroup),r.System.bindShortcut(s.Settings.shortcuts.multipleRecognition,function(){t.multipleCaseButton.click()},this.shortcutGroup),this.boundShortcuts=!0),this.testCaseInput.addEventListener("keydown",function(e){e.keyCode==i.Keyboard.keys[s.Settings.shortcuts.dimTestCase[0]]&&t.testCaseInput==document.activeElement&&t.testCaseInput.blur()})},t}();e.initFA=a}),define("interface/Table",["require","exports","interface/Renderer","Utils"],function(t,e,i,n){"use strict";var s=function(t){function e(e,i){t.call(this),this.customColspans={},this.numRows=e,this.numColumns=i,this.children=[]}return __extends(e,t),e.prototype.add=function(t,e){e&&(this.customColspans[this.children.length]=e),this.children.push(t)},e.prototype.html=function(){for(var t=n.utils.create("table"),e=0,i=0;i<this.numRows;i++){for(var s=n.utils.create("tr"),r=0;r<this.numColumns;r++){var o=n.utils.create("td");if(e<this.children.length){if(this.customColspans.hasOwnProperty(e+"")){var a=this.customColspans[e];o.colSpan=a,r+=a-1}o.appendChild(this.children[e])}s.appendChild(o),e++}t.appendChild(s)}return t},e.prototype.onRender=function(){this.node.appendChild(this.html())},e}(i.Renderer);e.Table=s}),define("machines/PDA/initializer",["require","exports","Keyboard","interface/Menu","Settings","System","Utils"],function(t,e,i,n,s,r,o){"use strict";var a=function(){function t(){this.shortcutGroup="PDA",this.boundShortcuts=!1,this.testCaseInput=null,this.fastRecognition=null,this.stepRecognition=null,this.stopRecognition=null,this.progressContainer=null,this.stackContainer=null,this.multipleCaseArea=null,this.multipleCaseResults=null,this.multipleCaseButton=null}return t.prototype.init=function(){console.log("[PDA] Initializing...");var t=[],e=new n.Menu(s.Strings.RECOGNITION),i=[];this.buildTestCaseInput(i),this.buildRecognitionControls(i),this.buildStack(i),this.buildRecognitionProgress(i),this.addRows(i,e),t.push(e);var r=new n.Menu(s.Strings.MULTIPLE_RECOGNITION);i=[],this.buildMultipleRecognition(i),this.addRows(i,r),r.toggle(),t.push(r),this.bindRecognitionEvents(),s.Settings.machines[s.Settings.Machine.PDA].sidebar=t,console.log("[PDA] Initialized successfully")},t.prototype.onEnter=function(){this.bindShortcuts(),r.System.unlockShortcutGroup(this.shortcutGroup),console.log("[PDA] Bound events")},t.prototype.onExit=function(){r.System.lockShortcutGroup(this.shortcutGroup),console.log("[PDA] Unbound events")},t.prototype.addRows=function(t,e){for(var i=0,n=t;i<n.length;i++){for(var s=n[i],r=o.utils.create("div",{className:"row"}),a=0,l=s;a<l.length;a++){var u=l[a];r.appendChild(u)}e.add(r)}},t.prototype.testCase=function(){return this.testCaseInput.value},t.prototype.buildTestCaseInput=function(t){var e=o.utils.create("input",{type:"text",placeholder:s.Strings.TEST_CASE});t.push([e]),this.testCaseInput=e},t.prototype.highlightCurrentStates=function(){var t=s.Settings.controller().currentStates();s.Settings.automatonRenderer.recognitionHighlight(t)},t.prototype.buildRecognitionControls=function(t){var e=s.Settings.disabledButtonClass;this.fastRecognition=o.utils.create("img",{className:"image_button",src:"images/fastforward.svg",title:s.Strings.FAST_RECOGNITION}),this.stopRecognition=o.utils.create("img",{className:"image_button "+e,src:"images/stop.svg",title:s.Strings.STOP_RECOGNITION}),this.stepRecognition=o.utils.create("img",{className:"image_button",src:"images/play.svg",title:s.Strings.STEP_RECOGNITION}),t.push([this.fastRecognition,this.stepRecognition,this.stopRecognition])},t.prototype.buildStack=function(t){this.stackContainer=o.utils.create("div",{id:"stack"}),this.stackContainer.style.display="none",t.push([this.stackContainer])},t.prototype.buildRecognitionProgress=function(t){this.progressContainer=o.utils.create("div",{id:"recognition_progress"}),this.progressContainer.style.display="none",t.push([this.progressContainer])},t.prototype.buildMultipleRecognition=function(t){this.multipleCaseArea=o.utils.create("textarea"),this.multipleCaseArea.rows=s.Settings.multRecognitionAreaRows,this.multipleCaseArea.cols=s.Settings.multRecognitionAreaCols,this.multipleCaseResults=o.utils.create("div");var e=o.utils.create("div",{id:"multiple_recognition"});e.appendChild(this.multipleCaseArea),e.appendChild(this.multipleCaseResults),t.push([e]),this.multipleCaseButton=o.utils.create("img",{className:"image_button",src:"images/play.svg",title:s.Strings.START_MULTIPLE_RECOGNITION}),t.push([this.multipleCaseButton])},t.prototype.showAcceptanceStatus=function(){var t=s.Settings.controller();t.accepts()?(this.progressContainer.style.color=s.Settings.acceptedTestCaseColor,this.progressContainer.innerHTML=s.Strings.INPUT_ACCEPTED):(this.progressContainer.style.color=s.Settings.rejectedTestCaseColor,this.progressContainer.innerHTML=s.Strings.INPUT_REJECTED)},t.prototype.showStackContent=function(){var t=s.Settings.controller(),e=t.getStackContent();this.stackContainer.innerHTML=e.join("<br>")},t.prototype.bindRecognitionEvents=function(){var t=s.Settings.disabledButtonClass,e=!0,i=!0,n=!1,r=this,a=function(i){e=i,r.fastRecognition.classList[i?"remove":"add"](t)},l=function(e){i=e,r.stepRecognition.classList[e?"remove":"add"](t)},u=function(e){n=e,r.stopRecognition.classList[e?"remove":"add"](t)};this.fastRecognition.addEventListener("click",function(){if(e){s.Settings.automatonRenderer.lock();var t=r.testCase(),i=s.Settings.controller();i.fastForward(t),r.highlightCurrentStates(),r.progressContainer.style.display="",r.showAcceptanceStatus(),r.stackContainer.style.display="",r.showStackContent(),a(!1),l(!1),u(!0),r.testCaseInput.disabled=!0}}),this.stopRecognition.addEventListener("click",function(){n&&(s.Settings.controller().stop(),s.Settings.automatonRenderer.recognitionDim(),s.Settings.automatonRenderer.unlock(),r.progressContainer.style.color="black",r.progressContainer.style.display="none",r.stackContainer.style.display="none",a(!0),l(!0),u(!1),r.testCaseInput.disabled=!1)}),this.stepRecognition.addEventListener("click",function(){if(i){a(!1),u(!0),r.testCaseInput.disabled=!0;var t=r.testCase(),e=s.Settings.controller();if(e.isStopped()){e.reset(),s.Settings.automatonRenderer.lock();var n=o.utils.id(s.Settings.sidebarID),c=n.offsetWidth;c-=10,c-=1,r.progressContainer.style.width=c+"px",r.stackContainer.style.display=""}var h=e.finished(t);h||(e.step(t),r.highlightCurrentStates(),h=e.finished(t),r.showStackContent()),h&&(l(!1),r.progressContainer.style.display="",r.showAcceptanceStatus())}}),this.multipleCaseButton.addEventListener("click",function(){var t=r.multipleCaseArea.value.split("\n"),e=s.Settings.controller();r.multipleCaseResults.innerHTML="";for(var i=0,n=t;i<n.length;i++){var a=n[i];e.fastForward(a);var l=o.utils.create("span");e.accepts()?(l.style.color=s.Settings.acceptedTestCaseColor,l.innerHTML=s.Strings.INPUT_ACCEPTED):(l.style.color=s.Settings.rejectedTestCaseColor,l.innerHTML=s.Strings.INPUT_REJECTED),r.multipleCaseResults.appendChild(l)}})},t.prototype.bindShortcuts=function(){var t=this;this.boundShortcuts||(r.System.bindShortcut(s.Settings.shortcuts.focusTestCase,function(){t.testCaseInput.focus()},this.shortcutGroup),r.System.bindShortcut(s.Settings.shortcuts.fastForward,function(){t.fastRecognition.click()},this.shortcutGroup),r.System.bindShortcut(s.Settings.shortcuts.step,function(){t.stepRecognition.click()},this.shortcutGroup),r.System.bindShortcut(s.Settings.shortcuts.stop,function(){t.stopRecognition.click()},this.shortcutGroup),r.System.bindShortcut(s.Settings.shortcuts.multipleRecognition,function(){t.multipleCaseButton.click()},this.shortcutGroup),this.boundShortcuts=!0),this.testCaseInput.addEventListener("keydown",function(e){e.keyCode==i.Keyboard.keys[s.Settings.shortcuts.dimTestCase[0]]&&t.testCaseInput==document.activeElement&&t.testCaseInput.blur()})},t}();e.initPDA=a}),define("machines/LBA/initializer",["require","exports","Keyboard","interface/Menu","Settings","System","Utils"],function(t,e,i,n,s,r,o){"use strict";var a=function(){function t(){this.shortcutGroup="LBA",this.boundShortcuts=!1,this.testCaseInput=null,this.fastRecognition=null,this.stepRecognition=null,this.stopRecognition=null,this.progressContainer=null,this.tapeContainer=null,this.multipleCaseArea=null,this.multipleCaseResults=null,this.multipleCaseButton=null}return t.prototype.init=function(){console.log("[LBA] Initializing...");var t=[],e=new n.Menu(s.Strings.RECOGNITION),i=[];this.buildTestCaseInput(i),this.buildRecognitionControls(i),this.buildTape(i),this.buildRecognitionProgress(i),this.addRows(i,e),t.push(e);var r=new n.Menu(s.Strings.MULTIPLE_RECOGNITION);i=[],this.buildMultipleRecognition(i),this.addRows(i,r),t.push(r),this.bindRecognitionEvents(),s.Settings.machines[s.Settings.Machine.LBA].sidebar=t,console.log("[LBA] Initialized successfully")},t.prototype.onEnter=function(){this.bindShortcuts(),r.System.unlockShortcutGroup(this.shortcutGroup),console.log("[LBA] Bound events")},t.prototype.onExit=function(){r.System.lockShortcutGroup(this.shortcutGroup),console.log("[LBA] Unbound events")},t.prototype.addRows=function(t,e){for(var i=0,n=t;i<n.length;i++){for(var s=n[i],r=o.utils.create("div",{className:"row"}),a=0,l=s;a<l.length;a++){var u=l[a];r.appendChild(u)}e.add(r)}},t.prototype.testCase=function(){return this.testCaseInput.value},t.prototype.buildTestCaseInput=function(t){var e=o.utils.create("input",{type:"text",placeholder:s.Strings.TEST_CASE});t.push([e]),this.testCaseInput=e},t.prototype.highlightCurrentStates=function(){var t=s.Settings.controller().currentStates();s.Settings.automatonRenderer.recognitionHighlight(t)},t.prototype.buildRecognitionControls=function(t){var e=s.Settings.disabledButtonClass;this.fastRecognition=o.utils.create("img",{className:"image_button",src:"images/fastforward.svg",title:s.Strings.FAST_RECOGNITION}),this.stopRecognition=o.utils.create("img",{className:"image_button "+e,src:"images/stop.svg",title:s.Strings.STOP_RECOGNITION}),this.stepRecognition=o.utils.create("img",{className:"image_button",src:"images/play.svg",title:s.Strings.STEP_RECOGNITION}),t.push([this.fastRecognition,this.stepRecognition,this.stopRecognition])},t.prototype.buildTape=function(t){
this.tapeContainer=o.utils.create("div",{id:"tape"}),this.tapeContainer.style.display="none";for(var e=s.Settings.tapeDisplayedChars,i=0;i<e;i++){var n=o.utils.create("div",{className:"tape_cell"});this.tapeContainer.appendChild(n)}this.tapeContainer.children[(e-1)/2].classList.add("center"),t.push([this.tapeContainer])},t.prototype.buildRecognitionProgress=function(t){this.progressContainer=o.utils.create("div",{id:"recognition_progress"}),this.progressContainer.style.display="none",t.push([this.progressContainer])},t.prototype.buildMultipleRecognition=function(t){this.multipleCaseArea=o.utils.create("textarea"),this.multipleCaseArea.rows=s.Settings.multRecognitionAreaRows,this.multipleCaseArea.cols=s.Settings.multRecognitionAreaCols,this.multipleCaseResults=o.utils.create("div");var e=o.utils.create("div",{id:"multiple_recognition"});e.appendChild(this.multipleCaseArea),e.appendChild(this.multipleCaseResults),t.push([e]),this.multipleCaseButton=o.utils.create("img",{className:"image_button",src:"images/play.svg",title:s.Strings.START_MULTIPLE_RECOGNITION}),t.push([this.multipleCaseButton])},t.prototype.showAcceptanceStatus=function(){var t=s.Settings.controller();t.accepts()?(this.progressContainer.style.color=s.Settings.acceptedTestCaseColor,this.progressContainer.innerHTML=s.Strings.INPUT_ACCEPTED):(this.progressContainer.style.color=s.Settings.rejectedTestCaseColor,t.exhausted()?this.progressContainer.innerHTML=s.Strings.INPUT_LOOPING:this.progressContainer.innerHTML=s.Strings.INPUT_REJECTED)},t.prototype.showTapeContent=function(){var t=s.Settings.controller(),e=t.getTapeContent(),i=t.getHeadPosition(),n=s.Settings.tapeDisplayedChars,r=(n-1)/2,o=i-r;if(o<0){for(var a=[],l=0;l<-o;l++)a.push("_");e=a.concat(e),o=0}if(o+n>e.length)for(var u=o+n-e.length,l=0;l<u;l++)e.push("_");for(var c=e.slice(o,o+n),l=0;l<n;l++)this.tapeContainer.children[l].innerHTML=c[l]},t.prototype.bindRecognitionEvents=function(){var t=s.Settings.disabledButtonClass,e=!0,i=!0,n=!1,r=this,a=function(i){e=i,r.fastRecognition.classList[i?"remove":"add"](t)},l=function(e){i=e,r.stepRecognition.classList[e?"remove":"add"](t)},u=function(e){n=e,r.stopRecognition.classList[e?"remove":"add"](t)};this.fastRecognition.addEventListener("click",function(){if(e){s.Settings.automatonRenderer.lock();var t=r.testCase(),i=s.Settings.controller();i.fastForward(t),r.highlightCurrentStates(),r.progressContainer.style.display="",r.showAcceptanceStatus(),r.tapeContainer.style.display="",r.showTapeContent(),a(!1),l(!1),u(!0),r.testCaseInput.disabled=!0}}),this.stopRecognition.addEventListener("click",function(){n&&(s.Settings.controller().stop(),s.Settings.automatonRenderer.recognitionDim(),s.Settings.automatonRenderer.unlock(),r.progressContainer.style.color="black",r.progressContainer.style.display="none",r.tapeContainer.style.display="none",a(!0),l(!0),u(!1),r.testCaseInput.disabled=!1)}),this.stepRecognition.addEventListener("click",function(){if(i){a(!1),u(!0),r.testCaseInput.disabled=!0;var t=r.testCase(),e=s.Settings.controller();if(e.isStopped()){e.reset(),s.Settings.automatonRenderer.lock();var n=o.utils.id(s.Settings.sidebarID),c=n.offsetWidth;c-=10,c-=1,r.progressContainer.style.width=c+"px",r.tapeContainer.style.display=""}var h=e.finished(t);h||(e.step(t),r.highlightCurrentStates(),h=e.finished(t),r.showTapeContent()),h&&(l(!1),r.progressContainer.style.display="",r.showAcceptanceStatus())}}),this.multipleCaseButton.addEventListener("click",function(){var t=r.multipleCaseArea.value.split("\n"),e=s.Settings.controller();r.multipleCaseResults.innerHTML="";for(var i=0,n=t;i<n.length;i++){var a=n[i];e.fastForward(a);var l=o.utils.create("span");e.accepts()?(l.style.color=s.Settings.acceptedTestCaseColor,l.innerHTML=s.Strings.INPUT_ACCEPTED):(l.style.color=s.Settings.rejectedTestCaseColor,e.exhausted()?l.innerHTML=s.Strings.INPUT_LOOPING.split("<br>").join(" "):l.innerHTML=s.Strings.INPUT_REJECTED),r.multipleCaseResults.appendChild(l)}})},t.prototype.bindShortcuts=function(){var t=this;this.boundShortcuts||(r.System.bindShortcut(s.Settings.shortcuts.focusTestCase,function(){t.testCaseInput.focus()},this.shortcutGroup),r.System.bindShortcut(s.Settings.shortcuts.fastForward,function(){t.fastRecognition.click()},this.shortcutGroup),r.System.bindShortcut(s.Settings.shortcuts.step,function(){t.stepRecognition.click()},this.shortcutGroup),r.System.bindShortcut(s.Settings.shortcuts.stop,function(){t.stopRecognition.click()},this.shortcutGroup),r.System.bindShortcut(s.Settings.shortcuts.multipleRecognition,function(){t.multipleCaseButton.click()},this.shortcutGroup),this.boundShortcuts=!0),this.testCaseInput.addEventListener("keydown",function(e){e.keyCode==i.Keyboard.keys[s.Settings.shortcuts.dimTestCase[0]]&&t.testCaseInput==document.activeElement&&t.testCaseInput.blur()})},t}();e.initLBA=a}),define("lists/InitializerList",["require","exports","machines/FA/initializer","machines/PDA/initializer","machines/LBA/initializer"],function(t,e,i,n,s){"use strict";function r(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}r(i),r(n),r(s)}),define("Initializer",["require","exports","Utils"],function(t,e,i){"use strict";var n=function(){function t(){}return t.exec=function(t){i.utils.foreach(t,function(t,e){e.init()})},t}();e.Initializer=n}),define("Settings",["require","exports","lists/MachineList","lists/ControllerList","lists/LanguageList","lists/InitializerList","Initializer","Utils"],function(t,e,i,n,s,r,o,a){"use strict";var l;!function(t){function l(){return this.machines[this.currentMachine].controller}function u(){if(p)for(var e in t.Machine)t.Machine.hasOwnProperty(e)&&!isNaN(parseInt(e))&&(t.controllerMap[e]=new n[t.Machine[e]+"Controller"],t.initializerMap[e]=new r["init"+t.Machine[e]]);var i={};for(var e in t.Machine)t.Machine.hasOwnProperty(e)&&!isNaN(parseInt(e))&&(i[e]={name:t.language.strings[t.Machine[e]],sidebar:[],controller:t.controllerMap[e],initializer:t.initializerMap[e]});a.utils.foreach(i,function(e,i){t.machines[e]=i}),o.Initializer.exec(t.initializerMap),p&&t.machines[t.currentMachine].initializer.onEnter(),p=!1}function c(i){t.language=i,e.Strings=t.language.strings,u()}function h(e){t.machines[t.currentMachine].initializer.onExit(),t.currentMachine=e,t.machines[t.currentMachine].initializer.onEnter()}t.sidebarID="sidebar",t.mainbarID="mainbar",t.disabledButtonClass="disabled",t.canvasShortcutID="canvas",t.undoMaxAmount=2,t.menuSlideInterval=300,t.promptSlideInterval=200,t.machineSelRows=3,t.machineSelColumns=1,t.machineActionRows=2,t.machineActionColumns=2,t.tapeDisplayedChars=7,t.multRecognitionAreaRows=4,t.multRecognitionAreaCols=15,t.stateRadius=32,t.stateRingRadius=27,t.stateDragTolerance=50,t.stateFillColor="white",t.stateStrokeColor="black",t.stateStrokeWidth=1,t.stateRingStrokeWidth=1,t.stateLabelFontFamily="arial",t.stateLabelFontSize=20,t.stateLabelFontColor="black",t.stateInitialMarkLength=40,t.stateInitialMarkHeadLength=15,t.stateInitialMarkAngle=a.utils.toRadians(20),t.stateInitialMarkColor="blue",t.stateInitialMarkThickness=2,t.stateHighlightPalette={fillColor:"#FFD574",strokeColor:"red",strokeWidth:3,ringStrokeWidth:2},t.stateRecognitionPalette={fillColor:"#CCC",strokeColor:"black",strokeWidth:3,ringStrokeWidth:2},t.edgeStrokeColor="black",t.edgeHighlightColor="red",t.edgeArrowThickness=2,t.edgeArrowLength=30,t.edgeArrowAngle=a.utils.toRadians(30),t.edgeTextFontFamily="arial",t.edgeTextFontSize=20,t.edgeTextFontColor="black",t.acceptedTestCaseColor="green",t.rejectedTestCaseColor="red",t.shortcuts={save:["ctrl","S"],open:["ctrl","O"],toggleInitial:["I"],toggleFinal:["F"],dimSelection:["ESC"],deleteEntity:["DELETE"],clearMachine:["C"],left:["LEFT"],right:["RIGHT"],up:["UP"],down:["DOWN"],undo:["ctrl","Z"],focusTestCase:["ctrl","I"],dimTestCase:["ENTER"],fastForward:["R"],step:["N"],stop:["S"],multipleRecognition:["M"]},t.languages=s,t.Machine=i.Machine,t.language=s.english,t.currentMachine=0,t.machines={},t.controllerMap={},t.initializerMap={},t.sidebar=null,t.automatonRenderer=null,t.controller=l;var p=!0;t.update=u,t.changeLanguage=c,t.changeMachine=h}(l=e.Settings||(e.Settings={})),e.Strings=l.language.strings}),define("interface/Edge",["require","exports","Settings","Utils"],function(t,e,i,n){"use strict";var s=function(){function t(){this.origin=null,this.target=null,this.prevOriginPosition=null,this.prevTargetPosition=null,this.virtualTarget=null,this.textList=[],this.dataList=[],this.curved=!1,this.forcedRender=!1,this.deleted=!1,this.defaultColor=i.Settings.edgeStrokeColor,this.color=this.defaultColor,this.body=[],this.head=[],this.textContainer=null}return t.prototype.setOrigin=function(t){this.origin=t},t.prototype.getOrigin=function(){return this.origin},t.prototype.setTarget=function(t){this.target=t},t.prototype.getTarget=function(){return this.target},t.prototype.setVirtualTarget=function(t){this.virtualTarget=t},t.prototype.addText=function(t){this.textList.push(t)},t.prototype.getTextList=function(){return this.textList},t.prototype.addData=function(t){this.dataList.push(t)},t.prototype.getDataList=function(){return this.dataList},t.prototype.setCurveFlag=function(t){this.forcedRender=this.forcedRender||this.curved!=t,this.curved=t},t.prototype.isCurved=function(){return this.curved},t.prototype.removed=function(){return this.deleted},t.prototype.addClickHandler=function(t){for(var e=this,i=0,n=this.body;i<n.length;i++){var s=n[i];s.click(function(i){t.call(e)})}},t.prototype.remove=function(){for(var t=0,e=this.body;t<e.length;t++){var i=e[t];i.remove()}this.body=[];for(var n=0,s=this.head;n<s.length;n++){var i=s[n];i.remove()}this.head=[],this.textContainer&&(this.textContainer.remove(),this.textContainer=null),this.deleted=!0},t.prototype.setCustomColor=function(t){this.color=t},t.prototype.removeCustomColor=function(){this.color=this.defaultColor},t.prototype.render=function(t){var e=this.origin&&n.utils.samePoint(this.prevOriginPosition,this.origin.getPosition()),i=this.target&&n.utils.samePoint(this.prevTargetPosition,this.target.getPosition());e&&i&&!this.forcedRender||(this.renderBody(t),this.renderHead(t),this.origin&&(this.prevOriginPosition=this.origin.getPosition()),this.target&&(this.prevTargetPosition=this.target.getPosition()),this.forcedRender=!1);for(var s=0,r=this.body;s<r.length;s++){var o=r[s];o.attr("stroke",this.strokeColor())}for(var a=0,l=this.head;a<l.length;a++){var o=l[a];o.attr("stroke",this.strokeColor())}this.target&&this.renderText(t)},t.prototype.strokeColor=function(){return this.color},t.prototype.stateCenterOffsets=function(t,e){var n=Math.atan2(e,t),s=Math.sin(n),r=Math.cos(n),o=i.Settings.stateRadius*r,a=i.Settings.stateRadius*s;return{x:o,y:a}},t.prototype.renderBody=function(t){var e,n=this.origin.getPosition();if(this.target)e=this.target.getPosition();else if(this.virtualTarget){e={x:this.virtualTarget.x,y:this.virtualTarget.y};var s=e.x-n.x,r=e.y-n.y;e.x=n.x+.98*s,e.y=n.y+.98*r}else e=n;var o=e.x-n.x,a=e.y-n.y,l=i.Settings.stateRadius,u=this.stateCenterOffsets(o,a);o*o+a*a>l*l&&(n.x+=u.x,n.y+=u.y),this.target&&(e.x-=u.x,e.y-=u.y),this.origin==this.target?this.loop(t):this.isCurved()?this.curve(t,n,e):this.normal(t,n,e)},t.prototype.adjustBodyLength=function(t,e){if(this.body.length==e)return!1;for(;this.body.length>e;)this.body[this.body.length-1].remove(),this.body.pop();for(;this.body.length<e;)this.body.push(n.utils.line(t,0,0,0,0));return!0},t.prototype.loop=function(t){var e=i.Settings.stateRadius,s=this.origin.getPosition();if(this.adjustBodyLength(t,4))for(var r=0,o=this.body;r<o.length;r++){var a=o[r];a.attr("stroke-width",i.Settings.edgeArrowThickness)}this.body[0].attr("path",n.utils.linePath(s.x+e,s.y,s.x+2*e,s.y)),this.body[1].attr("path",n.utils.linePath(s.x+2*e,s.y,s.x+2*e,s.y-2*e)),this.body[2].attr("path",n.utils.linePath(s.x+2*e,s.y-2*e,s.x,s.y-2*e)),this.body[3].attr("path",n.utils.linePath(s.x,s.y-2*e,s.x,s.y-e))},t.prototype.curve=function(t,e,s){var r=s.x-e.x,o=s.y-e.y,a=Math.sqrt(r*r+o*o),l={x:o/a,y:-r/a},u=30,c={x:u*l.x,y:u*l.y};if(this.adjustBodyLength(t,3))for(var h=0,p=this.body;h<p.length;h++){var d=p[h];d.attr("stroke-width",i.Settings.edgeArrowThickness)}this.body[0].attr("path",n.utils.linePath(e.x,e.y,e.x+c.x+.125*r,e.y+c.y+.125*o)),this.body[1].attr("path",n.utils.linePath(e.x+c.x+.125*r,e.y+c.y+.125*o,e.x+c.x+.875*r,e.y+c.y+.875*o)),this.body[2].attr("path",n.utils.linePath(e.x+c.x+.875*r,e.y+c.y+.875*o,s.x,s.y))},t.prototype.normal=function(t,e,s){if(this.adjustBodyLength(t,1))for(var r=0,o=this.body;r<o.length;r++){var a=o[r];a.attr("stroke-width",i.Settings.edgeArrowThickness)}this.body[0].attr("path",n.utils.linePath(e.x,e.y,s.x,s.y))},t.prototype.renderHead=function(t){if(this.target){var e,s,r,o;if(this.origin==this.target){var a=this.origin.getPosition(),l=i.Settings.stateRadius;e={x:a.x,y:a.y-2*l},s={x:a.x,y:a.y-l},r=0,o=l}else if(this.isCurved()){var u=this.body[2].attr("path");e={x:u[0][1],y:u[0][2]},s={x:u[1][1],y:u[1][2]},r=s.x-e.x,o=s.y-e.y}else{e=this.origin.getPosition(),s=this.target.getPosition(),r=s.x-e.x,o=s.y-e.y;var c=this.stateCenterOffsets(r,o);s.x-=c.x,s.y-=c.y,r-=c.x,o-=c.y}var h=i.Settings.edgeArrowLength,p=i.Settings.edgeArrowAngle,d=Math.sqrt(r*r+o*o),g=1-h/d,f={x:e.x+g*r,y:e.y+g*o},S=n.utils.rotatePoint(f,s,p),y=n.utils.rotatePoint(f,s,-p);if(!this.head.length){this.head.push(n.utils.line(t,0,0,0,0)),this.head.push(n.utils.line(t,0,0,0,0));for(var m=0,v=this.head;m<v.length;m++){var E=v[m];E.attr("stroke-width",i.Settings.edgeArrowThickness)}}this.head[0].attr("path",n.utils.linePath(S.x,S.y,s.x,s.y)),this.head[1].attr("path",n.utils.linePath(y.x,y.y,s.x,s.y))}},t.prototype.preparedText=function(){return this.textList.join("\n")},t.prototype.renderText=function(t){var e,s,r=this.origin.getPosition(),o=this.target.getPosition();if(this.origin==this.target){var a=i.Settings.stateRadius;e=r.x+a,s=r.y-2*a}else if(this.isCurved()){var l=this.body[1].attr("path"),u=l[0][1],c=l[0][2],h=l[1][1],p=l[1][2];e=(u+h)/2,s=(c+p)/2}else e=(r.x+o.x)/2,s=(r.y+o.y)/2;this.textContainer?(this.textContainer.attr("x",e),this.textContainer.attr("y",s),this.textContainer.attr("text",this.preparedText()),this.textContainer.transform("")):(this.textContainer=t.text(e,s,this.preparedText()),this.textContainer.attr("font-family",i.Settings.edgeTextFontFamily),this.textContainer.attr("font-size",i.Settings.edgeTextFontSize),this.textContainer.attr("stroke",i.Settings.edgeTextFontColor),this.textContainer.attr("fill",i.Settings.edgeTextFontColor));var d=Math.atan2(o.y-r.y,o.x-r.x),g=n.utils.toDegrees(d);(g<-90||g>90)&&(g=(g+180)%360),this.textContainer.rotate(g),s-=.6*i.Settings.edgeTextFontSize,s-=i.Settings.edgeTextFontSize*(this.textList.length-1)*.7,this.textContainer.attr("y",s)},t}();e.Edge=s}),define("interface/EdgeUtils",["require","exports","Settings"],function(t,e,i){"use strict";var n;!function(t){function e(t,e){var n=i.Settings.controller();t.addText(n.edgeDataToText(e)),t.addData(e),n.createEdge(t.getOrigin(),t.getTarget(),e)}t.addEdgeData=e}(n=e.EdgeUtils||(e.EdgeUtils={}))}),define("Persistence",["require","exports","interface/Edge","interface/EdgeUtils","Settings","interface/State"],function(t,e,i,n,s,r){"use strict";var o;!function(t){function e(t,e,i){for(var n=[s.Settings.Machine[s.Settings.currentMachine],[],[],-1],r=0,o=0,a=t;o<a.length;o++){var l=a[o],u=l.getPosition();n[1].push([l.getName(),l.isFinal()?1:0,u.x,u.y]),l==i&&(n[3]=r),r++}for(var c=0,h=e;c<h.length;c++){var p=h[c];n[2].push([p.getOrigin().getName(),p.getTarget().getName(),p.getDataList()])}return JSON.stringify(n)}function o(t){var e={error:!1,initialState:null,stateList:[],edgeList:[]},i=[];try{i=JSON.parse(t)}catch(t){return e.error=!0,e}var n=s.Settings.Machine[s.Settings.currentMachine],r=i[0]==n&&i[1]instanceof Array&&i[2]instanceof Array&&"number"==typeof i[3]&&4==i.length;if(!r)return e.error=!0,e;var o={},u=a(i,e,function(t){o[t.getName()]={}});return l(i,e,u,o)?e:(e.error=!0,e)}function a(t,e,i){for(var n={},o=s.Settings.controller(),a=0,l=0,u=t[1];l<u.length;l++){var c=u[l],h=t[3]==a,p=new r.State;p.setName(c[0]),p.setInitial(h),p.setFinal(!!c[1]),p.setPosition(c[2],c[3]),h&&(e.initialState=p),n[c[0]]=a,i(p),e.stateList.push(p),o.createState(p),a++}return n}function l(t,e,s,r){for(var o=e.stateList,a=0,l=t[2];a<l.length;a++){var u=l[a];if(3!=u.length)return!1;var c=new i.Edge,h=u[0],p=u[1],d=o[s[h]],g=o[s[p]];if(c.setOrigin(d),c.setTarget(g),r[p].hasOwnProperty(h)){var f=r[p][h];f.setCurveFlag(!0),c.setCurveFlag(!0)}for(var S=0,y=u[2];S<y.length;S++){var m=y[S];n.EdgeUtils.addEdgeData(c,m)}r[h][p]=c,e.edgeList.push(c)}return!0}t.save=e,t.load=o}(o=e.Persistence||(e.Persistence={}))}),define("Memento",["require","exports"],function(t,e){"use strict";var i=function(){function t(t){this.bottomIndex=0,this.topIndex=-1,this.states={},this.limit=t}return t.prototype.push=function(t){var e=this.limit()+1;this.topIndex-this.bottomIndex+1==e&&(delete this.states[this.bottomIndex],this.bottomIndex++),this.topIndex++,this.states[this.topIndex]=t},t.prototype.pop=function(){var t=this.states[this.topIndex-1];return delete this.states[this.topIndex],this.topIndex--,t},t}();e.Memento=i}),define("interface/AutomatonRenderer",["require","exports","interface/Edge","Persistence","Prompt","Settings","interface/State","System","interface/Table","Utils"],function(t,e,i,n,s,r,o,a,l,u){"use strict";var c=function(){function t(t,e,i){this.canvas=null,this.node=null,this.stateList=[],this.edgeList=[],this.highlightedState=null,this.highlightedEdge=null,this.initialState=null,this.edgeMode=!1,this.currentEdge=null,this.locked=!1,this.memento=null,this.frozenMemento=!1,this.canvas=t,this.memento=i,this.node=e}return t.prototype.render=function(){this.bindEvents(),this.bindShortcuts(),this.bindFormalDefinitionListener();var t=this;a.System.addLanguageChangeObserver({onLanguageChange:function(){t.bindFormalDefinitionListener()}}),a.System.addMachineChangeObserver({onMachineChange:function(){t.bindFormalDefinitionListener()}})},t.prototype.clear=function(){for(var t=0,e=this.stateList;t<e.length;t++){var i=e[t];i.remove()}this.stateList=[];for(var n=0,s=this.edgeList;n<s.length;n++){var o=s[n];o.remove()}this.edgeList=[],this.initialState=null,this.clearSelection(),r.Settings.controller().clear()},t.prototype.empty=function(){return 0==this.stateList.length},t.prototype.save=function(){return n.Persistence.save(this.stateList,this.edgeList,this.initialState)},t.prototype.load=function(t,e){void 0===e&&(e=!0),this.frozenMemento=!0;var i=n.Persistence.load(t);if(i.error)return void alert(r.Strings.INVALID_FILE);this.stateList=this.stateList.concat(i.stateList),this.edgeList=this.edgeList.concat(i.edgeList),null===this.initialState&&(this.initialState=i.initialState);for(var s=0,o=this.stateList;s<o.length;s++){var a=o[s];a.render(this.canvas),this.bindStateEvents(a)}for(var l=0,u=this.edgeList;l<u.length;l++){var c=u[l];c.render(this.canvas),this.bindEdgeEvents(c)}this.frozenMemento=!1,e&&this.memento.push(this.save())},t.prototype.recognitionHighlight=function(t){for(var e={},i=0,n=this.stateList;i<n.length;i++){var s=n[i];e[s.getName()]=s,s.removePalette()}for(var o=0,a=t;o<a.length;o++){var l=a[o];e[l].applyPalette(r.Settings.stateRecognitionPalette)}for(var u=0,c=this.stateList;u<c.length;u++){var s=c[u];s.render(this.canvas)}},t.prototype.recognitionDim=function(){for(var t=0,e=this.stateList;t<e.length;t++){var i=e[t];i.removePalette(),i.render(this.canvas)}this.highlightedState=null},t.prototype.lock=function(){a.System.lockShortcutGroup(r.Settings.canvasShortcutID),this.locked=!0},t.prototype.unlock=function(){a.System.unlockShortcutGroup(r.Settings.canvasShortcutID),this.locked=!1},t.prototype.stateManualCreation=function(){var t=r.Settings.stateRadius;this.newStateAt(t,t)},t.prototype.edgeManualCreation=function(){if(!this.locked){var t=this;s.Prompt.simple(r.Strings.EDGE_MANUAL_CREATION,2,function(e){for(var n=new i.Edge,s=0,o=t.stateList;s<o.length;s++){var a=o[s],l=a.getName();l==e[0]&&n.setOrigin(a),l==e[1]&&n.setTarget(a)}n.getOrigin()&&n.getTarget()?(t.currentEdge=n,t.finishEdge(n.getTarget())):alert(r.Strings.ERROR_INVALID_STATE_NAME)})}},t.prototype.bindFormalDefinitionListener=function(){var t=null,e=this,i=function(){e.frozenMemento||e.memento.push(e.save()),t||(t=u.utils.create("div"),r.Settings.sidebar.updateFormalDefinition(t)),t.innerHTML=e.buildFormalDefinition()};r.Settings.controller().setEditingCallback(i),i()},t.prototype.buildFormalDefinition=function(){var t=r.Settings.controller().formalDefinition(),e=t.tupleSequence,i="M = ("+e.join(", ")+")";i+=r.Strings.DEFINITION_WHERE_SUFFIX+"<br>";for(var n=0,s=t.parameterSequence;n<s.length;n++){var o=s[n],a=t.parameterValues[o],c=typeof a;if(i+=o+" = ","number"==c||"string"==c)i+=a;else if(a instanceof Array)i+="{"+a.join(", ")+"}";else if("undefined"==c)i+="<span class='none'>",i+=r.Strings.NO_INITIAL_STATE,i+="</span>";else if(a.hasOwnProperty("list")){var h=a.list;if(h.length>0){for(var p=new l.Table(h.length,h[0].length),d=0;d<h.length;d++)for(var g=0;g<h[d].length;g++)p.add(u.utils.create("span",{innerHTML:h[d][g]}));i+="<table id='transition_table'>",i+=p.html().innerHTML,i+="</table>"}else i+="<span class='none'>",i+=r.Strings.NO_TRANSITIONS,i+="</span>"}else i+="unspecified type (AutomatonRenderer:235)";i+="<br>"}return i},t.prototype.selectState=function(t){this.locked||(this.dimEdge(),this.highlightedState&&(this.highlightedState.removePalette(),this.highlightedState.render(this.canvas)),t.applyPalette(r.Settings.stateHighlightPalette),this.highlightedState=t,t.render(this.canvas),this.updateEditableState(t))},t.prototype.dimState=function(){!this.locked&&this.highlightedState&&(this.highlightedState.removePalette(),this.highlightedState.render(this.canvas),this.highlightedState=null,r.Settings.sidebar.unsetSelectedEntityContent())},t.prototype.selectEdge=function(t){this.locked||(this.dimState(),this.highlightedEdge&&(this.highlightedEdge.removeCustomColor(),this.highlightedEdge.render(this.canvas)),t.setCustomColor(r.Settings.edgeHighlightColor),this.highlightedEdge=t,t.render(this.canvas),this.updateEditableEdge(t))},t.prototype.dimEdge=function(){!this.locked&&this.highlightedEdge&&(this.highlightedEdge.removeCustomColor(),this.highlightedEdge.render(this.canvas),this.highlightedEdge=null,r.Settings.sidebar.unsetSelectedEntityContent())},t.prototype.updateEditableState=function(t){r.Settings.sidebar.unsetSelectedEntityContent(),t&&r.Settings.sidebar.setSelectedEntityContent(this.showEditableState(t))},t.prototype.updateEditableEdge=function(t){r.Settings.sidebar.unsetSelectedEntityContent(),t&&r.Settings.sidebar.setSelectedEntityContent(this.showEditableEdge(t))},t.prototype.showEditableState=function(t){var e=u.utils.create("div"),i=new l.Table(4,3),n=this.canvas,o=this,a=u.utils.create("input",{type:"button",value:r.Strings.RENAME_STATE,click:function(){var t=new s.Prompt(r.Strings.STATE_RENAME_ACTION);t.addInput({validator:function(t){return t.length<=6}}),t.show()}}),c=u.utils.create("input",{type:"button",value:r.Strings.TOGGLE_PROPERTY,click:function(){o.setInitialState(t),t.render(n),$("#entity_initial").html(t.isInitial()?r.Strings.YES:r.Strings.NO)}}),h=u.utils.create("input",{type:"button",value:r.Strings.TOGGLE_PROPERTY,click:function(){o.changeFinalFlag(t,!t.isFinal()),t.render(n),$("#entity_final").html(t.isFinal()?r.Strings.YES:r.Strings.NO)}}),p=u.utils.create("input",{type:"button",value:r.Strings.DELETE_STATE,click:function(){o.deleteState(t),o.clearSelection(),r.Settings.sidebar.unsetSelectedEntityContent()}});return i.add(u.utils.create("span",{innerHTML:r.Strings.STATE_NAME+":"})),i.add(u.utils.create("span",{innerHTML:t.getName(),className:"property_value",id:"entity_name"})),i.add(a),i.add(u.utils.create("span",{innerHTML:r.Strings.STATE_IS_INITIAL+":"})),i.add(u.utils.create("span",{innerHTML:t.isInitial()?r.Strings.YES:r.Strings.NO,className:"property_value",id:"entity_initial"})),i.add(c),i.add(u.utils.create("span",{innerHTML:r.Strings.STATE_IS_FINAL+":"})),i.add(u.utils.create("span",{innerHTML:t.isFinal()?r.Strings.YES:r.Strings.NO,className:"property_value",id:"entity_final"})),i.add(h),i.add(p,3),e.appendChild(i.html()),e},t.prototype.fixEdgeConsistency=function(t){for(var e=t.getOrigin(),i=t.getTarget(),n=null,s=null,r=-1,o=!1,a=0,l=0,u=this.edgeList;l<u.length;l++){var c=u[l];if(c.getOrigin()==e&&c.getTarget()==i)if(c!=t){for(var h=t.getDataList(),p=t.getTextList(),d=h.length,g=0;g<d;g++)c.addData(h[g]),c.addText(p[g]);c.render(this.canvas),s=c,o=!0}else r=a;else c.getOrigin()==i&&c.getTarget()==e&&(n=c);a++}n?(n.setCurveFlag(!0),n.render(this.canvas),t.setCurveFlag(!0),t.render(this.canvas)):(t.setCurveFlag(!1),t.render(this.canvas)),o&&r>-1&&(this.highlightedEdge==t&&this.selectEdge(s),t.remove(),this.edgeList.splice(r,1))},t.prototype.showEditableEdge=function(t){var e=u.utils.create("div"),i=new l.Table(5,3),n=this.canvas,s=this,o=u.utils.create("input",{type:"button",value:r.Strings.CHANGE_PROPERTY,click:function(){var e=prompt(r.Strings.EDGE_ENTER_NEW_ORIGIN);if(null!==e){for(var i=0,o=s.stateList;i<o.length;i++){var a=o[i];a.getName()==e&&(t.setOrigin(a),s.fixEdgeConsistency(t))}t.removed()||t.render(n),$("#entity_origin").html(e)}}}),a=u.utils.create("input",{type:"button",value:r.Strings.CHANGE_PROPERTY,click:function(){var e=prompt(r.Strings.EDGE_ENTER_NEW_TARGET);if(null!==e){for(var i=0,o=s.stateList;i<o.length;i++){var a=o[i];a.getName()==e&&(t.setTarget(a),s.fixEdgeConsistency(t))}t.removed()||t.render(n),$("#entity_target").html(e)}}}),c=u.utils.create("input",{type:"button",value:r.Strings.CHANGE_PROPERTY,click:function(){var e=$("#entity_transition_list").get(0),i=e.selectedIndex,n=r.Settings.controller();n.edgePrompt(function(e,r){var o=t.getOrigin(),a=t.getTarget(),l=t.getDataList();n.deleteEdge(o,a,l[i]),t.getDataList()[i]=e,t.getTextList()[i]=r,t.render(s.canvas),n.createEdge(o,a,e),s.updateEditableEdge(t)})}}),h=u.utils.create("input",{type:"button",value:r.Strings.DELETE_SELECTED_TRANSITION,click:function(){var e=$("#entity_transition_list").get(0),i=e.selectedIndex,n=r.Settings.controller(),o=t.getOrigin(),a=t.getTarget(),l=t.getDataList();n.deleteEdge(o,a,l[i]),t.getDataList().splice(i,1),t.getTextList().splice(i,1),0==l.length?(s.deleteEdge(t),s.clearSelection(),r.Settings.sidebar.unsetSelectedEntityContent()):(t.render(s.canvas),s.updateEditableEdge(t))}}),p=u.utils.create("input",{title:u.utils.printShortcut(r.Settings.shortcuts.deleteEntity),type:"button",value:r.Strings.DELETE_ALL_TRANSITIONS,click:function(){s.deleteEdge(t),s.clearSelection(),r.Settings.sidebar.unsetSelectedEntityContent()}});i.add(u.utils.create("span",{innerHTML:r.Strings.ORIGIN+":"})),i.add(u.utils.create("span",{innerHTML:t.getOrigin().getName(),className:"property_value",id:"entity_origin"})),i.add(o),i.add(u.utils.create("span",{innerHTML:r.Strings.TARGET+":"})),i.add(u.utils.create("span",{innerHTML:t.getTarget().getName(),className:"property_value",id:"entity_target"})),i.add(a);for(var d=u.utils.create("select",{id:"entity_transition_list"}),g=t.getTextList(),f=0,S=0,y=g;S<y.length;S++){var m=y[S],v=u.utils.create("option",{value:f,innerHTML:m});d.appendChild(v),f++}return i.add(u.utils.create("span",{innerHTML:r.Strings.TRANSITIONS+":"})),i.add(d),i.add(c),i.add(h,3),i.add(p,3),e.appendChild(i.html()),e},t.prototype.bindEvents=function(){for(var t=0,e=this.stateList;t<e.length;t++){var i=e[t];i.render(this.canvas),this.bindStateEvents(i)}for(var n=0,s=this.edgeList;n<s.length;n++){var r=s[n];this.bindEdgeEvents(r)}var o=this;$(this.node).dblclick(function(t){o.newStateAt(t.pageX-this.offsetLeft,t.pageY-this.offsetTop)}),$(this.node).contextmenu(function(t){return t.preventDefault(),!1}),$(this.node).mousemove(function(t){o.edgeMode&&o.adjustEdge(this,t)})},t.prototype.bindEdgeEvents=function(t){var e=this;t.addClickHandler(function(){e.selectEdge(this)})},t.prototype.bindStateEvents=function(t){var e=(this.canvas,this);t.drag(function(){e.updateEdges()},function(i,n){return!e.locked&&i<=r.Settings.stateDragTolerance?(e.edgeMode?e.finishEdge(t):u.utils.isRightClick(n)?e.beginEdge(t):t==e.highlightedState?e.dimState():e.selectState(t),!1):(e.memento.push(e.save()),!0)})},t.prototype.beginEdge=function(t){this.edgeMode=!0,this.currentEdge=new i.Edge,this.currentEdge.setOrigin(t)},t.prototype.finishEdge=function(t){this.edgeMode=!1;for(var e=this.currentEdge.getOrigin(),i=function(i,n){var s=r.Settings.controller();s.edgePrompt(function(n,r){s.createEdge(e,t,n),i(n,r)},n)},n=this,s=null,o=function(){n.currentEdge.remove(),n.currentEdge=null},a=function(r){return r.getOrigin()==e&&r.getTarget()==t?(i(function(t,e){r.addText(e),r.addData(t),r.render(n.canvas),o()},o),{value:void 0}):void(r.getOrigin()==t&&r.getTarget()==e&&(s=r))},l=0,u=this.edgeList;l<u.length;l++){var c=u[l],h=a(c);if("object"==typeof h)return h.value}s&&(s.setCurveFlag(!0),s.render(this.canvas),this.currentEdge.setCurveFlag(!0)),this.currentEdge.setTarget(t),this.currentEdge.render(this.canvas),i(function(t,e){n.currentEdge.addText(e),n.currentEdge.addData(t),n.bindEdgeEvents(n.currentEdge),n.currentEdge.render(n.canvas),n.edgeList.push(n.currentEdge),n.currentEdge=null},function(){o(),s&&(s.setCurveFlag(!1),s.render(n.canvas))})},t.prototype.adjustEdge=function(t,e){var i={x:e.pageX-t.offsetLeft,y:e.pageY-t.offsetTop};this.currentEdge.setVirtualTarget(i),this.currentEdge.render(this.canvas)},t.prototype.updateEdges=function(){for(var t=0,e=this.edgeList;t<e.length;t++){var i=e[t];i.render(this.canvas)}},t.prototype.clearSelection=function(){this.highlightedState=null,this.highlightedEdge=null,r.Settings.sidebar.unsetSelectedEntityContent(),this.edgeMode&&(this.edgeMode=!1,this.currentEdge.remove(),this.currentEdge=null)},t.prototype.newStateAt=function(t,e){if(!this.locked){var i=new o.State;i.setPosition(t,e),this.selectState(i),this.bindStateEvents(i);var n=this,a=function(){s.Prompt.simple(r.Strings.STATE_MANUAL_CREATION,1,function(t){for(var e=t[0],s=0,o=n.stateList;s<o.length;s++){var l=o[s];if(l.getName()==e)return alert(r.Strings.DUPLICATE_STATE_NAME),a()}i.setName(e),n.onStateCreation(i),n.updateEditableState(i)},function(){n.highlightedState=null,i.remove(),n.updateEditableState(null)})};a()}},t.prototype.onStateCreation=function(t){0==this.stateList.length&&(t.setInitial(!0),this.initialState=t),t.render(this.canvas),this.stateList.push(t),r.Settings.controller().createState(t)},t.prototype.setInitialState=function(t){var e=r.Settings.controller();t==this.initialState?(t.setInitial(!1),e.changeInitialFlag(t),this.initialState=null):(this.initialState&&(this.initialState.setInitial(!1),e.changeInitialFlag(this.initialState),this.initialState.render(this.canvas)),t.setInitial(!0),e.changeInitialFlag(t),this.initialState=t)},t.prototype.changeFinalFlag=function(t,e){t.setFinal(e),r.Settings.controller().changeFinalFlag(t)},t.prototype.deleteState=function(t){for(var e=0;e<this.edgeList.length;e++){var i=this.edgeList[e],n=i.getOrigin(),s=i.getTarget();n!=t&&s!=t||(i.remove(),this.edgeList.splice(e,1),e--)}t.remove();for(var o=this.stateList,e=0;e<o.length;e++)if(o[e]==t){o.splice(e,1);break}r.Settings.controller().deleteState(t)},t.prototype.deleteEdge=function(t){for(var e=0;e<this.edgeList.length;e++)if(this.edgeList[e]==t){t.remove(),this.edgeList.splice(e,1);for(var i=t.getOrigin(),n=t.getTarget(),s=t.getDataList(),o=r.Settings.controller(),a=0,l=s;a<l.length;a++){var u=l[a];o.deleteEdge(i,n,u)}break}},t.prototype.toggleInitial=function(){var t=this.highlightedState;t&&(this.setInitialState(t),t.render(this.canvas),this.updateEditableState(t))},t.prototype.toggleFinal=function(){var t=this.highlightedState;t&&(this.changeFinalFlag(t,!t.isFinal()),t.render(this.canvas),this.updateEditableState(t))},t.prototype.undo=function(){this.frozenMemento=!0,this.clear();var t=this.memento.pop();t&&this.load(t,!1)},t.prototype.bindShortcuts=function(){
var t=this,e=r.Settings.canvasShortcutID;a.System.bindShortcut(r.Settings.shortcuts.toggleInitial,function(){t.toggleInitial()},e),a.System.bindShortcut(r.Settings.shortcuts.toggleFinal,function(){t.toggleFinal()},e),a.System.bindShortcut(r.Settings.shortcuts.dimSelection,function(){t.edgeMode&&(t.edgeMode=!1,t.currentEdge.remove(),t.currentEdge=null),t.dimState(),t.dimEdge()},e),a.System.bindShortcut(r.Settings.shortcuts.deleteEntity,function(){var e=t.highlightedState,i=t.highlightedEdge;e?t.deleteState(e):i&&t.deleteEdge(i),t.clearSelection()},e),a.System.bindShortcut(r.Settings.shortcuts.clearMachine,function(){var e=confirm(r.Strings.CLEAR_CONFIRMATION);e&&t.clear()},e),a.System.bindShortcut(r.Settings.shortcuts.left,function(){t.moveStateSelection(function(t,e){return t.getPosition().x<e.getPosition().x},function(e,i,n){if(!i)return!0;var s=n.getPosition(),r=e.getPosition(),o=Math.abs(r.y-s.y),a=i.getPosition(),l=Math.abs(a.y-s.y),u=t.selectionThreshold();return o<u?l>=u||r.x>a.x:o<l})},e),a.System.bindShortcut(r.Settings.shortcuts.right,function(){t.moveStateSelection(function(t,e){return t.getPosition().x>e.getPosition().x},function(e,i,n){if(!i)return!0;var s=n.getPosition(),r=e.getPosition(),o=Math.abs(r.y-s.y),a=i.getPosition(),l=Math.abs(a.y-s.y),u=t.selectionThreshold();return o<u?l>=u||r.x<a.x:o<l})},e),a.System.bindShortcut(r.Settings.shortcuts.up,function(){t.moveStateSelection(function(t,e){return t.getPosition().y<e.getPosition().y},function(e,i,n){if(!i)return!0;var s=n.getPosition(),r=e.getPosition(),o=Math.abs(r.x-s.x),a=i.getPosition(),l=Math.abs(a.x-s.x),u=t.selectionThreshold();return o<u?l>=u||r.y>a.y:o<l})},e),a.System.bindShortcut(r.Settings.shortcuts.down,function(){t.moveStateSelection(function(t,e){return t.getPosition().y>e.getPosition().y},function(e,i,n){if(!i)return!0;var s=n.getPosition(),r=e.getPosition(),o=Math.abs(r.x-s.x),a=i.getPosition(),l=Math.abs(a.x-s.x),u=t.selectionThreshold();return o<t.selectionThreshold()?l>=u||r.y<a.y:o<l})},e),a.System.bindShortcut(r.Settings.shortcuts.undo,function(){t.undo()},e)},t.prototype.selectionThreshold=function(){return 2*r.Settings.stateRadius},t.prototype.moveStateSelection=function(t,e){var i=this.highlightedState;if(i){for(var n=null,s=0,r=this.stateList;s<r.length;s++){var o=r[s];t(o,i)&&e(o,n,i)&&(n=o)}n&&this.selectState(n)}},t}();e.AutomatonRenderer=c}),define("interface/Mainbar",["require","exports","interface/AutomatonRenderer","Memento","interface/Renderer","Settings"],function(t,e,i,n,s,r){"use strict";var o=function(t){function e(){t.call(this),this.canvas=null,this.automatonRenderer=null;var e=this;$(window).resize(function(){e.resizeCanvas()})}return __extends(e,t),e.prototype.resizeCanvas=function(){var t=this.canvas;if(t){var e=$(this.node);t.setSize(50,50);var i=e.width(),n=e.height()-10;t.setSize(i,n)}},e.prototype.onBind=function(){this.canvas=Raphael(this.node,0,0),this.resizeCanvas();var t=this.canvas,e=this.node,s=new n.Memento(function(){return r.Settings.undoMaxAmount});this.automatonRenderer=new i.AutomatonRenderer(t,e,s),r.Settings.automatonRenderer=this.automatonRenderer},e.prototype.onRender=function(){this.automatonRenderer.render()},e}(s.Renderer);e.Mainbar=o}),define("interface/Sidebar",["require","exports","interface/Menu","interface/Renderer","Settings","Settings","System","interface/Table","Utils"],function(t,e,i,n,s,r,o,a,l){"use strict";var u=function(t){function e(){t.call(this),this.otherMenus=[],this.build();var e=this;o.System.addLanguageChangeObserver({onLanguageChange:function(){l.utils.id(s.Settings.sidebarID).innerHTML="",e.build(),e.render()}})}return __extends(e,t),e.prototype.build=function(){this.mainMenus={settings:new i.Menu(r.Strings.SETTINGS),fileManipulation:new i.Menu(r.Strings.FILE_MENUBAR),selectedEntity:new i.Menu(r.Strings.SELECTED_ENTITY),formalDefinition:new i.Menu(r.Strings.FORMAL_DEFINITION),machineSelection:new i.Menu(r.Strings.SELECT_MACHINE),actionMenu:new i.Menu(r.Strings.ACTION_LIST)},this.buildSettings(),this.buildFileManipulation(),this.buildSelectedEntityArea(),this.buildMachineSelection(),this.buildActionMenu(),this.node&&this.onBind()},e.prototype.setSelectedEntityContent=function(t){var e=this.mainMenus.selectedEntity.content();$(e.querySelector(".none")).hide(),e.appendChild(t)},e.prototype.unsetSelectedEntityContent=function(){for(var t=this.mainMenus.selectedEntity.content();t.children.length>1;)t.removeChild(t.children[t.children.length-1]);$(t.querySelector(".none")).show()},e.prototype.updateFormalDefinition=function(t){var e=this.mainMenus.formalDefinition.content();e.innerHTML="",t&&e.appendChild(t)},e.prototype.onBind=function(){var t=this;l.utils.foreach(this.mainMenus,function(e,i){i.bind(t.node)});for(var e=0,i=this.otherMenus;e<i.length;e++){var n=i[e];n.bind(this.node)}s.Settings.sidebar=this},e.prototype.onRender=function(){l.utils.foreach(this.mainMenus,function(t,e){e.render()}),this.renderDynamicMenus()},e.prototype.renderDynamicMenus=function(){for(var t=0,e=this.otherMenus;t<e.length;t++){var i=e[t];i.render()}},e.prototype.loadMachine=function(t){for(var e=0,i=this.otherMenus;e<i.length;e++){var n=i[e];$(n.html()).remove()}this.otherMenus=s.Settings.machines[t].sidebar;for(var r=0,o=this.otherMenus;r<o.length;r++){var n=o[r];n.bind(this.node)}},e.prototype.buildSettings=function(){var t=this.mainMenus.settings;t.clear();var e,i=new a.Table(2,2),n=l.utils.create("input",{className:"property_value",type:"text",value:s.Settings.undoMaxAmount});n.addEventListener("focus",function(){e=this.value}),n.addEventListener("blur",function(){var t=parseInt(this.value);!isNaN(t)&&t>=1&&((e>=t||confirm(r.Strings.MEMORY_CONSUMPTION_WARNING))&&(s.Settings.undoMaxAmount=t),this.value=s.Settings.undoMaxAmount)}),this.buildLanguageSelection(i),i.add(l.utils.create("span",{innerHTML:r.Strings.UNDO_MAX_COUNT+":"})),i.add(n),t.add(i.html()),t.toggle()},e.prototype.buildLanguageSelection=function(t){var e=l.utils.create("select"),i=s.Settings.languages,n={},a=0;l.utils.foreach(i,function(t,i){var r=l.utils.create("option");r.value=a.toString(),r.innerHTML=i.strings.LANGUAGE_NAME,e.appendChild(r),n[a]=t,i==s.Settings.language&&(e.selectedIndex=a),a++}),e.addEventListener("change",function(t){var e=this,s=e.options[e.selectedIndex],a=s.value,l=s.innerHTML,u=confirm(r.Strings.CHANGE_LANGUAGE.replace("%",l));u&&o.System.changeLanguage(i[n[a]])}),t.add(l.utils.create("span",{innerHTML:r.Strings.SYSTEM_LANGUAGE+":"})),t.add(e)},e.prototype.buildFileManipulation=function(){var t=this.mainMenus.fileManipulation;t.clear();var e=l.utils.create("input",{className:"file_manip_btn",type:"button",value:r.Strings.SAVE,click:function(){var t=s.Settings.automatonRenderer.save(),e=new Blob([t],{type:"text/plain; charset=utf-8"});saveAs(e,"file.txt")}});o.System.bindShortcut(s.Settings.shortcuts.save,function(){e.click()}),t.add(e);var i=l.utils.create("input",{id:"file_selector",type:"file"});i.addEventListener("change",function(t){var e=t.target.files[0];if(this.value="",e){var i=new FileReader;i.onload=function(t){s.Settings.automatonRenderer.load(t.target.result)},i.readAsText(e)}});var n=l.utils.create("input",{className:"file_manip_btn",type:"button",value:r.Strings.OPEN,click:function(){i.click(),this.blur()}});o.System.bindShortcut(s.Settings.shortcuts.open,function(){n.click()}),t.add(n)},e.prototype.buildSelectedEntityArea=function(){var t=l.utils.create("span",{className:"none",innerHTML:r.Strings.NO_SELECTED_ENTITY});this.mainMenus.selectedEntity.add(t)},e.prototype.buildMachineSelection=function(){var t=new a.Table(s.Settings.machineSelRows,s.Settings.machineSelColumns),e={},i=this;l.utils.foreach(s.Settings.machines,function(n,a){var u=l.utils.create("input");u.classList.add("machine_selection_btn"),u.type="button",u.value=a.name,u.disabled=n==s.Settings.currentMachine,u.addEventListener("click",function(){(s.Settings.automatonRenderer.empty()||confirm(r.Strings.CHANGE_MACHINE_WARNING))&&(s.Settings.automatonRenderer.clear(),e[s.Settings.currentMachine].disabled=!1,e[n].disabled=!0,e[n].blur(),o.System.changeMachine(n),i.loadMachine(n),i.renderDynamicMenus())}),t.add(u),e[n]=u}),o.System.bindShortcut(["M"],function(){for(var t=document.querySelectorAll(".machine_selection_btn"),e=0;e<t.length;e++){var i=t[e];if(!i.disabled){i.focus();break}}});var n=this.mainMenus.machineSelection;n.clear(),n.add(t.html()),this.loadMachine(s.Settings.currentMachine)},e.prototype.buildActionMenu=function(){var t=new a.Table(s.Settings.machineActionRows,s.Settings.machineActionColumns),e=l.utils.create("input",{title:r.Strings.CREATE_STATE_INSTRUCTIONS,type:"button",value:r.Strings.CREATE_STATE,click:function(){s.Settings.automatonRenderer.stateManualCreation()}});t.add(e);var i=l.utils.create("input",{title:r.Strings.CREATE_EDGE_INSTRUCTIONS,type:"button",value:r.Strings.CREATE_EDGE,click:function(){s.Settings.automatonRenderer.edgeManualCreation()}});t.add(i);var n=l.utils.create("input",{title:l.utils.printShortcut(s.Settings.shortcuts.clearMachine),type:"button",value:r.Strings.CLEAR_MACHINE,click:function(){o.System.emitKeyEvent(s.Settings.shortcuts.clearMachine)}});t.add(n);var u=l.utils.create("input",{title:l.utils.printShortcut(s.Settings.shortcuts.undo),type:"button",value:r.Strings.UNDO,click:function(){o.System.emitKeyEvent(s.Settings.shortcuts.undo)}});t.add(u);var c=this.mainMenus.actionMenu,h=t.html();h.id="machine_actions",c.add(h)},e}(n.Renderer);e.Sidebar=u}),define("interface/UI",["require","exports","interface/Mainbar","Settings","interface/Sidebar","Utils"],function(t,e,i,n,s,r){"use strict";var o=function(){function t(){var t=new s.Sidebar,e=new i.Mainbar;this.bindSidebar(t),this.bindMain(e)}return t.prototype.render=function(){this.sidebarRenderer.render(),this.mainRenderer.render(),console.log("Interface ready.")},t.prototype.bindSidebar=function(t){t.bind(r.utils.id(n.Settings.sidebarID)),this.sidebarRenderer=t},t.prototype.bindMain=function(t){t.bind(r.utils.id(n.Settings.mainbarID)),this.mainRenderer=t},t}();e.UI=o}),define("main",["require","exports","Settings","System","interface/UI"],function(t,e,i,n,s){"use strict";i.Settings.update(),$(document).ready(function(){var t=new s.UI;t.render(),document.body.addEventListener("keydown",function(t){var e=document.activeElement.tagName.toLowerCase(),i=["input","textarea"];return i.indexOf(e)!=-1||n.System.keyEvent(t)})})}),define("tests/Test",["require","exports"],function(t,e){"use strict";var i=function(){function t(t){this.testPlans=[],this.targetNode=t}return t.prototype.addTestPlan=function(t){this.testPlans.push(t)},t.prototype.runTests=function(){for(var t="",e=0,i=this.testPlans;e<i.length;e++){var n=i[e],s=n.planName(),r=n.testNames(),o={success:0,failure:0,exceptions:0};t+="<div class='plan'>",t+="<div class='plan_name'>"+s+"</div>";for(var a=0,l=r;a<l.length;a++){var u=l[a],c=void 0,h=void 0;try{n[u]()?(c=" OK ",h="success",o.success++):(c="FAIL",h="failure",o.failure++)}catch(t){c="EXCP",h="exception",o.exceptions++}t+="<div class='test_case'>",t+="<div class='status "+h+"'>",t+=c,t+="</div>",t+="<div class='test_name'>"+u+"</div>",t+="</div>"}if(t+="<div class='summary'>",0==o.failure&&0==o.exceptions)t+="<div class='success'>All tests passed.</div>";else{var p=r.length,d=(o.success/p*100).toFixed(2),g=(o.failure/p*100).toFixed(2),f=(o.exceptions/p*100).toFixed(2),S=[];S.push(o.success+" test(s) passed ("+d+"%)"),o.failure>0&&S.push(o.failure+" test(s) failed ("+g+"%)"),o.exceptions>0&&S.push(o.exceptions+" test(s) resulted in exceptions ("+f+"%)"),t+="<div class='failure'>Test plan failed.</div>",t+="<ul>",t+="<li>"+S.join("</li><li>")+"</li>",t+="</ul>"}t+="</div>",t+="</div>"}this.targetNode.innerHTML+=t},t}();e.Test=i}),define("tests/FATests",["require","exports","machines/FA/FA"],function(t,e,i){"use strict";var n=function(){function t(){}return t.prototype.planName=function(){return"FA"},t.prototype.testNames=function(){return["something"]},t.prototype.something=function(){var t=new i.FA;return t.error()},t}();e.FATests=n}),define("tests/PDATests",["require","exports"],function(t,e){"use strict";var i=function(){function t(){}return t.prototype.planName=function(){return"PDA"},t.prototype.testNames=function(){return["example1","example2","example3"]},t.prototype.example1=function(){return!1},t.prototype.example2=function(){return!0},t.prototype.example3=function(){throw 42},t}();e.PDATests=i}),define("tests",["require","exports","tests/FATests","tests/PDATests","tests/Test"],function(t,e,i,n,s){"use strict";$(document).ready(function(){var t=document.getElementById("container"),e=new s.Test(t);e.addTestPlan(new i.FATests),e.addTestPlan(new n.PDATests),e.runTests()})});
