!function t(e,i,n){function s(a,o){if(!i[a]){if(!e[a]){var l="function"==typeof require&&require;if(!o&&l)return l(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var h=i[a]={exports:{}};e[a][0].call(h.exports,function(t){var i=e[a][1][t];return s(i||t)},h,h.exports,t,e,i,n)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)s(n[a]);return s}({1:[function(t,e,i){"use strict";i.__esModule=!0;!function(t){var e=function(){var t,e=navigator.userAgent.toLowerCase(),i=function(t){return t.test(e)},n={msie:i(/msie/)||i(/trident/),edge:i(/edge/),firefox:i(/mozilla/)&&i(/firefox/),chrome:i(/webkit/)&&i(/chrome/)&&!i(/edge/),safari:i(/safari/)&&i(/applewebkit/)&&!i(/chrome/),opera:i(/opera/)},s="",r="Unknown";for(t in n)if(n.hasOwnProperty(t)&&n[t]){s=t;var a=new RegExp(t+"( |/)([0-9]+)"),o=e.match(a);o?r=o[2]:(o=e.match(/rv:([0-9]+)/))&&(r=o[1])}return{name:s,version:r}}();t.name=e.name,t.version=e.version}(i.Browser||(i.Browser={}))},{}],2:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./Utils"),s=function(){function t(){}return t.exec=function(t){n.utils.foreach(t,function(t,e){e.init()})},t}();i.Initializer=s},{"./Utils":9}],3:[function(t,e,i){"use strict";i.__esModule=!0;!function(t){t.keys={A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,ENTER:13,SHIFT:16,SPACE:32,ESC:27,DELETE:46,LEFT:37,UP:38,RIGHT:39,DOWN:40,"+":61,"-":173},t.symbols={delta:"δ",epsilon:"ε",gamma:"Γ",sigma:"Σ",leftArrow:"←",rightArrow:"→"}}(i.Keyboard||(i.Keyboard={}))},{}],4:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t){this.offset=0,this.historyPointer=-1,this.states={},this.limit=t}return t.prototype.push=function(t){this.historyPointer==this.limit()?(delete this.states[this.offset],this.offset++):this.historyPointer++;var e=this.index();this.states[e]=t;for(var i=1;this.states[e+i];)delete this.states[e+i],i++},t.prototype.undo=function(){return this.historyPointer>0?(this.historyPointer--,this.states[this.index()]):null},t.prototype.redo=function(){return this.states[this.index()+1]?(this.historyPointer++,this.states[this.index()]):null},t.prototype.index=function(){return this.offset+this.historyPointer},t}();i.Memento=n},{}],5:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./Keyboard"),s=t("./Settings"),r=t("./System"),a=t("./Utils"),o=function(){function t(t){this.inputs=[],this.explicitPosition=null,this.successCallback=null,this.abortCallback=null,this.message=t}return t.prototype.addInput=function(t){this.inputs.push(t)},t.prototype.setPosition=function(t,e){this.explicitPosition={x:t,y:e}},t.prototype.setDefaultValues=function(t){for(var e=0;e<t.length;e++)this.inputs[e].defaultValue=t[e]},t.prototype.onSuccess=function(t){this.successCallback=t},t.prototype.onAbort=function(t){t&&(this.abortCallback=t)},t.prototype.show=function(){var t=a.utils.create("div",{className:"click_blocker"}),e=a.utils.create("div",{id:"system_prompt"});e.innerHTML=this.message+"<br>";var i=a.utils.id(s.Settings.mainbarID);this.explicitPosition&&(e.classList.add("floating"),e.style.left=i.offsetLeft+this.explicitPosition.x+"px",e.style.top=i.offsetTop+this.explicitPosition.y+"px");for(var o=function(){document.body.removeChild(t),r.System.unblockEvents(),$(e).slideUp(s.Settings.promptSlideHideInterval,function(){i.removeChild(e)})},l=[],c=this,h=function(){for(var t=!0,e=0,i=l;e<i.length;e++){var n=i[e],s=parseInt(n.id.replace("system_prompt_input_","")),r=c.inputs[s].validator;r&&(r(n.value)?l[s].classList.remove("invalid"):(l[s].classList.add("invalid"),t=!1))}return t},u=a.utils.create("input",{type:"button",value:s.Strings.PROMPT_CONFIRM,click:function(){for(var t=!0,e=[],i=0,n=l;i<n.length;i++){var s=n[i],r=parseInt(s.id.replace("system_prompt_input_","")),a=c.inputs[r].validator;if(a&&!a(s.value)){t=!1;break}e.push(s.value)}t&&(o(),c.successCallback&&c.successCallback(e))}}),p=a.utils.create("input",{type:"button",value:s.Strings.PROMPT_CANCEL,click:function(){o(),c.abortCallback&&c.abortCallback()}}),d=0;d<this.inputs.length;d++){var g=void 0;(g=this.inputs[d].initializer?this.inputs[d].initializer():a.utils.create("input",{type:"text",placeholder:this.inputs[d].placeholder||"",value:this.inputs[d].defaultValue||""})).id="system_prompt_input_"+d;var f=/input/i.test(g.tagName);(f=f&&"text"==g.type)?(g.addEventListener("keydown",function(t){t.keyCode==n.Keyboard.keys.ENTER?u.click():t.keyCode==n.Keyboard.keys.ESC&&p.click()}),g.addEventListener("keyup",function(t){var e=t.keyCode==n.Keyboard.keys.ENTER,i=t.keyCode==n.Keyboard.keys.ESC;e||i||(u.disabled=!h())})):g.addEventListener("focus",function(t){u.disabled=!h()}),l.push(g),e.appendChild(g)}u.disabled=!h(),e.appendChild(u),e.appendChild(p),document.body.insertBefore(t,document.body.children[0]),r.System.blockEvents(),$(e).toggle(),i.insertBefore(e,i.children[0]),$(e).slideDown(s.Settings.promptSlideShowInterval,function(){l[0].focus()})},t.simple=function(t,e,i,o){var l=a.utils.create("div",{className:"click_blocker"}),c=a.utils.create("div",{id:"system_prompt"});c.innerHTML=t+"<br>";for(var h=a.utils.id(s.Settings.mainbarID),u=!1,p=function(){document.body.removeChild(l),r.System.unblockEvents(),$(c).slideUp(s.Settings.promptSlideHideInterval,function(){h.removeChild(c)})},d=[],g=a.utils.create("input",{type:"button",value:s.Strings.PROMPT_CONFIRM,click:function(){if(!u){u=!0;for(var t=[],e=0,n=d;e<n.length;e++){var s=n[e];t.push(s.value)}p(),i(t)}}}),f=a.utils.create("input",{type:"button",value:s.Strings.PROMPT_CANCEL,click:function(){u||(u=!0,p(),o&&o())}}),S=0;S<e;S++){var y=a.utils.create("input",{type:"text"});y.addEventListener("keydown",function(t){t.keyCode==n.Keyboard.keys.ENTER?g.click():t.keyCode==n.Keyboard.keys.ESC&&f.click()}),d.push(y),c.appendChild(y)}c.appendChild(g),c.appendChild(f),document.body.insertBefore(l,document.body.children[0]),r.System.blockEvents(),$(c).toggle(),h.insertBefore(c,h.children[0]),$(c).slideDown(s.Settings.promptSlideShowInterval,function(){d[0].focus()})},t}();i.Prompt=o},{"./Keyboard":3,"./Settings":6,"./System":8,"./Utils":9}],6:[function(t,e,i){"use strict";i.__esModule=!0;var n,s=t("./lists/MachineList"),r=t("./lists/ControllerList"),a=t("./lists/LanguageList"),o=t("./lists/InitializerList"),l=t("./lists/OperationList"),c=t("./Initializer"),h=t("./Utils");!function(t){function e(t){return new r[t+"Controller"]}function n(t){return new o["init"+t]}function u(t){var e={};return h.utils.foreach(t,function(t,i){e[i.name]=i.command}),e}function p(){if(S)for(var i in t.Machine)if(t.Machine.hasOwnProperty(i)&&!isNaN(parseInt(i))){var s=t.Machine[i];d[i]=e(s),g[i]=n(s),f[i]=u(l[s])}var r={};for(var i in t.Machine)t.Machine.hasOwnProperty(i)&&!isNaN(parseInt(i))&&(r[i]={name:t.language.strings[t.Machine[i]],abbreviatedName:t.Machine[i],sidebar:[],controller:d[i],initializer:g[i],operations:f[i]});h.utils.foreach(r,function(e,i){t.machines[parseInt(e)]=i}),c.Initializer.exec(g),S&&t.machines[t.currentMachine].initializer.onEnter(),S=!1}t.sidebarID="sidebar",t.mainbarID="mainbar",t.sidebarSignalID="sidebar",t.automatonRendererSignalID="automatonRenderer",t.disabledButtonClass="disabled",t.canvasShortcutID="canvas",t.undoMaxAmount=3,t.menuSlideInterval=300,t.promptSlideHideInterval=100,t.promptSlideShowInterval=200,t.machineSelectionColumns=1,t.machineActionColumns=2,t.tapeDisplayedChars=7,t.multRecognitionAreaRows=8,t.multRecognitionAreaCols=15,t.stateRadius=32,t.stateRingRadius=27,t.stateDragTolerance=50,t.stateLabelFontFamily="arial",t.stateLabelFontSize=20,t.stateLabelFontColor="black",t.stateInitialMarkLength=40,t.stateInitialMarkHeadLength=15,t.stateInitialMarkAngle=h.utils.toRadians(20),t.stateInitialMarkColor="blue",t.stateInitialMarkThickness=2,t.stateDefaultPalette={fillColor:"white",strokeColor:"black",strokeWidth:1,ringStrokeWidth:1},t.stateHighlightPalette={fillColor:"#FFD574",strokeColor:"red",strokeWidth:3,ringStrokeWidth:2},t.stateRecognitionPalette={fillColor:"#CCC",strokeColor:"black",strokeWidth:3,ringStrokeWidth:2},t.edgeDefaultPalette={strokeColor:"black",arrowThickness:2,arrowLength:30,arrowAngle:h.utils.toRadians(30),textFontFamily:"arial",textFontSize:20,textFontColor:"black"},t.edgeHighlightPalette={strokeColor:"red",arrowThickness:t.edgeDefaultPalette.arrowThickness,arrowLength:t.edgeDefaultPalette.arrowLength,arrowAngle:t.edgeDefaultPalette.arrowAngle,textFontFamily:t.edgeDefaultPalette.textFontFamily,textFontSize:t.edgeDefaultPalette.textFontSize,textFontColor:t.edgeDefaultPalette.textFontColor},t.edgeFormalDefinitionHoverPalette={strokeColor:"blue",arrowThickness:3,arrowLength:t.edgeDefaultPalette.arrowLength,arrowAngle:t.edgeDefaultPalette.arrowAngle,textFontFamily:t.edgeDefaultPalette.textFontFamily,textFontSize:t.edgeDefaultPalette.textFontSize,textFontColor:t.edgeDefaultPalette.textFontColor},t.acceptedTestCaseColor="green",t.rejectedTestCaseColor="red",t.shortcuts={save:["ctrl","S"],open:["ctrl","O"],toggleInitial:["I"],toggleFinal:["F"],dimSelection:["ESC"],deleteEntity:["DELETE"],clearMachine:["C"],left:["LEFT"],right:["RIGHT"],up:["UP"],down:["DOWN"],undo:["ctrl","Z"],redo:["ctrl","Y"],focusTestCase:["ctrl","I"],dimTestCase:["ENTER"],fastForward:["R"],step:["ENTER"],stop:["ESC"]},t.languages=a,t.Machine=s.Machine,t.language=a.english,t.currentMachine=0,t.machines={},t.controller=function(){return t.machines[t.currentMachine].controller},t.supportedOperations=function(){return t.machines[t.currentMachine].operations};var d={},g={},f={},S=!0;t.update=p,t.changeLanguage=function(e){t.language=e,i.Strings=t.language.strings,p()},t.changeMachine=function(e){t.machines[t.currentMachine].initializer.onExit(),t.currentMachine=e,t.machines[t.currentMachine].initializer.onEnter()}}(n=i.Settings||(i.Settings={})),i.Strings=n.language.strings},{"./Initializer":2,"./Utils":9,"./lists/ControllerList":25,"./lists/InitializerList":26,"./lists/LanguageList":27,"./lists/MachineList":28,"./lists/OperationList":29}],7:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(){}return t.addSignalObserver=function(t){this.signalObservers.push(t)},t.emitSignal=function(t){for(var e=0,i=this.signalObservers;e<i.length;e++){var n=i[e].receiveSignal(t);if(n&&n.reacted)return n.response}return null},t.signalObservers=[],t}();i.SignalEmitter=n},{}],8:[function(t,e,i){"use strict";function n(t){return t+"Key"}i.__esModule=!0;var s=t("./Keyboard"),r=t("./Settings"),a=["alt","ctrl","shift"],o=function(){function t(){}return t.changeLanguage=function(t){r.Settings.changeLanguage(t);for(var e=0,i=this.languageChangeObservers;e<i.length;e++)i[e].onLanguageChange()},t.changeMachine=function(t){r.Settings.changeMachine(t);for(var e=0,i=this.machineChangeObservers;e<i.length;e++)i[e].onMachineChange()},t.addLanguageChangeObserver=function(t){this.languageChangeObservers.push(t)},t.addMachineChangeObserver=function(t){this.machineChangeObservers.push(t)},t.emitKeyEvent=function(t){for(var e={preventDefault:function(){}},i=0,r=a;i<r.length;i++)e[n(r[i])]=!1;for(var o=0,l=t;o<l.length;o++){var c=l[o];a.indexOf(c)>=0?e[n(c)]=!0:e.keyCode=s.Keyboard.keys[c.toUpperCase()]}this.keyEvent(e)},t.keyEvent=function(t){for(var e=!1,i=0,n=this.keyboardObservers;i<n.length;i++){var s=n[i],r=s.keys;!this.locked(s)&&this.shortcutMatches(t,r)&&(s.callback(),e=!0)}return!e||(t.preventDefault(),!1)},t.bindShortcut=function(t,e,i){this.keyboardObservers.push({keys:t,callback:e,group:i})},t.lockShortcutGroup=function(t){this.lockedGroups[t]=!0},t.unlockShortcutGroup=function(t){delete this.lockedGroups[t]},t.blockEvents=function(){this.eventBlock=!0},t.unblockEvents=function(){this.eventBlock=!1},t.shortcutMatches=function(t,e){if(this.eventBlock)return!1;for(var i=[],r=0,o=e;r<o.length;r++){var l=o[r];if(a.indexOf(l)>=0){if(i.push(l),!t[n(l)])return!1}else if(t.keyCode!=s.Keyboard.keys[l])return!1}for(var c=0,h=a;c<h.length;c++){var u=h[c];if(-1==i.indexOf(u)&&t[n(u)])return!1}return!0},t.locked=function(t){return!!t.group&&this.lockedGroups.hasOwnProperty(t.group)},t.keyboardObservers=[],t.languageChangeObservers=[],t.machineChangeObservers=[],t.eventBlock=!1,t.lockedGroups={},t}();i.System=o},{"./Keyboard":3,"./Settings":6}],9:[function(t,e,i){"use strict";i.__esModule=!0;!function(t){function e(t){return document.querySelector(t)}function i(t,e){for(var i in t)if(t.hasOwnProperty(i)&&!1===e(i,t[i]))break}function n(t,e,i,n){return"M"+t+" "+e+" L"+i+" "+n}t.select=e,t.id=function(t){return e("#"+t)},t.create=function(t,e){var n=document.createElement(t);return e&&i(e,function(t,e){"click"==t?n.addEventListener("click",e):n[t]=e}),n},t.foreach=i,t.cloneArray=function(t){for(var e=[],i=0,n=t;i<n.length;i++){var s=n[i];e.push(s)}return e},t.isSameArray=function(t,e){if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!=e[i])return!1;return!0},t.isRightClick=function(t){return"which"in t?3==t.which:"button"in t?2==t.button:(console.log("[WARNING] Right click events will not work properly in this browser."),!1)},t.linePath=n,t.line=function(t,e,i,s,r){var a=t.path(n(e,i,s,r));return a.attr("stroke","black"),a},t.toRadians=function(t){return t*Math.PI/180},t.toDegrees=function(t){return 180*t/Math.PI},t.rotatePoint=function(t,e,i){var n=Math.sin(i),s=Math.cos(i),r={x:t.x,y:t.y};r.x-=e.x,r.y-=e.y;var a={x:r.x*s-r.y*n,y:r.x*n+r.y*s};return{x:a.x+e.x,y:a.y+e.y}},t.samePoint=function(t,e){return t&&e&&t.x==e.x&&t.y==e.y},t.async=function(t){setTimeout(t,0)},t.printShortcut=function(t){return t.join(" ").toLowerCase()},t.optionalSymbolValidator=function(t){return t.length<=1},t.singleSymbolValidator=function(t){return 1==t.length},t.nonEmptyStringValidator=function(t){return t.length>0}}(i.utils||(i.utils={}))},{}],10:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(){this.data=[],this.pointer=0}return t.prototype.push=function(t){this.data.push(t)},t.prototype.front=function(){return this.data[this.pointer]},t.prototype.pop=function(){var t=this.front();return this.pointer++,this.pointer>=this.size()/2&&(this.data=this.data.slice(this.pointer),this.pointer=0),t},t.prototype.clear=function(){this.data=[],this.pointer=0},t.prototype.empty=function(){return 0==this.size()},t.prototype.size=function(){return this.data.length-this.pointer},t}();i.Queue=n},{}],11:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(){this.data={},this.count=0}return t.prototype.insert=function(t){this.contains(t)||this.count++,this.data[t]=!0,this.type=typeof t},t.prototype.erase=function(t){this.contains(t)&&this.count--,delete this.data[t]},t.prototype.contains=function(t){return!!this.data[t]},t.prototype.clear=function(){this.data={},this.count=0},t.prototype.empty=function(){return 0==this.size()},t.prototype.size=function(){return this.count},t.prototype.forEach=function(t){for(var e in this.data)if(this.data.hasOwnProperty(e)){var i=e;if("number"==this.type&&(i=parseFloat(e)),!1===t(i))break}},t.prototype.asList=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t}();i.UnorderedSet=n},{}],12:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./Edge"),s=t("./FormalDefinitionRenderer"),r=t("../Prompt"),a=t("../Settings"),o=t("../SignalEmitter"),l=t("./State"),c=t("../System"),h=t("./Table"),u=t("../Utils"),p=function(){function t(t,e,i,n){this.stateList=[],this.edgeList=[],this.highlightedState=null,this.highlightedEdge=null,this.initialState=null,this.edgeMode=!1,this.currentEdge=null,this.locked=!1,this.frozenMemento=!1,this.loadingMode=!1,this.canvas=t,this.memento=i,this.node=e,this.persistenceHandler=n,this.formalDefinitionRenderer=new s.FormalDefinitionRenderer(this),o.SignalEmitter.addSignalObserver(this)}return t.prototype.render=function(){this.bindEvents(),this.bindShortcuts(),this.bindFormalDefinitionListener();var t=this;c.System.addLanguageChangeObserver({onLanguageChange:function(){t.bindFormalDefinitionListener(),t.locked&&(t.recognitionDim(),t.unlock()),t.highlightedState&&t.updateEditableState(t.highlightedState),t.highlightedEdge&&t.updateEditableEdge(t.highlightedEdge)}}),c.System.addMachineChangeObserver({onMachineChange:function(){t.bindFormalDefinitionListener()}})},t.prototype.clear=function(){for(var t=0,e=this.stateList;t<e.length;t++)e[t].remove();this.stateList=[];for(var i=0,n=this.edgeList;i<n.length;i++)n[i].remove();this.edgeList=[],this.initialState=null,this.clearSelection(),a.Settings.controller().clear()},t.prototype.empty=function(){return 0==this.stateList.length},t.prototype.save=function(){return this.persistenceHandler.save(this.stateList,this.edgeList,this.initialState)},t.prototype.load=function(t,e){void 0===e&&(e=!0),this.loadingMode=!0,this.frozenMemento=!0;var i=this.persistenceHandler.load(t);if(i.error)return alert(a.Strings.INVALID_FILE),void(this.loadingMode=!1);if(i.aborted)this.loadingMode=!1;else{this.stateList=this.stateList.concat(i.stateList),this.edgeList=this.edgeList.concat(i.edgeList),null===this.initialState&&(this.initialState=i.initialState);for(var n=0,s=this.stateList;n<s.length;n++){var r=s[n];r.render(this.canvas),this.bindStateEvents(r)}for(var o=0,l=this.edgeList;o<l.length;o++){var c=l[o];c.render(this.canvas),this.bindEdgeEvents(c)}this.loadingMode=!1,this.formalDefinitionCallback(),this.frozenMemento=!1,e&&this.memento.push(this.save())}},t.prototype.recognitionHighlight=function(t){for(var e={},i=0,n=this.stateList;i<n.length;i++)e[(c=n[i]).getName()]=c,c.removePalette();for(var s=0,r=t;s<r.length;s++)e[r[s]].applyPalette(a.Settings.stateRecognitionPalette);for(var o=0,l=this.stateList;o<l.length;o++){var c=l[o];c.render(this.canvas)}},t.prototype.recognitionDim=function(){for(var t=0,e=this.stateList;t<e.length;t++){var i=e[t];i.removePalette(),i.render(this.canvas)}this.highlightedState=null},t.prototype.lock=function(){c.System.lockShortcutGroup(a.Settings.canvasShortcutID),this.locked=!0},t.prototype.unlock=function(){c.System.unlockShortcutGroup(a.Settings.canvasShortcutID),this.locked=!1},t.prototype.stateManualCreation=function(){var t=a.Settings.stateRadius,e=a.Settings.stateInitialMarkLength;this.newStateAt(t+e,t)},t.prototype.edgeManualCreation=function(){if(!this.locked){var t=this;r.Prompt.simple(a.Strings.EDGE_MANUAL_CREATION,2,function(e){for(var i=new n.Edge,s=0,r=t.stateList;s<r.length;s++){var o=r[s],l=o.getName();l==e[0]&&i.setOrigin(o),l==e[1]&&i.setTarget(o)}i.getOrigin()&&i.getTarget()?(t.currentEdge=i,t.finishEdge(i.getTarget())):alert(a.Strings.ERROR_INVALID_STATE_NAME)})}},t.prototype.receiveSignal=function(t){return t.targetID==a.Settings.automatonRendererSignalID?{reacted:!0,response:this[t.identifier].apply(this,t.data)}:null},t.prototype.getCanvas=function(){return this.canvas},t.prototype.getEdgeList=function(){return this.edgeList},t.prototype.isEdgeSelected=function(t){return this.highlightedEdge==t},t.prototype.selectEdge=function(t){this.locked||(this.dimState(),this.highlightedEdge&&(this.highlightedEdge.removePalette(),this.highlightedEdge.render(this.canvas)),t.applyPalette(a.Settings.edgeHighlightPalette),this.highlightedEdge=t,t.render(this.canvas),this.updateEditableEdge(t))},t.prototype.dimEdge=function(){!this.locked&&this.highlightedEdge&&(this.highlightedEdge.removePalette(),this.highlightedEdge.render(this.canvas),this.highlightedEdge=null,this.unsetSelectedEntityContent())},t.prototype.selectState=function(t){this.locked||(this.dimEdge(),this.highlightedState&&(this.highlightedState.removePalette(),this.highlightedState.render(this.canvas)),t.applyPalette(a.Settings.stateHighlightPalette),this.highlightedState=t,t.render(this.canvas),this.updateEditableState(t))},t.prototype.dimState=function(){!this.locked&&this.highlightedState&&(this.highlightedState.removePalette(),this.highlightedState.render(this.canvas),this.highlightedState=null,this.unsetSelectedEntityContent())},t.prototype.bindFormalDefinitionListener=function(){var t,e=this;this.formalDefinitionCallback=function(){if(!e.loadingMode){e.frozenMemento||e.memento.push(e.save()),t||(t=u.utils.create("div"),o.SignalEmitter.emitSignal({targetID:a.Settings.sidebarSignalID,identifier:"updateFormalDefinition",data:[t]}));var i=a.Settings.controller().formalDefinition(),n=u.utils.create("span");e.formalDefinitionRenderer.render(n,i),t.innerHTML="",t.appendChild(n)}},a.Settings.controller().setEditingCallback(this.formalDefinitionCallback),this.formalDefinitionCallback()},t.prototype.updateEditableState=function(t){t?o.SignalEmitter.emitSignal({targetID:a.Settings.sidebarSignalID,identifier:"setSelectedEntityContent",data:[this.showEditableState(t)]}):this.unsetSelectedEntityContent()},t.prototype.updateEditableEdge=function(t){t?o.SignalEmitter.emitSignal({targetID:a.Settings.sidebarSignalID,identifier:"setSelectedEntityContent",data:[this.showEditableEdge(t)]}):this.unsetSelectedEntityContent()},t.prototype.showEditableState=function(t){var e=u.utils.create("div"),i=new h.Table(3),n=this.canvas,s=this,o=function(){var e=new r.Prompt(a.Strings.STATE_RENAME_ACTION);e.addInput({validator:function(t){return t.length<=6}}),e.onSuccess(function(e){for(var i=e[0],r=0,l=s.stateList;r<l.length;r++)if(l[r].getName()==i)return alert(a.Strings.DUPLICATE_STATE_NAME),void o();a.Settings.controller().renameState(t,i),t.setName(i),t.render(n),$("#entity_name").html(i)}),e.show()},l=u.utils.create("input",{type:"button",value:a.Strings.RENAME_STATE,click:o}),c=u.utils.create("input",{type:"button",value:a.Strings.TOGGLE_PROPERTY,click:function(){s.setInitialState(t),t.render(n),$("#entity_initial").html(t.isInitial()?a.Strings.YES:a.Strings.NO)}}),p=u.utils.create("input",{type:"button",value:a.Strings.TOGGLE_PROPERTY,click:function(){s.changeFinalFlag(t,!t.isFinal()),t.render(n),$("#entity_final").html(t.isFinal()?a.Strings.YES:a.Strings.NO)}}),d=u.utils.create("input",{type:"button",value:a.Strings.DELETE_STATE,click:function(){s.deleteState(t),s.clearSelection(),s.unsetSelectedEntityContent()}});return i.add(u.utils.create("span",{innerHTML:a.Strings.STATE_NAME+":"})),i.add(u.utils.create("span",{innerHTML:t.getName(),className:"property_value",id:"entity_name"})),i.add(l),i.add(u.utils.create("span",{innerHTML:a.Strings.STATE_IS_INITIAL+":"})),i.add(u.utils.create("span",{innerHTML:t.isInitial()?a.Strings.YES:a.Strings.NO,className:"property_value",id:"entity_initial"})),i.add(c),i.add(u.utils.create("span",{innerHTML:a.Strings.STATE_IS_FINAL+":"})),i.add(u.utils.create("span",{innerHTML:t.isFinal()?a.Strings.YES:a.Strings.NO,className:"property_value",id:"entity_final"})),i.add(p),i.add(d,3),e.appendChild(i.html()),e},t.prototype.fixEdgeConsistency=function(t){for(var e=t.getOrigin(),i=t.getTarget(),n=null,s=null,r=-1,a=!1,o=0,l=0,c=this.edgeList;l<c.length;l++){var h=c[l];if(h.getOrigin()==e&&h.getTarget()==i)if(h!=t){for(var u=t.getDataList(),p=t.getTextList(),d=u.length,g=0;g<d;g++)h.addData(u[g]),h.addText(p[g]);h.render(this.canvas),s=h,a=!0}else r=o;else h.getOrigin()==i&&h.getTarget()==e&&(n=h);o++}n?(n.setCurveFlag(!0),n.render(this.canvas),t.setCurveFlag(!0),t.render(this.canvas)):(t.setCurveFlag(!1),t.render(this.canvas)),a&&r>-1&&(this.highlightedEdge==t&&this.selectEdge(s),t.remove(),this.edgeList.splice(r,1))},t.prototype.showEditableEdge=function(t){var e=u.utils.create("div"),i=new h.Table(3),n=this.canvas,s=this,r=u.utils.create("input",{type:"button",value:a.Strings.CHANGE_PROPERTY,click:function(){var e=prompt(a.Strings.EDGE_ENTER_NEW_ORIGIN);if(null!==e){for(var i=0,r=s.stateList;i<r.length;i++){var o=r[i];o.getName()==e&&(t.setOrigin(o),s.fixEdgeConsistency(t))}t.removed()||t.render(n),$("#entity_origin").html(e)}}}),o=u.utils.create("input",{type:"button",value:a.Strings.CHANGE_PROPERTY,click:function(){var e=prompt(a.Strings.EDGE_ENTER_NEW_TARGET);if(null!==e){for(var i=0,r=s.stateList;i<r.length;i++){var o=r[i];o.getName()==e&&(t.setTarget(o),s.fixEdgeConsistency(t))}t.removed()||t.render(n),$("#entity_target").html(e)}}}),l=u.utils.create("input",{type:"button",value:a.Strings.CHANGE_PROPERTY,click:function(){var e=$("#entity_transition_list").get(0).selectedIndex,i=a.Settings.controller(),n=i.edgePrompt(function(n,r){var a=t.getOrigin(),o=t.getTarget(),l=t.getDataList();i.deleteEdge(a,o,l[e]),t.getDataList()[e]=n,t.getTextList()[e]=r,t.render(s.canvas),i.createEdge(a,o,n),s.updateEditableEdge(t)});n.setDefaultValues(t.getDataList()[e]),n.show()}}),c=u.utils.create("input",{type:"button",value:a.Strings.DELETE_SELECTED_TRANSITION,click:function(){var e=$("#entity_transition_list").get(0).selectedIndex,i=a.Settings.controller(),n=t.getOrigin(),r=t.getTarget(),o=t.getDataList();i.deleteEdge(n,r,o[e]),t.getDataList().splice(e,1),t.getTextList().splice(e,1),0==o.length?(s.deleteEdge(t),s.clearSelection(),s.unsetSelectedEntityContent()):(t.render(s.canvas),s.updateEditableEdge(t))}}),p=u.utils.create("input",{title:u.utils.printShortcut(a.Settings.shortcuts.deleteEntity),type:"button",value:a.Strings.DELETE_ALL_TRANSITIONS,click:function(){s.deleteEdge(t),s.clearSelection(),s.unsetSelectedEntityContent()}});i.add(u.utils.create("span",{innerHTML:a.Strings.ORIGIN+":"})),i.add(u.utils.create("span",{innerHTML:t.getOrigin().getName(),className:"property_value",id:"entity_origin"})),i.add(r),i.add(u.utils.create("span",{innerHTML:a.Strings.TARGET+":"})),i.add(u.utils.create("span",{innerHTML:t.getTarget().getName(),className:"property_value",id:"entity_target"})),i.add(o);for(var d=u.utils.create("select",{id:"entity_transition_list"}),g=0,f=0,S=t.getTextList();f<S.length;f++){var y=S[f],m=u.utils.create("option",{value:g,innerHTML:y});d.appendChild(m),g++}return i.add(u.utils.create("span",{innerHTML:a.Strings.TRANSITIONS+":"})),i.add(d),i.add(l),i.add(c,3),i.add(p,3),e.appendChild(i.html()),e},t.prototype.unsetSelectedEntityContent=function(){o.SignalEmitter.emitSignal({targetID:a.Settings.sidebarSignalID,identifier:"unsetSelectedEntityContent",data:[]})},t.prototype.bindEvents=function(){for(var t=0,e=this.stateList;t<e.length;t++){var i=e[t];i.render(this.canvas),this.bindStateEvents(i)}for(var n=0,s=this.edgeList;n<s.length;n++){var r=s[n];this.bindEdgeEvents(r)}var a=this,o=this.node;$(o).dblclick(function(t){if("svg"==t.target.tagName.toLowerCase()){var e=t.pageX-o.offsetLeft,i=t.pageY-o.offsetTop;a.newStateAt(e,i)}}),$(o).contextmenu(function(t){return t.preventDefault(),!1}),$(o).mousemove(function(t){a.edgeMode&&a.adjustEdge(o,t)})},t.prototype.bindEdgeEvents=function(t){var e=this;t.addClickHandler(function(){e.selectEdge(this)})},t.prototype.bindStateEvents=function(t){this.canvas;var e=this;t.drag(function(){e.updateEdges()},function(i,n){return!e.locked&&i<=a.Settings.stateDragTolerance?(e.edgeMode?e.finishEdge(t):u.utils.isRightClick(n)?e.beginEdge(t):t==e.highlightedState?e.dimState():e.selectState(t),!1):(e.memento.push(e.save()),!0)})},t.prototype.beginEdge=function(t){this.edgeMode=!0,this.currentEdge=new n.Edge,this.currentEdge.setOrigin(t)},t.prototype.finishEdge=function(t){if(this.edgeMode=!1,!this.currentEdge)throw Error();for(var e=this.currentEdge.getOrigin(),i=function(i,n,s){var r=a.Settings.controller(),o=r.edgePrompt(function(i,s){n(i,s),r.createEdge(e,t,i)},s),l=i.getOrigin(),c=i.getTarget(),h=l.getPosition(),u=c.getPosition();if(l==c){var p=h.x+l.getRadius(),d=h.y-l.getRadius();o.setPosition(p,d)}else{var g=(h.x+u.x)/2,f=(h.y+u.y)/2;o.setPosition(g,f)}o.show()},n=this,s=null,r=function(){n.dimEdge(),n.currentEdge.remove(),n.currentEdge=null},o=0,l=this.edgeList;o<l.length;o++){var c=function(a){if(a.getOrigin()==e&&a.getTarget()==t)return i(a,function(t,e){a.addText(e),a.addData(t),a.render(n.canvas),n.selectEdge(a),r()},r),{value:void 0};a.getOrigin()==t&&a.getTarget()==e&&(s=a)}(l[o]);if("object"==typeof c)return c.value}s&&(this.currentEdge.setCurveFlag(!0),s.setCurveFlag(!0),s.render(this.canvas)),this.currentEdge.setTarget(t),this.currentEdge.render(this.canvas),this.selectEdge(this.currentEdge),i(n.currentEdge,function(t,e){if(!n.currentEdge)throw Error();n.currentEdge.addText(e),n.currentEdge.addData(t),n.bindEdgeEvents(n.currentEdge),n.currentEdge.render(n.canvas),n.updateEditableEdge(n.currentEdge),n.edgeList.push(n.currentEdge),n.currentEdge=null},function(){n.updateEditableEdge(null),r(),s&&(s.setCurveFlag(!1),s.render(n.canvas))})},t.prototype.adjustEdge=function(t,e){var i={x:e.pageX-t.offsetLeft,y:e.pageY-t.offsetTop};this.currentEdge.setVirtualTarget(i),this.currentEdge.render(this.canvas)},t.prototype.updateEdges=function(){for(var t=0,e=this.edgeList;t<e.length;t++)e[t].render(this.canvas)},t.prototype.clearSelection=function(){this.highlightedState=null,this.highlightedEdge=null,this.unsetSelectedEntityContent(),this.edgeMode&&(this.edgeMode=!1,this.currentEdge.remove(),this.currentEdge=null)},t.prototype.newStateAt=function(t,e){if(!this.locked){var i=new l.State;i.setPosition(t,e),this.selectState(i),this.bindStateEvents(i);var n=this,s=function(){var o=new r.Prompt(a.Strings.STATE_MANUAL_CREATION);o.addInput({validator:u.utils.nonEmptyStringValidator});var l=i.getRadius();o.setPosition(t+l,e-l),o.onSuccess(function(t){for(var e=t[0],r=0,o=n.stateList;r<o.length;r++)if(o[r].getName()==e)return alert(a.Strings.DUPLICATE_STATE_NAME),s();i.setName(e),n.onStateCreation(i),n.updateEditableState(i)}),o.onAbort(function(){n.highlightedState=null,i.remove(),n.updateEditableState(null)}),o.show()};s()}},t.prototype.onStateCreation=function(t){0==this.stateList.length&&(t.setInitial(!0),this.initialState=t),t.render(this.canvas),this.stateList.push(t),a.Settings.controller().createState(t)},t.prototype.setInitialState=function(t){var e=a.Settings.controller();t==this.initialState?(t.setInitial(!1),this.initialState=null,e.changeInitialFlag(t)):(this.initialState&&(this.initialState.setInitial(!1),e.changeInitialFlag(this.initialState),this.initialState.render(this.canvas)),t.setInitial(!0),this.initialState=t,e.changeInitialFlag(t))},t.prototype.changeFinalFlag=function(t,e){t.setFinal(e),a.Settings.controller().changeFinalFlag(t)},t.prototype.deleteState=function(t){for(r=0;r<this.edgeList.length;r++){var e=this.edgeList[r],i=e.getOrigin(),n=e.getTarget();i!=t&&n!=t||(e.remove(),this.edgeList.splice(r,1),r--)}t.remove();for(var s=this.stateList,r=0;r<s.length;r++)if(s[r]==t){s.splice(r,1);break}a.Settings.controller().deleteState(t)},t.prototype.deleteEdge=function(t){for(var e=t.getOrigin(),i=t.getTarget(),n=t.getDataList(),s=a.Settings.controller(),r=0,o=this.edgeList;r<o.length;r++){var l=o[r];if(l.getOrigin()==i&&l.getTarget()==e){l.setCurveFlag(!1),l.render(this.canvas);break}}for(var c=0,h=n;c<h.length;c++){var u=h[c];s.deleteEdge(e,i,u)}for(var p=0;p<this.edgeList.length;p++)if(this.edgeList[p]==t){t.remove(),this.edgeList.splice(p,1);break}},t.prototype.toggleInitial=function(){var t=this.highlightedState;t&&(this.setInitialState(t),t.render(this.canvas),this.updateEditableState(t))},t.prototype.toggleFinal=function(){var t=this.highlightedState;t&&(this.changeFinalFlag(t,!t.isFinal()),t.render(this.canvas),this.updateEditableState(t))},t.prototype.undo=function(){var t=this.memento.undo();t&&(this.frozenMemento=!0,this.clear(),this.load(t,!1))},t.prototype.redo=function(){var t=this.memento.redo();t&&(this.frozenMemento=!0,this.clear(),this.load(t,!1))},t.prototype.bindShortcuts=function(){var t=this,e=a.Settings.canvasShortcutID;c.System.bindShortcut(a.Settings.shortcuts.toggleInitial,function(){t.toggleInitial()},e),c.System.bindShortcut(a.Settings.shortcuts.toggleFinal,function(){t.toggleFinal()},e),c.System.bindShortcut(a.Settings.shortcuts.dimSelection,function(){t.edgeMode&&(t.edgeMode=!1,t.currentEdge.remove(),t.currentEdge=null),t.dimState(),t.dimEdge()},e),c.System.bindShortcut(a.Settings.shortcuts.deleteEntity,function(){var e=t.highlightedState,i=t.highlightedEdge;e?t.deleteState(e):i&&t.deleteEdge(i),t.clearSelection()},e),c.System.bindShortcut(a.Settings.shortcuts.clearMachine,function(){confirm(a.Strings.CLEAR_CONFIRMATION)&&t.clear()},e),c.System.bindShortcut(a.Settings.shortcuts.left,function(){t.moveStateSelection(function(t,e){return t.getPosition().x<e.getPosition().x},function(e,i,n){if(!i)return!0;var s=n.getPosition(),r=e.getPosition(),a=Math.abs(r.y-s.y),o=i.getPosition(),l=Math.abs(o.y-s.y),c=t.selectionThreshold();return a<c?l>=c||r.x>o.x:a<l})},e),c.System.bindShortcut(a.Settings.shortcuts.right,function(){t.moveStateSelection(function(t,e){return t.getPosition().x>e.getPosition().x},function(e,i,n){if(!i)return!0;var s=n.getPosition(),r=e.getPosition(),a=Math.abs(r.y-s.y),o=i.getPosition(),l=Math.abs(o.y-s.y),c=t.selectionThreshold();return a<c?l>=c||r.x<o.x:a<l})},e),c.System.bindShortcut(a.Settings.shortcuts.up,function(){t.moveStateSelection(function(t,e){return t.getPosition().y<e.getPosition().y},function(e,i,n){if(!i)return!0;var s=n.getPosition(),r=e.getPosition(),a=Math.abs(r.x-s.x),o=i.getPosition(),l=Math.abs(o.x-s.x),c=t.selectionThreshold();return a<c?l>=c||r.y>o.y:a<l})},e),c.System.bindShortcut(a.Settings.shortcuts.down,function(){t.moveStateSelection(function(t,e){return t.getPosition().y>e.getPosition().y},function(e,i,n){if(!i)return!0;var s=n.getPosition(),r=e.getPosition(),a=Math.abs(r.x-s.x),o=i.getPosition(),l=Math.abs(o.x-s.x),c=t.selectionThreshold();return a<t.selectionThreshold()?l>=c||r.y<o.y:a<l})},e),c.System.bindShortcut(a.Settings.shortcuts.undo,function(){t.undo()},e),c.System.bindShortcut(a.Settings.shortcuts.redo,function(){t.redo()},e)},t.prototype.selectionThreshold=function(){return 2*a.Settings.stateRadius},t.prototype.moveStateSelection=function(t,e){var i=this.highlightedState;if(i){for(var n=null,s=0,r=this.stateList;s<r.length;s++){var a=r[s];t(a,i)&&e(a,n,i)&&(n=a)}n&&this.selectState(n)}},t}();i.AutomatonRenderer=p},{"../Prompt":5,"../Settings":6,"../SignalEmitter":7,"../System":8,"../Utils":9,"./Edge":13,"./FormalDefinitionRenderer":15,"./State":20,"./Table":21}],13:[function(t,e,i){"use strict";i.__esModule=!0;var n,s=t("../Settings"),r=t("../Utils");!function(t){t[t.NORMAL=0]="NORMAL",t[t.LOOP=1]="LOOP",t[t.CURVED=2]="CURVED"}(n||(n={}));var a=function(){function t(){this.origin=null,this.target=null,this.virtualTarget=null,this.textList=[],this.dataList=[],this.curved=!1,this.forcedRender=!1,this.deleted=!1,this.defaultPalette=s.Settings.edgeDefaultPalette,this.palette=this.defaultPalette,this.body=[],this.head=[],this.textContainer=null,this.clickHandlers=[];var t=this;this.clickCallback=function(e){for(var i=0,n=t.clickHandlers;i<n.length;i++)n[i].call(t)}}return t.prototype.setOrigin=function(t){this.origin=t},t.prototype.getOrigin=function(){return this.origin},t.prototype.setTarget=function(t){this.target=t},t.prototype.getTarget=function(){return this.target},t.prototype.setVirtualTarget=function(t){this.virtualTarget=t},t.prototype.addText=function(t){this.textList.push(t)},t.prototype.getTextList=function(){return this.textList},t.prototype.addData=function(t){this.dataList.push(t)},t.prototype.getDataList=function(){return this.dataList},t.prototype.setCurveFlag=function(t){this.forcedRender=this.forcedRender||this.curved!=t,this.curved=t},t.prototype.isCurved=function(){return this.curved},t.prototype.removed=function(){return this.deleted},t.prototype.addClickHandler=function(t){this.clickHandlers.push(t),this.rebindClickHandlers()},t.prototype.remove=function(){for(var t=0,e=this.body;t<e.length;t++)(s=e[t]).remove();this.body=[];for(var i=0,n=this.head;i<n.length;i++){var s=n[i];s.remove()}this.head=[],this.textContainer&&(this.textContainer.remove(),this.textContainer=null),this.deleted=!0},t.prototype.applyPalette=function(t){this.palette=t,this.forcedRender=!0},t.prototype.removePalette=function(){this.palette=this.defaultPalette,this.forcedRender=!0},t.prototype.render=function(t){var e=this.origin&&r.utils.samePoint(this.prevOriginPosition,this.origin.getPosition()),i=this.target&&r.utils.samePoint(this.prevTargetPosition,this.target.getPosition());e&&i&&!this.forcedRender||(this.renderBody(t),this.renderHead(t),this.origin&&(this.prevOriginPosition=this.origin.getPosition()),this.target&&(this.prevTargetPosition=this.target.getPosition()),this.forcedRender=!1);for(var n=0,s=this.body;n<s.length;n++)(l=s[n]).attr("stroke",this.palette.strokeColor);for(var a=0,o=this.head;a<o.length;a++){var l=o[a];l.attr("stroke",this.palette.strokeColor)}this.target&&this.renderText(t)},t.prototype.rebindClickHandlers=function(){for(var t=0,e=this.body;t<e.length;t++){var i=e[t];i.unclick(this.clickCallback),i.click(this.clickCallback)}},t.prototype.stateCenterOffsets=function(t,e){var i=Math.atan2(e,t),n=Math.sin(i),r=Math.cos(i);return{x:s.Settings.stateRadius*r,y:s.Settings.stateRadius*n}},t.prototype.renderBody=function(t){var e,i=this.origin.getPosition();if(this.target)e=this.target.getPosition();else if(this.virtualTarget){var n=(e={x:this.virtualTarget.x,y:this.virtualTarget.y}).x-i.x,r=e.y-i.y;e.x=i.x+.98*n,e.y=i.y+.98*r}else e=i;var a=e.x-i.x,o=e.y-i.y,l=s.Settings.stateRadius,c=this.stateCenterOffsets(a,o);a*a+o*o>l*l&&(i.x+=c.x,i.y+=c.y),this.target&&(e.x-=c.x,e.y-=c.y),this.origin==this.target?this.loop(t):this.isCurved()?this.curve(t,i,e):this.normal(t,i,e)},t.prototype.adjustBody=function(t,e,i){for(;this.body.length>e;)this.body[this.body.length-1].remove(),this.body.pop();for(;this.body.length<e;)this.body.push(r.utils.line(t,0,0,0,0));i!=this.currentEdgeType&&(this.currentEdgeType=i,this.rebindClickHandlers())},t.prototype.loop=function(t){var e=s.Settings.stateRadius,i=this.origin.getPosition();this.adjustBody(t,4,n.LOOP);for(var a=0,o=this.body;a<o.length;a++)o[a].attr("stroke-width",this.palette.arrowThickness);this.body[0].attr("path",r.utils.linePath(i.x+e,i.y,i.x+2*e,i.y)),this.body[1].attr("path",r.utils.linePath(i.x+2*e,i.y,i.x+2*e,i.y-2*e)),this.body[2].attr("path",r.utils.linePath(i.x+2*e,i.y-2*e,i.x,i.y-2*e)),this.body[3].attr("path",r.utils.linePath(i.x,i.y-2*e,i.x,i.y-e))},t.prototype.curve=function(t,e,i){var s=i.x-e.x,a=i.y-e.y,o=Math.sqrt(s*s+a*a),l={x:a/o,y:-s/o},c={x:30*l.x,y:30*l.y};this.adjustBody(t,3,n.CURVED);for(var h=0,u=this.body;h<u.length;h++)u[h].attr("stroke-width",this.palette.arrowThickness);this.body[0].attr("path",r.utils.linePath(e.x,e.y,e.x+c.x+.125*s,e.y+c.y+.125*a)),this.body[1].attr("path",r.utils.linePath(e.x+c.x+.125*s,e.y+c.y+.125*a,e.x+c.x+.875*s,e.y+c.y+.875*a)),this.body[2].attr("path",r.utils.linePath(e.x+c.x+.875*s,e.y+c.y+.875*a,i.x,i.y))},t.prototype.normal=function(t,e,i){this.adjustBody(t,1,n.NORMAL);for(var s=0,a=this.body;s<a.length;s++)a[s].attr("stroke-width",this.palette.arrowThickness);this.body[0].attr("path",r.utils.linePath(e.x,e.y,i.x,i.y))},t.prototype.renderHead=function(t){if(this.target){var e,i,n,a;if(this.origin==this.target){var o=this.origin.getPosition(),l=s.Settings.stateRadius;e={x:o.x,y:o.y-2*l},i={x:o.x,y:o.y-l},n=0,a=l}else if(this.isCurved()){var c=this.body[2].attr("path");e={x:c[0][1],y:c[0][2]},n=(i={x:c[1][1],y:c[1][2]}).x-e.x,a=i.y-e.y}else{e=this.origin.getPosition(),n=(i=this.target.getPosition()).x-e.x,a=i.y-e.y;var h=this.stateCenterOffsets(n,a);i.x-=h.x,i.y-=h.y,n-=h.x,a-=h.y}var u=this.palette.arrowLength,p=this.palette.arrowAngle,d=1-u/Math.sqrt(n*n+a*a),g={x:e.x+d*n,y:e.y+d*a},f=r.utils.rotatePoint(g,i,p),S=r.utils.rotatePoint(g,i,-p),y=0==this.head.length;if(y&&(this.head.push(r.utils.line(t,0,0,0,0)),this.head.push(r.utils.line(t,0,0,0,0))),this.forcedRender||y)for(var m=0,E=this.head;m<E.length;m++)E[m].attr("stroke-width",this.palette.arrowThickness);this.head[0].attr("path",r.utils.linePath(f.x,f.y,i.x,i.y)),this.head[1].attr("path",r.utils.linePath(S.x,S.y,i.x,i.y))}},t.prototype.preparedText=function(){return this.textList.join("\n")},t.prototype.renderText=function(t){var e,i,n=this.origin.getPosition(),a=this.target.getPosition();if(this.origin==this.target){var o=s.Settings.stateRadius;e=n.x+o,i=n.y-2*o}else if(this.isCurved()){var l=this.body[1].attr("path"),c=l[0][1],h=l[0][2];e=(c+l[1][1])/2,i=(h+l[1][2])/2}else e=(n.x+a.x)/2,i=(n.y+a.y)/2;this.textContainer?(this.textContainer.attr("x",e),this.textContainer.attr("y",i),this.textContainer.attr("text",this.preparedText()),this.textContainer.transform("")):(this.textContainer=t.text(e,i,this.preparedText()),this.textContainer.attr("font-family",this.palette.textFontFamily),this.textContainer.attr("font-size",this.palette.textFontSize),this.textContainer.attr("stroke",this.palette.textFontColor),this.textContainer.attr("fill",this.palette.textFontColor));var u=Math.atan2(a.y-n.y,a.x-n.x),p=r.utils.toDegrees(u);(p<-90||p>90)&&(p=(p+180)%360),this.textContainer.rotate(p),i-=.6*this.palette.textFontSize,i-=this.palette.textFontSize*(this.textList.length-1)*.7,this.textContainer.attr("y",i)},t}();i.Edge=a},{"../Settings":6,"../Utils":9}],14:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../Settings");!function(t){t.addEdgeData=function(t,e){var i=t.getOrigin(),s=t.getTarget();if(!i||!s)throw Error("addEdgeData requires a complete edge");var r=n.Settings.controller();t.addText(r.edgeDataToText(e)),t.addData(e),r.createEdge(i,s,e)}}(i.EdgeUtils||(i.EdgeUtils={}))},{"../Settings":6}],15:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../Keyboard"),s=t("../Settings"),r=t("./Table"),a=t("../Utils"),o=function(){function t(t){this.automatonRenderer=t}return t.prototype.render=function(t,e){var i=e.tupleSequence;t.innerHTML="M = ("+i.join(", ")+")",t.innerHTML+=s.Strings.DEFINITION_WHERE_SUFFIX+"<br>";for(var n=0,r=e.parameterSequence;n<r.length;n++){var o=r[n],l=e.parameterValues[o],c=typeof l,h=a.utils.create("span");if("number"==c||"string"==c)h.innerHTML+=o+" = "+l;else if(l instanceof Array)h.innerHTML+=o+" = ",h.innerHTML+="{"+l.join(", ")+"}";else if("undefined"==c){var u="";u+=o+" = ",u+="<span class='none'>",u+=s.Strings.NO_INITIAL_STATE,u+="</span>",h.innerHTML+=u}else l.hasOwnProperty("list")?this.renderTransitionTable(h,o,l):h.innerHTML+="unspecified type";t.appendChild(h),t.appendChild(a.utils.create("br"))}},t.prototype.renderTransitionTable=function(t,e,i){var o=i.domain,l=i.codomain,c=i.header,h=i.list,u=i.metadata,p=n.Keyboard.symbols.rightArrow;if(t.innerHTML+=e+": ",t.innerHTML+=o+" "+p+" "+l,0==h.length){var d="";return d+="<br>",d+="<span class='none'>",d+=s.Strings.NO_TRANSITIONS,d+="</span>",void(t.innerHTML+=d)}for(var g=new r.Table(h[0].length),f=0;f<c.length;f++)g.add(a.utils.create("span",{innerHTML:c[f]}));for(var S=g.html(),f=0;f<h.length;f++){for(var y=a.utils.create("tr"),m=0;m<h[f].length;m++){var E=a.utils.create("td");E.innerHTML=h[f][m],y.appendChild(E)}this.bindRowEvents(y,u[f]),S.appendChild(y)}S.id="transition_table",t.appendChild(S)},t.prototype.bindRowEvents=function(t,e){var i=this.automatonRenderer,n=null,r=s.Settings.edgeHighlightPalette,a=s.Settings.edgeFormalDefinitionHoverPalette,o=function(){n&&(i.isEdgeSelected(n)?n.applyPalette(r):n.removePalette(),n.render(i.getCanvas()),n=null)};t.addEventListener("mouseenter",function(){for(var t=0,s=i.getEdgeList();t<s.length;t++){var r=s[t],l=r.getOrigin().getName(),c=r.getTarget().getName(),h=l==e[0],u=c==e[1];if(h&&u){o(),r.applyPalette(a),r.render(i.getCanvas()),n=r;break}}}),t.addEventListener("mouseleave",o),t.addEventListener("click",function(){n&&(i.selectEdge(n),o())})},t}();i.FormalDefinitionRenderer=o},{"../Keyboard":3,"../Settings":6,"../Utils":9,"./Table":21}],16:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();i.__esModule=!0;var s=t("./AutomatonRenderer"),r=t("../persistence/JSONHandler"),a=t("../Memento"),o=t("./Renderer"),l=t("../Settings"),c=function(t){function e(){var e=t.call(this)||this;e.canvas=null,e.automatonRenderer=null;var i=e;return $(window).resize(function(){i.resizeCanvas()}),e}return n(e,t),e.prototype.resizeCanvas=function(){var t=this.canvas;if(t){var e=$(this.node);t.setSize(50,50);var i=e.width(),n=e.height()-10;t.setSize(i,n)}},e.prototype.onBind=function(){this.canvas=Raphael(this.node,0,0),this.resizeCanvas();var t=this.canvas,e=this.node,i=new a.Memento(function(){return l.Settings.undoMaxAmount}),n=new r.JSONHandler;this.automatonRenderer=new s.AutomatonRenderer(t,e,i,n)},e.prototype.onRender=function(){this.automatonRenderer.render()},e}(o.Renderer);i.Mainbar=c},{"../Memento":4,"../Settings":6,"../persistence/JSONHandler":41,"./AutomatonRenderer":12,"./Renderer":18}],17:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();i.__esModule=!0;var s=t("./Renderer"),r=t("../Settings"),a=t("../Utils"),o=function(t){function e(e){var i=t.call(this)||this;return i.body=null,i.toggled=!1,i.title=e,i.children=[],i}return n(e,t),e.prototype.add=function(t){this.children.push(t)},e.prototype.clear=function(){this.children=[]},e.prototype.clearContent=function(){this.clear(),this.body&&$(this.body).remove()},e.prototype.toggle=function(){this.toggled=!this.toggled,this.body&&this.internalToggle()},e.prototype.html=function(){return this.body},e.prototype.content=function(){return this.body?this.body.querySelector(".content"):null},e.prototype.onRender=function(){var t=this.node,e=a.utils.create("div");e.classList.add("menu");var i=a.utils.create("div");i.classList.add("menu_arrow");var n=a.utils.create("div");n.title=r.Strings.MENU_TOGGLE_INSTRUCTIONS,n.classList.add("title"),n.appendChild(i),n.innerHTML+=this.title,e.appendChild(n);var s=a.utils.create("div");s.classList.add("content");for(var o=0,l=this.children;o<l.length;o++){var c=l[o];s.appendChild(c)}e.appendChild(s),t.appendChild(e);var h=this;n.addEventListener("click",function(){$(s).is(":animated")||$(s).slideToggle(r.Settings.menuSlideInterval,function(){h.updateArrow()})}),this.body=e,this.toggled&&this.internalToggle(),this.updateArrow()},e.prototype.updateArrow=function(){var t=this.body.querySelector(".menu_arrow");"none"==$(this.content()).css("display")?t.innerHTML="&#x25BA;":t.innerHTML="&#x25BC;"},e.prototype.internalToggle=function(){$(this.content()).toggle()},e}(s.Renderer);i.Menu=o},{"../Settings":6,"../Utils":9,"./Renderer":18}],18:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(){}return t.prototype.bind=function(t){this.node=t,this.onBind()},t.prototype.render=function(){this.node&&this.onRender()},t.prototype.onBind=function(){},t}();i.Renderer=n},{}],19:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();i.__esModule=!0;var s=t("../Keyboard"),r=t("./Menu"),a=t("./Renderer"),o=t("../Settings"),l=t("../Settings"),c=t("../SignalEmitter"),h=t("../System"),u=t("./Table"),p=t("../Utils"),d=function(t){function e(){var e=t.call(this)||this;e.otherMenus=[],e.machineButtonMapping={},e.build();var i=e;return h.System.addLanguageChangeObserver({onLanguageChange:function(){p.utils.id(o.Settings.sidebarID).innerHTML="",i.build(),i.render()}}),h.System.addMachineChangeObserver({onMachineChange:function(){i.mainMenus.operationMenu.clearContent(),i.buildOperationMenu(),i.mainMenus.operationMenu.render()}}),c.SignalEmitter.addSignalObserver(e),e}return n(e,t),e.prototype.build=function(){this.mainMenus={settings:new r.Menu(l.Strings.SETTINGS),fileManipulation:new r.Menu(l.Strings.FILE_MENUBAR),machineSelection:new r.Menu(l.Strings.SELECT_MACHINE),formalDefinition:new r.Menu(l.Strings.FORMAL_DEFINITION),selectedEntity:new r.Menu(l.Strings.SELECTED_ENTITY),actionMenu:new r.Menu(l.Strings.ACTION_LIST),operationMenu:new r.Menu(l.Strings.OPERATIONS)},this.buildSettings(),this.buildFileManipulation(),this.buildSelectedEntityArea(),this.buildMachineSelection(),this.buildActionMenu(),this.buildOperationMenu(),this.mainMenus.settings.toggle(),this.mainMenus.operationMenu.toggle(),this.contentWrapper=p.utils.create("div",{id:"sidebar_content"}),this.node&&this.onBind()},e.prototype.receiveSignal=function(t){return t.targetID==o.Settings.sidebarSignalID?{reacted:!0,response:this[t.identifier].apply(this,t.data)}:null},e.prototype.setSelectedEntityContent=function(t){var e=this.mainMenus.selectedEntity.content();$(e.querySelector(".none")).hide(),this.clearSelectedEntityArea(),e.appendChild(t)},e.prototype.unsetSelectedEntityContent=function(){var t=this.mainMenus.selectedEntity.content();this.clearSelectedEntityArea(),$(t.querySelector(".none")).show()},e.prototype.updateFormalDefinition=function(t){var e=this.mainMenus.formalDefinition.content();e.innerHTML="",t&&e.appendChild(t)},e.prototype.changeMachineType=function(t){c.SignalEmitter.emitSignal({targetID:o.Settings.automatonRendererSignalID,identifier:"clear",data:[]}),this.machineButtonMapping[o.Settings.currentMachine].disabled=!1,this.machineButtonMapping[t].disabled=!0,this.machineButtonMapping[t].blur(),h.System.changeMachine(t),this.loadMachine(t),this.renderDynamicMenus()},e.prototype.onBind=function(){var t=this.contentWrapper;null===t.parentElement&&this.node.appendChild(t),this.foreachMenu(function(e,i){i.bind(t)});for(var e=0,i=this.otherMenus;e<i.length;e++)i[e].bind(t)},e.prototype.onRender=function(){this.foreachMenu(function(t,e){e.render()}),this.renderDynamicMenus()},e.prototype.foreachMenu=function(t){p.utils.foreach(this.mainMenus,function(e,i){t(e,i)})},e.prototype.clearSelectedEntityArea=function(){for(var t=this.mainMenus.selectedEntity.content();t.children.length>1;)t.removeChild(t.children[t.children.length-1])},e.prototype.renderDynamicMenus=function(){for(var t=0,e=this.otherMenus;t<e.length;t++)e[t].render()},e.prototype.loadMachine=function(t){for(var e=0,i=this.otherMenus;e<i.length;e++){var n=(a=i[e]).html();n&&$(n).remove()}this.otherMenus=o.Settings.machines[t].sidebar;for(var s=0,r=this.otherMenus;s<r.length;s++){var a=r[s];a.bind(this.contentWrapper)}},e.prototype.buildSettings=function(){var t=this.mainMenus.settings;t.clear();var e=new u.Table(2);this.buildLanguageSelection(e),this.buildUndoMaxCountInput(e),t.add(e.html())},e.prototype.buildLanguageSelection=function(t){var e=p.utils.create("select"),i=o.Settings.languages,n={},s=0;p.utils.foreach(i,function(t,i){if(i.strings){var r=p.utils.create("option");r.value=s.toString(),r.innerHTML=i.strings.LANGUAGE_NAME,e.appendChild(r),n[s]=t,i==o.Settings.language&&(e.selectedIndex=s),s++}}),e.addEventListener("change",function(t){var e=this,s=e.options[e.selectedIndex],r=parseInt(s.value),a=s.innerHTML;confirm(l.Strings.CHANGE_LANGUAGE.replace("%",a))&&h.System.changeLanguage(i[n[r]])}),t.add(p.utils.create("span",{innerHTML:l.Strings.SYSTEM_LANGUAGE+":"})),t.add(e)},e.prototype.buildUndoMaxCountInput=function(t){var e=p.utils.create("input",{className:"property_value",type:"text",value:o.Settings.undoMaxAmount});e.addEventListener("blur",function(){var t;if(t=this.value.length>3?999:parseInt(this.value),!isNaN(t)){var e=o.Settings.undoMaxAmount,i=e>=0&&t>e,n=e>=0&&t<0,s=!i&&!n;(s=(s=s||i&&confirm(l.Strings.MEMORY_CONSUMPTION_WARNING))||n&&confirm(l.Strings.INFINITE_UNDO_WARNING))&&(o.Settings.undoMaxAmount=t),this.value=o.Settings.undoMaxAmount.toString()}}),e.addEventListener("keyup",function(t){t.keyCode==s.Keyboard.keys.ENTER&&this.blur()}),t.add(p.utils.create("span",{innerHTML:l.Strings.UNDO_MAX_COUNT+":"})),t.add(e)},e.prototype.buildFileManipulation=function(){var t=this.mainMenus.fileManipulation;t.clear();var e=p.utils.create("input",{className:"file_manip_btn",type:"button",value:l.Strings.SAVE,click:function(){var t=c.SignalEmitter.emitSignal({targetID:o.Settings.automatonRendererSignalID,identifier:"save",data:[]}),e=new Blob([t],{type:"text/plain; charset=utf-8"});saveAs(e,"file.txt")}});h.System.bindShortcut(o.Settings.shortcuts.save,function(){e.click()}),t.add(e);var i=p.utils.create("input",{id:"file_selector",type:"file"});i.addEventListener("change",function(t){var e=t.target.files[0];if(this.value="",e){var i=new FileReader;i.onload=function(t){c.SignalEmitter.emitSignal({targetID:o.Settings.automatonRendererSignalID,identifier:"load",data:[t.target.result]})},i.readAsText(e)}});var n=p.utils.create("input",{className:"file_manip_btn",type:"button",value:l.Strings.OPEN,click:function(){i.click(),this.blur()}});h.System.bindShortcut(o.Settings.shortcuts.open,function(){n.click()}),t.add(n)},e.prototype.buildSelectedEntityArea=function(){var t=p.utils.create("span",{className:"none",innerHTML:l.Strings.NO_SELECTED_ENTITY});this.mainMenus.selectedEntity.add(t)},e.prototype.buildMachineSelection=function(){var t=new u.Table(o.Settings.machineSelectionColumns),e=this;p.utils.foreach(o.Settings.machines,function(i,n){var s=parseInt(i),r=p.utils.create("input");r.classList.add("machine_selection_btn"),r.type="button",r.value=n.name,r.disabled=s==o.Settings.currentMachine,r.addEventListener("click",function(){(c.SignalEmitter.emitSignal({targetID:o.Settings.automatonRendererSignalID,identifier:"empty",data:[]})||confirm(l.Strings.CHANGE_MACHINE_WARNING))&&e.changeMachineType(s)}),t.add(r),e.machineButtonMapping[s]=r}),h.System.bindShortcut(["M"],function(){for(var t=document.querySelectorAll(".machine_selection_btn"),e=0;e<t.length;e++){var i=t[e];if(!i.disabled){i.focus();break}}});var i=this.mainMenus.machineSelection;i.clear(),i.add(t.html()),this.loadMachine(o.Settings.currentMachine)},e.prototype.buildActionMenu=function(){var t=new u.Table(o.Settings.machineActionColumns),e=p.utils.create("input",{title:l.Strings.CREATE_STATE_INSTRUCTIONS,type:"button",value:l.Strings.CREATE_STATE,click:function(){c.SignalEmitter.emitSignal({targetID:o.Settings.automatonRendererSignalID,identifier:"stateManualCreation",data:[]})}});t.add(e);var i=p.utils.create("input",{title:l.Strings.CREATE_EDGE_INSTRUCTIONS,type:"button",value:l.Strings.CREATE_EDGE,click:function(){c.SignalEmitter.emitSignal({targetID:o.Settings.automatonRendererSignalID,identifier:"edgeManualCreation",data:[]})}});t.add(i);var n=p.utils.create("input",{title:p.utils.printShortcut(o.Settings.shortcuts.undo),type:"button",value:l.Strings.UNDO,click:function(){h.System.emitKeyEvent(o.Settings.shortcuts.undo)}});t.add(n);var s=p.utils.create("input",{title:p.utils.printShortcut(o.Settings.shortcuts.redo),type:"button",value:l.Strings.REDO,click:function(){h.System.emitKeyEvent(o.Settings.shortcuts.redo)}});t.add(s);var r=p.utils.create("input",{title:p.utils.printShortcut(o.Settings.shortcuts.clearMachine),type:"button",value:l.Strings.CLEAR_MACHINE,click:function(){h.System.emitKeyEvent(o.Settings.shortcuts.clearMachine)}});t.add(r,2);var a=t.html();a.id="machine_actions",this.mainMenus.actionMenu.add(a)},e.prototype.buildOperationMenu=function(){var t=new u.Table(1),e=o.Settings.controller(),i=o.Settings.supportedOperations(),n=!1;if(p.utils.foreach(i,function(i,s){n=!0;var r=p.utils.create("input",{type:"button",value:l.Strings[i.toUpperCase()],click:function(){e.applyOperation(s)}});t.add(r)}),n){var s=t.html();s.id="operation_list",this.mainMenus.operationMenu.add(s)}else{var r=p.utils.create("span",{className:"none",innerHTML:l.Strings.NO_OPERATIONS});this.mainMenus.operationMenu.add(r)}},e}(a.Renderer);i.Sidebar=d},{"../Keyboard":3,"../Settings":6,"../SignalEmitter":7,"../System":8,"../Utils":9,"./Menu":17,"./Renderer":18,"./Table":21}],20:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../Browser"),s=t("../Settings"),r=t("../Utils"),a=function(){function t(){this.initial=!1,this.final=!1,this.name="",this.initialMarkOffsets=[],this.defaultPalette=s.Settings.stateDefaultPalette,this.palette=this.defaultPalette,this.body=null,this.ring=null,this.arrowParts=[],this.textContainer=null,this.radius=s.Settings.stateRadius}return t.prototype.setPosition=function(t,e){this.x=t,this.y=e},t.prototype.getPosition=function(){return{x:this.x,y:this.y}},t.prototype.getRadius=function(){return this.radius},t.prototype.setInitial=function(t){this.initial=t},t.prototype.isInitial=function(){return this.initial},t.prototype.setFinal=function(t){this.final=t},t.prototype.isFinal=function(){return this.final},t.prototype.setName=function(t){this.name=t},t.prototype.getName=function(){return this.name},t.prototype.applyPalette=function(t){this.palette=t},t.prototype.removePalette=function(){this.palette=this.defaultPalette},t.prototype.remove=function(){this.body&&(this.body.remove(),this.body=null),this.ring&&(this.ring.remove(),this.ring=null);for(var t=0,e=this.arrowParts;t<e.length;t++)e[t].remove();this.arrowParts=[],this.textContainer&&(this.textContainer.remove(),this.textContainer=null)},t.prototype.render=function(t){this.renderBody(t),this.renderInitialMark(t),this.renderFinalMark(t),this.renderText(t)},t.prototype.node=function(){return this.body},t.prototype.html=function(){return this.body?this.body.node:null},t.prototype.drag=function(t,e){if(!this.body)throw Error("Cannot call drag() on a non-rendered state");var i,s=this,r=function(t,e,i){var n=s.getPosition();return this.ox=n.x,this.oy=n.y,{}},a=0;i="chrome"==n.Browser.name?3:4;var o=function(e,n,r,o,l){return s.setVisualPosition(this.ox+e,this.oy+n),0==a&&t.call(this,l),a=(a+1)%i,{}},l=function(i){var n=s.getPosition(),r=n.x-this.ox,a=n.y-this.oy,o=r*r+a*a;return e.call(this,o,i)||0==r&&0==a||s.setVisualPosition(this.ox,this.oy),t.call(this,i),{}};this.body.drag(o,r,l),this.textContainer&&this.textContainer.drag(o,r,l)},t.prototype.fillColor=function(){return this.palette.fillColor},t.prototype.strokeColor=function(){return this.palette.strokeColor},t.prototype.strokeWidth=function(){return this.palette.strokeWidth},t.prototype.ringStrokeWidth=function(){return this.palette.ringStrokeWidth},t.prototype.renderBody=function(t){this.body?this.body.attr({cx:this.x,cy:this.y}):this.body=t.circle(this.x,this.y,this.radius),this.body.attr("fill",this.fillColor()),this.body.attr("stroke",this.strokeColor()),this.body.attr("stroke-width",this.strokeWidth())},t.prototype.updateInitialMarkOffsets=function(){if(!this.initialMarkOffsets.length){var t=s.Settings.stateInitialMarkLength,e=this.x-this.radius,i=this.y,n=s.Settings.stateInitialMarkHeadLength,a=s.Settings.stateInitialMarkAngle,o={x:e-t+(1-n/t)*t,y:i},l={x:e,y:i},c=r.utils.rotatePoint(o,l,a),h=r.utils.rotatePoint(o,l,-a);this.initialMarkOffsets=[{x:c.x-e,y:c.y-i},{x:h.x-e,y:h.y-i}]}},t.prototype.renderInitialMark=function(t){if(this.initial){var e=s.Settings.stateInitialMarkLength,i=this.x-this.radius,n=this.y;if(this.arrowParts.length){var a=(d=this.arrowParts)[0],o=d[1],l=d[2];a.attr("path",r.utils.linePath(i-e,n,i,n)),this.updateInitialMarkOffsets();var c=this.initialMarkOffsets[0],h=this.initialMarkOffsets[1];o.attr("path",r.utils.linePath(c.x+i,c.y+n,i,n)),l.attr("path",r.utils.linePath(h.x+i,h.y+n,i,n))}else{if(!t)throw Error();var u=s.Settings.stateInitialMarkColor,p=s.Settings.stateInitialMarkThickness;(a=r.utils.line(t,i-e,n,i,n)).attr("stroke",u),a.attr("stroke-width",p),this.updateInitialMarkOffsets();var c=this.initialMarkOffsets[0],h=this.initialMarkOffsets[1];(o=r.utils.line(t,c.x+i,c.y+n,i,n)).attr("stroke",u),o.attr("stroke-width",p),(l=r.utils.line(t,h.x+i,h.y+n,i,n)).attr("stroke",u),l.attr("stroke-width",p),(d=this.arrowParts).push(a),d.push(o),d.push(l)}}else for(var d=this.arrowParts;d.length;)d[d.length-1].remove(),d.pop()},t.prototype.renderFinalMark=function(t){this.final?(this.ring?this.ring.attr({cx:this.x,cy:this.y}):this.ring=t.circle(this.x,this.y,s.Settings.stateRingRadius),this.ring.attr("stroke",this.strokeColor()),this.ring.attr("stroke-width",this.ringStrokeWidth())):this.ring&&(this.ring.remove(),this.ring=null)},t.prototype.renderText=function(t){this.textContainer?(this.textContainer.attr("x",this.x),this.textContainer.attr("y",this.y),this.textContainer.attr("text",this.name)):(this.textContainer=t.text(this.x,this.y,this.name),this.textContainer.attr("font-family",s.Settings.stateLabelFontFamily),this.textContainer.attr("font-size",s.Settings.stateLabelFontSize),this.textContainer.attr("stroke",s.Settings.stateLabelFontColor),this.textContainer.attr("fill",s.Settings.stateLabelFontColor))},t.prototype.setVisualPosition=function(t,e){this.setPosition(t,e),this.body.attr({cx:t,cy:e}),this.ring&&this.ring.attr({cx:t,cy:e}),this.initial&&this.renderInitialMark(),this.renderText()},t}();i.State=a},{"../Browser":1,"../Settings":6,"../Utils":9}],21:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();i.__esModule=!0;var s=t("./Renderer"),r=t("../Utils"),a=function(t){function e(e){var i=t.call(this)||this;return i.customColspans={},i.numColumns=e,i.children=[],i}return n(e,t),e.prototype.add=function(t,e){e&&(this.customColspans[this.children.length]=e),this.children.push(t)},e.prototype.html=function(){for(var t=r.utils.create("table"),e=0;e<this.children.length;){for(var i=r.utils.create("tr"),n=0;n<this.numColumns;n++){var s=r.utils.create("td");if(e<this.children.length){if(this.customColspans.hasOwnProperty(e+"")){var a=this.customColspans[e];s.colSpan=a,n+=a-1}s.appendChild(this.children[e])}i.appendChild(s),e++}t.appendChild(i)}return t},e.prototype.onRender=function(){this.node.appendChild(this.html())},e}(s.Renderer);i.Table=a},{"../Utils":9,"./Renderer":18}],22:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./Mainbar"),s=t("../Settings"),r=t("./Sidebar"),a=t("../Utils"),o=function(){function t(){this.components=[],this.components=[[s.Settings.sidebarID,new r.Sidebar],[s.Settings.mainbarID,new n.Mainbar]],this.bindComponents()}return t.prototype.render=function(){for(var t=0,e=this.components;t<e.length;t++)e[t][1].render()},t.prototype.bindComponents=function(){for(var t=0,e=this.components;t<e.length;t++){var i=e[t];i[1].bind(a.utils.id(i[0]))}},t}();i.UI=o},{"../Settings":6,"../Utils":9,"./Mainbar":16,"./Sidebar":19}],23:[function(t,e,i){"use strict";i.__esModule=!0;!function(t){t.strings={LANGUAGE_NAME:"English",SETTINGS:"System Settings",CHANGE_LANGUAGE:'Change the language to "%"?',SYSTEM_LANGUAGE:"System language",UNDO_MAX_COUNT:"Undo max count",MEMORY_CONSUMPTION_WARNING:"Increasing the history size increases the memory consumption. Do you wish to continue?",INFINITE_UNDO_WARNING:"You are removing the undo limit restriction, which increases memory consumption. Do you wish to continue?",FILE_MENUBAR:"File Manipulation",SAVE:"Save",OPEN:"Open",INVALID_FILE:"Invalid file",DIFFERENT_MACHINE_FILE:"This file contains a machine of a different type. Do you want to change the current machine type?",PROMPT_CONFIRM:"Confirm",PROMPT_CANCEL:"Cancel",SELECTED_ENTITY:"Selected item",NO_SELECTED_ENTITY:"no selected item",ORIGIN:"Origin",TARGET:"Target",TRANSITIONS:"Transitions",STATE_NAME:"Name",STATE_IS_INITIAL:"Is initial",STATE_IS_FINAL:"Is final",RENAME_STATE:"rename",TOGGLE_PROPERTY:"toggle",CHANGE_PROPERTY:"change",DELETE_STATE:"Delete state",DELETE_SELECTED_TRANSITION:"Delete selected transition",DELETE_ALL_TRANSITIONS:"Delete all transitions",YES:"yes",NO:"no",FORMAL_DEFINITION:"Formal Definition",DEFINITION_WHERE_SUFFIX:", where:",NO_INITIAL_STATE:"none",NO_TRANSITIONS:"none",SELECT_MACHINE:"Machine Selection",ACTION_LIST:"Actions",OPERATIONS:"Operations",NO_OPERATIONS:"No supported operations",CREATE_STATE:"Create state",CREATE_EDGE:"Create transition",CLEAR_MACHINE:"Clear machine",CLEAR_CONFIRMATION:"Do you really want to reset this automaton?",UNDO:"Undo",REDO:"Redo",MENU_TOGGLE_INSTRUCTIONS:"click to toggle",CREATE_STATE_INSTRUCTIONS:"double click on target position",CREATE_EDGE_INSTRUCTIONS:"right click on origin then click on target",STATE_MANUAL_CREATION:"Enter the state name:",EDGE_MANUAL_CREATION:"Choose the origin and destination",DUPLICATE_STATE_NAME:"State name already in use",STATE_RENAME_ACTION:"Enter the new state name:",EDGE_ENTER_NEW_ORIGIN:"Enter a new origin:",EDGE_ENTER_NEW_TARGET:"Enter a new target:",FA:"Finite Automaton",PDA:"Pushdown Automaton",LBA:"Linearly Bounded Automaton",FA_ENTER_EDGE_CONTENT:"Enter the transition content (up to 1 character):",FA_ENTER_EDGE_PLACEHOLDER_1:"symbol",PDA_ENTER_EDGE_CONTENT:"Enter the input symbol, stack symbol read and stack symbol(s) written:",PDA_ENTER_EDGE_PLACEHOLDER_1:"read (input)",PDA_ENTER_EDGE_PLACEHOLDER_2:"read (stack)",PDA_ENTER_EDGE_PLACEHOLDER_3:"write",LBA_ENTER_EDGE_CONTENT:"Enter the tape symbol(s) read, tape symbol(s) written and move direction:",LBA_ENTER_EDGE_PLACEHOLDER_1:"read",LBA_ENTER_EDGE_PLACEHOLDER_2:"write",LBA_ENTER_EDGE_PLACEHOLDER_3:"direction",RECOGNITION:"Recognition",MULTIPLE_RECOGNITION:"Multiple recognition",TEST_CASE:"test case",FAST_RECOGNITION:"Fast recognition (R)",STEP_RECOGNITION:"Step-by-step recognition (Enter)",STOP_RECOGNITION:"Stop step-by-step recognition (Esc)",START_MULTIPLE_RECOGNITION:"Multiple recognition",CHANGE_MACHINE_WARNING:"Changing the machine type resets the automaton. Do you wish to continue?",INPUT_ACCEPTED:"accepted",INPUT_REJECTED:"rejected",INPUT_LOOPING:"rejected<br>(looping)",EMPTY:"empty",EMPTY_STACK:"empty stack",ACCEPT_BY_FINAL_STATE:"Accept by final state",ACCEPT_BY_EMPTY_STACK:"Accept by empty stack",NO_RECOGNITION_IN_PROGRESS:"no recognition in progress",STACK_MENUBAR:"Stack content",ACTION_TREE_MENUBAR:"Possible next actions",ACTION_TREE_NO_ACTIONS:"no possible actions",PDA_FIELD_INPUT:"Input",PDA_FIELD_STACK:"Stack",PDA_FIELD_READ_INPUT:"Read (input)",PDA_FIELD_WRITE:"Write",PDA_FIELD_TARGET_STATE:"Target state",ERROR_INVALID_STATE_NAME:"Invalid state name",DETERMINIZATION:"Determinization"}}(i.english||(i.english={}))},{}],24:[function(t,e,i){"use strict";i.__esModule=!0;!function(t){t.strings={LANGUAGE_NAME:"Português",SETTINGS:"Configurações do Sistema",CHANGE_LANGUAGE:'Mudar o idioma para "%"?',SYSTEM_LANGUAGE:"Idioma do sistema",UNDO_MAX_COUNT:"Quantidade de 'desfazer'",MEMORY_CONSUMPTION_WARNING:"Aumentar o tamanho do histórico aumenta o consumo de memória. Deseja continuar?",INFINITE_UNDO_WARNING:"Você está removendo o limite de 'desfazer', o que aumenta o consumo de memória. Deseja continuar?",FILE_MENUBAR:"Manipulação de Arquivos",SAVE:"Salvar",OPEN:"Abrir",INVALID_FILE:"Arquivo inválido",DIFFERENT_MACHINE_FILE:"Este arquivo contém uma máquina de um tipo diferente. Deseja alterar o tipo de máquina atual?",PROMPT_CONFIRM:"Confirmar",PROMPT_CANCEL:"Cancelar",SELECTED_ENTITY:"Item selecionado",NO_SELECTED_ENTITY:"nenhum item selecionado",ORIGIN:"Origem",TARGET:"Destino",TRANSITIONS:"Transições",STATE_NAME:"Nome",STATE_IS_INITIAL:"É inicial",STATE_IS_FINAL:"É final",RENAME_STATE:"renomear",TOGGLE_PROPERTY:"alternar",CHANGE_PROPERTY:"alterar",DELETE_STATE:"Remover estado",DELETE_SELECTED_TRANSITION:"Remover transição selecionada",DELETE_ALL_TRANSITIONS:"Remover todas as transições",YES:"sim",NO:"não",FORMAL_DEFINITION:"Definição Formal",DEFINITION_WHERE_SUFFIX:", onde:",NO_INITIAL_STATE:"nenhum",NO_TRANSITIONS:"nenhuma transição",SELECT_MACHINE:"Seleção de Máquina",ACTION_LIST:"Ações",OPERATIONS:"Operações",NO_OPERATIONS:"Nenhuma operação suportada",CREATE_STATE:"Criar estado",CREATE_EDGE:"Criar transição",CLEAR_MACHINE:"Limpar máquina",CLEAR_CONFIRMATION:"Deseja realmente limpar o autômato?",UNDO:"Desfazer",REDO:"Refazer",MENU_TOGGLE_INSTRUCTIONS:"clique para mostrar/esconder",CREATE_STATE_INSTRUCTIONS:"clique duplo no local alvo",CREATE_EDGE_INSTRUCTIONS:"clique direito na origem e então clique no destino",STATE_MANUAL_CREATION:"Digite o nome do estado:",EDGE_MANUAL_CREATION:"Escolha a origem e o destino:",DUPLICATE_STATE_NAME:"Nome do estado já em uso",STATE_RENAME_ACTION:"Digite o novo nome do estado:",EDGE_ENTER_NEW_ORIGIN:"Digite a nova origem:",EDGE_ENTER_NEW_TARGET:"Digite o novo destino:",FA:"Autômato Finito",PDA:"Autômato de Pilha",LBA:"Autômato Linearmente Limitado",FA_ENTER_EDGE_CONTENT:"Digite o conteúdo da transição (até 1 caractere):",FA_ENTER_EDGE_PLACEHOLDER_1:"símbolo",PDA_ENTER_EDGE_CONTENT:"Digite o símbolo de entrada, símbolo de pilha lido e símbolo(s) de pilha escrito(s)",PDA_ENTER_EDGE_PLACEHOLDER_1:"ler (entrada)",PDA_ENTER_EDGE_PLACEHOLDER_2:"ler (pilha)",PDA_ENTER_EDGE_PLACEHOLDER_3:"escrever",LBA_ENTER_EDGE_CONTENT:"Digite o(s) símbolo(s) de fita lido(s), escrito(s) e a direção do movimento",LBA_ENTER_EDGE_PLACEHOLDER_1:"ler",LBA_ENTER_EDGE_PLACEHOLDER_2:"escrever",LBA_ENTER_EDGE_PLACEHOLDER_3:"direção",RECOGNITION:"Reconhecimento",MULTIPLE_RECOGNITION:"Reconhecimento múltiplo",TEST_CASE:"caso de teste",FAST_RECOGNITION:"Reconhecimento rápido (R)",STEP_RECOGNITION:"Reconhecimento passo-a-passo (Enter)",STOP_RECOGNITION:"Parar reconhecimento passo-a-passo (Esc)",START_MULTIPLE_RECOGNITION:"Reconhecimento múltiplo",CHANGE_MACHINE_WARNING:"Alterar o tipo de máquina reseta o autômato. Deseja continuar?",INPUT_ACCEPTED:"aceito",INPUT_REJECTED:"rejeitado",INPUT_LOOPING:"rejeitado<br>(looping)",EMPTY:"vazio",EMPTY_STACK:"pilha vazia",ACCEPT_BY_FINAL_STATE:"Aceitar por estado final",ACCEPT_BY_EMPTY_STACK:"Aceitar por pilha vazia",NO_RECOGNITION_IN_PROGRESS:"nenhum reconhecimento em andamento",STACK_MENUBAR:"Conteúdo da pilha",ACTION_TREE_MENUBAR:"Possíveis próximas ações",ACTION_TREE_NO_ACTIONS:"nenhuma ação possível",PDA_FIELD_INPUT:"Entrada",PDA_FIELD_STACK:"Pilha",PDA_FIELD_READ_INPUT:"Ler (entrada)",PDA_FIELD_WRITE:"Escrever",PDA_FIELD_TARGET_STATE:"Estado-destino",ERROR_INVALID_STATE_NAME:"Nome de estado inválido",DETERMINIZATION:"Determinização"}}(i.portuguese||(i.portuguese={}))},{}],25:[function(t,e,i){"use strict";function n(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}i.__esModule=!0,n(t("../machines/FA/FAController")),n(t("../machines/PDA/PDAController")),n(t("../machines/LBA/LBAController"))},{"../machines/FA/FAController":31,"../machines/LBA/LBAController":35,"../machines/PDA/PDAController":38}],26:[function(t,e,i){"use strict";function n(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}i.__esModule=!0,n(t("../machines/FA/initializer")),n(t("../machines/PDA/initializer")),n(t("../machines/LBA/initializer"))},{"../machines/FA/initializer":32,"../machines/LBA/initializer":36,"../machines/PDA/initializer":39}],27:[function(t,e,i){"use strict";function n(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}i.__esModule=!0,n(t("../languages/Portuguese")),n(t("../languages/English"))},{"../languages/English":23,"../languages/Portuguese":24}],28:[function(t,e,i){"use strict";i.__esModule=!0;!function(t){t[t.FA=0]="FA",t[t.PDA=1]="PDA",t[t.LBA=2]="LBA"}(i.Machine||(i.Machine={}))},{}],29:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../machines/FA/operations/Determinization");i.FA={Determinization:n},i.PDA={},i.LBA={}},{"../machines/FA/operations/Determinization":33}],30:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../../datastructures/Queue"),s=t("../../datastructures/UnorderedSet"),r=t("../../Utils"),a=function(){function t(){this.stateList=[],this.alphabetSet={},this.transitions={},this.epsilonTransitions={},this.initialState=-1,this.finalStates=new s.UnorderedSet,this.numRemovedStates=0,this.currentStates=new s.UnorderedSet}return t.prototype.addState=function(t){this.stateList.push(t);var e=this.realNumStates()-1;return this.transitions[e]={},this.epsilonTransitions[e]=new s.UnorderedSet,-1==this.initialState&&(this.initialState=e,this.reset()),e},t.prototype.removeState=function(t){var e=this;r.utils.foreach(this.transitions,function(i,n){var s=parseInt(i);r.utils.foreach(n,function(i){n[i].contains(t)&&e.removeTransition(s,t,i),s==t&&n[i].forEach(function(n){e.removeTransition(t,n,i)})})}),delete this.transitions[t],this.initialState==t&&this.unsetInitialState(),this.currentStates.erase(t),this.finalStates.erase(t),this.stateList[t]=void 0,this.numRemovedStates++},t.prototype.renameState=function(t,e){this.stateList[t]=e},t.prototype.addTransition=function(t,e,i){var n=this.transitions[t];""==i?this.epsilonTransitions[t].insert(e):(n.hasOwnProperty(i)||(n[i]=new s.UnorderedSet),n[i].insert(e),this.alphabetSet.hasOwnProperty(i)||(this.alphabetSet[i]=0),this.alphabetSet[i]++)},t.prototype.removeTransition=function(t,e,i){var n=this.transitions[t];""==i?this.epsilonTransitions[t].erase(e):n.hasOwnProperty(i)&&(n[i].erase(e),n[i].empty()&&delete n[i],this.alphabetSet[i]--,0==this.alphabetSet[i]&&delete this.alphabetSet[i])},t.prototype.setInitialState=function(t){t<this.realNumStates()&&(this.initialState=t)},t.prototype.unsetInitialState=function(){this.initialState=-1},t.prototype.getInitialState=function(){return this.stateList[this.initialState]},t.prototype.addAcceptingState=function(t){this.finalStates.insert(t)},t.prototype.removeAcceptingState=function(t){this.finalStates.erase(t)},t.prototype.getAcceptingStates=function(){var t=[],e=this;return this.finalStates.forEach(function(i){t.push(e.stateList[i])}),t},t.prototype.getCurrentStates=function(){var t=[],e=this;return this.currentStates.forEach(function(i){t.push(e.stateList[i])}),t},t.prototype.getStates=function(){return this.stateList.filter(function(t){return void 0!==t})},t.prototype.transitionIteration=function(t){var e=this,i=this;for(var n in this.transitions)!function(n){if(i.transitions.hasOwnProperty(n)){var s=e.stateList[n],r=i.transitions[n];for(var a in r)!function(i){r.hasOwnProperty(i)&&r[i].forEach(function(n){var r=e.stateList[n];t(s,r,i)})}(a)}}(n);var s=this;for(var n in this.epsilonTransitions)!function(i){if(s.transitions.hasOwnProperty(i)){var n=e.stateList[i];s.epsilonTransitions[i].forEach(function(i){var s=e.stateList[i];t(n,s,"")})}}(n)},t.prototype.alphabet=function(){var t=[];for(var e in this.alphabetSet)this.alphabetSet.hasOwnProperty(e)&&t.push(e);return t},t.prototype.read=function(t){var e=new s.UnorderedSet,i=this;this.currentStates.forEach(function(n){var s=i.transition(n,t);s&&s.forEach(function(t){e.insert(t)})}),this.expandSpontaneous(e),this.currentStates=e},t.prototype.reset=function(){this.currentStates.clear(),-1!=this.initialState&&(this.currentStates.insert(this.initialState),this.expandSpontaneous(this.currentStates))},t.prototype.clear=function(){this.stateList=[],this.alphabetSet={},this.transitions={},this.epsilonTransitions={},this.unsetInitialState(),this.finalStates.clear(),this.numRemovedStates=0,this.currentStates.clear()},t.prototype.accepts=function(){var t=!1,e=this;return this.finalStates.forEach(function(i){return!e.currentStates.contains(i)||(t=!0,!1)}),t},t.prototype.error=function(){return 0==this.currentStates.size()},t.prototype.numStates=function(){return this.stateList.length-this.numRemovedStates},t.prototype.realNumStates=function(){return this.stateList.length},t.prototype.transition=function(t,e){return this.transitions[t][e]},t.prototype.expandSpontaneous=function(t){var e=new n.Queue;for(t.forEach(function(t){e.push(t)});!e.empty();){var i=e.pop();this.epsilonTransitions[i].forEach(function(i){t.contains(i)||(t.insert(i),e.push(i))})}},t}();i.FA=a},{"../../Utils":9,"../../datastructures/Queue":10,"../../datastructures/UnorderedSet":11}],31:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./FA"),s=t("../../Keyboard"),r=t("../../Prompt"),a=t("../../Settings"),o=t("../../Utils"),l=function(){function t(){this.stateMapping={},this.stepIndex=-1,this.editingCallback=function(){},this.machine=new n.FA}return t.prototype.edgePrompt=function(t,e){var i=this,n=new r.Prompt(a.Strings.FA_ENTER_EDGE_CONTENT);return n.addInput({placeholder:a.Strings.FA_ENTER_EDGE_PLACEHOLDER_1,validator:o.utils.optionalSymbolValidator}),n.onSuccess(function(e){t(e,i.edgeDataToText(e))}),n.onAbort(e),n},t.prototype.edgeDataToText=function(t){var e=s.Keyboard.symbols.epsilon;return t[0]||e},t.prototype.createState=function(t){var e=t.getName(),i=this.machine.addState(e);this.stateMapping[e]=i,t.isInitial()&&this.machine.setInitialState(i),t.isFinal()&&this.machine.addAcceptingState(i),this.editingCallback()},t.prototype.createEdge=function(t,e,i){var n=this.index(t),s=this.index(e),r=this.edgeDataToText(i);i[0]||(r=""),this.machine.addTransition(n,s,r),this.editingCallback()},t.prototype.changeInitialFlag=function(t){t.isInitial()?this.machine.setInitialState(this.index(t)):this.machine.unsetInitialState(),this.editingCallback()},t.prototype.changeFinalFlag=function(t){var e=this.index(t);t.isFinal()?this.machine.addAcceptingState(e):this.machine.removeAcceptingState(e),this.editingCallback()},t.prototype.renameState=function(t,e){var i=this.index(t);delete this.stateMapping[t.getName()],this.stateMapping[e]=i,this.machine.renameState(i,e),this.editingCallback()},t.prototype.deleteState=function(t){this.machine.removeState(this.index(t)),this.editingCallback()},t.prototype.deleteEdge=function(t,e,i){var n=this.index(t),s=this.index(e),r=this.edgeDataToText(i);i[0]||(r=""),this.machine.removeTransition(n,s,r),this.editingCallback()},t.prototype.clear=function(){this.machine.clear(),this.editingCallback()},t.prototype.fastForward=function(t){this.machine.reset();for(var e=0;e<t.length;e++)this.machine.read(t[e])},t.prototype.step=function(t){if(!this.finished(t)){if(-1==this.stepIndex)this.machine.reset();else{var e=t[this.stepIndex];this.machine.read(e)}this.stepIndex++}},t.prototype.stop=function(){this.stepIndex=-1},t.prototype.reset=function(){this.machine.reset()},t.prototype.finished=function(t){return this.stepIndex>=0&&(this.machine.error()||this.stepIndex>=t.length)},t.prototype.isStopped=function(){return-1==this.stepIndex},t.prototype.stepPosition=function(){return this.stepIndex},t.prototype.currentStates=function(){return this.machine.getCurrentStates()},t.prototype.accepts=function(){return this.machine.accepts()},t.prototype.formalDefinition=function(){var t=this.machine,e=s.Keyboard.symbols.delta,i=s.Keyboard.symbols.sigma,n={tupleSequence:["Q",i,e,"q0","F"],parameterSequence:["Q",i,"q0","F",e],parameterValues:{}},r=n.parameterValues;return r.Q=t.getStates(),r[i]=t.alphabet(),r[e]=this.transitionTable(),r.q0=t.getInitialState(),r.F=t.getAcceptingStates(),n},t.prototype.setEditingCallback=function(t){this.editingCallback=t},t.prototype.applyOperation=function(t){console.log("[APPLY]",t)},t.prototype.index=function(t){return this.stateMapping[t.getName()]},t.prototype.transitionTable=function(){var t=s.Keyboard.symbols,e=t.epsilon,i=["Q",t.sigma+" ∪ {"+e+"}","Q"],n={domain:[i[0],"("+i[1]+")"].join(" x "),codomain:i[2],header:i,list:[],metadata:[]};return this.machine.transitionIteration(function(t,e,i){i=i||s.Keyboard.symbols.epsilon,n.list.push([t,i,e]),n.metadata.push([t,e])}),n},t}();i.FAController=l},{"../../Keyboard":3,"../../Prompt":5,"../../Settings":6,"../../Utils":9,"./FA":30}],32:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../../Keyboard"),s=t("../../interface/Menu"),r=t("../../Settings"),a=t("../../SignalEmitter"),o=t("../../System"),l=t("../../Utils"),c=function(){function t(){this.shortcutGroup="FA",this.boundShortcuts=!1}return t.prototype.init=function(){var t=[],e=new s.Menu(r.Strings.RECOGNITION),i=[];this.buildTestCaseInput(i),this.buildRecognitionControls(i),this.buildRecognitionProgress(i),this.addRows(i,e),t.push(e);var n=new s.Menu(r.Strings.MULTIPLE_RECOGNITION);i=[],this.buildMultipleRecognition(i),this.addRows(i,n),t.push(n),this.bindRecognitionEvents(),r.Settings.machines[r.Settings.Machine.FA].sidebar=t},t.prototype.onEnter=function(){this.bindShortcuts(),o.System.unlockShortcutGroup(this.shortcutGroup)},t.prototype.onExit=function(){this.stopRecognition.click(),o.System.lockShortcutGroup(this.shortcutGroup)},t.prototype.addRows=function(t,e){for(var i=0,n=t;i<n.length;i++){for(var s=n[i],r=l.utils.create("div",{className:"row"}),a=0,o=s;a<o.length;a++){var c=o[a];r.appendChild(c)}e.add(r)}},t.prototype.testCase=function(){return this.testCaseInput.value},t.prototype.buildTestCaseInput=function(t){this.testCaseInput=l.utils.create("input",{type:"text",placeholder:r.Strings.TEST_CASE}),t.push([this.testCaseInput])},t.prototype.highlightCurrentStates=function(){var t=r.Settings.controller().currentStates();a.SignalEmitter.emitSignal({targetID:r.Settings.automatonRendererSignalID,identifier:"recognitionHighlight",data:[t]})},t.prototype.buildRecognitionControls=function(t){var e=r.Settings.disabledButtonClass;this.fastRecognition=l.utils.create("img",{className:"image_button",src:"images/fastforward.svg",title:r.Strings.FAST_RECOGNITION}),this.stopRecognition=l.utils.create("img",{className:"image_button "+e,src:"images/stop.svg",title:r.Strings.STOP_RECOGNITION}),this.stepRecognition=l.utils.create("img",{className:"image_button",src:"images/play.svg",title:r.Strings.STEP_RECOGNITION}),t.push([this.fastRecognition,this.stepRecognition,this.stopRecognition])},t.prototype.buildRecognitionProgress=function(t){this.progressContainer=l.utils.create("div",{id:"recognition_progress"}),this.progressContainer.style.display="none",t.push([this.progressContainer])},t.prototype.buildMultipleRecognition=function(t){this.multipleCaseArea=l.utils.create("textarea"),this.multipleCaseArea.rows=r.Settings.multRecognitionAreaRows,this.multipleCaseArea.cols=r.Settings.multRecognitionAreaCols,this.multipleCaseResults=l.utils.create("div");var e=l.utils.create("div",{id:"multiple_recognition"});e.appendChild(this.multipleCaseArea),e.appendChild(this.multipleCaseResults),t.push([e]),this.multipleCaseButton=l.utils.create("img",{className:"image_button",src:"images/play.svg",title:r.Strings.START_MULTIPLE_RECOGNITION}),t.push([this.multipleCaseButton])},t.prototype.showAcceptanceStatus=function(){r.Settings.controller().accepts()?(this.progressContainer.style.color=r.Settings.acceptedTestCaseColor,this.progressContainer.innerHTML=r.Strings.INPUT_ACCEPTED):(this.progressContainer.style.color=r.Settings.rejectedTestCaseColor,this.progressContainer.innerHTML=r.Strings.INPUT_REJECTED)},t.prototype.unlockAutomaton=function(){a.SignalEmitter.emitSignal({targetID:r.Settings.automatonRendererSignalID,identifier:"unlock",data:[]})},t.prototype.bindRecognitionEvents=function(){var t=r.Settings.disabledButtonClass,e=!0,i=!0,n=!1,s=this,o=l.utils.create("span",{className:"parsed_input"}),c=l.utils.create("span",{className:"remaining_input"}),h=!1,u=function(i){e=i,s.fastRecognition.classList[i?"remove":"add"](t)},p=function(e){i=e,s.stepRecognition.classList[e?"remove":"add"](t)},d=function(e){n=e,s.stopRecognition.classList[e?"remove":"add"](t)};this.fastRecognition.addEventListener("click",function(){if(e){var t=s.testCase();r.Settings.controller().fastForward(t),s.highlightCurrentStates(),s.progressContainer.style.display="",h=!1,s.showAcceptanceStatus(),u(!1),p(!1),d(!0),s.testCaseInput.disabled=!0}}),this.stopRecognition.addEventListener("click",function(){n&&(r.Settings.controller().stop(),a.SignalEmitter.emitSignal({targetID:r.Settings.automatonRendererSignalID,identifier:"recognitionDim",data:[]}),s.unlockAutomaton(),s.progressContainer.style.color="black",s.progressContainer.style.display="none",u(!0),p(!0),d(!1),s.testCaseInput.disabled=!1)}),this.stepRecognition.addEventListener("click",function(){if(i){u(!1),d(!0),s.testCaseInput.disabled=!0;var t=s.testCase(),e=r.Settings.controller();e.isStopped()&&(a.SignalEmitter.emitSignal({targetID:r.Settings.automatonRendererSignalID,identifier:"lock",data:[]}),s.progressContainer.style.display="");var n=e.finished(t);if(n||(e.step(t),s.highlightCurrentStates(),n=e.finished(t)),n)h=!1,s.showAcceptanceStatus(),p(!1),s.unlockAutomaton();else{var l=e.stepPosition();h||(s.progressContainer.innerHTML="",s.progressContainer.appendChild(o),s.progressContainer.appendChild(c),h=!0),o.innerHTML=t.substr(0,l),c.innerHTML=t.substr(l)}}}),this.multipleCaseButton.addEventListener("click",function(){var t=s.multipleCaseArea.value.split("\n"),e=r.Settings.controller();s.multipleCaseResults.innerHTML="";for(var i=0,n=t;i<n.length;i++){var a=n[i];e.fastForward(a);var o=l.utils.create("span");e.accepts()?(o.style.color=r.Settings.acceptedTestCaseColor,o.innerHTML=r.Strings.INPUT_ACCEPTED):(o.style.color=r.Settings.rejectedTestCaseColor,o.innerHTML=r.Strings.INPUT_REJECTED),s.multipleCaseResults.appendChild(o)}})},t.prototype.bindShortcuts=function(){var t=this;this.boundShortcuts||(o.System.bindShortcut(r.Settings.shortcuts.focusTestCase,function(){t.testCaseInput.focus()},this.shortcutGroup),o.System.bindShortcut(r.Settings.shortcuts.fastForward,function(){t.fastRecognition.click()},this.shortcutGroup),o.System.bindShortcut(r.Settings.shortcuts.step,function(){t.stepRecognition.click()},this.shortcutGroup),o.System.bindShortcut(r.Settings.shortcuts.stop,function(){t.stopRecognition.click()},this.shortcutGroup),this.boundShortcuts=!0),this.testCaseInput.addEventListener("keydown",function(e){var i=r.Settings.shortcuts.dimTestCase[0];e.keyCode==n.Keyboard.keys[i]&&t.testCaseInput.blur()})},t}();i.initFA=c},{"../../Keyboard":3,"../../Settings":6,"../../SignalEmitter":7,"../../System":8,"../../Utils":9,"../../interface/Menu":17}],33:[function(t,e,i){"use strict";i.__esModule=!0,i.name="Determinization",i.command=function(t){return t.addState("[what]"),t}},{}],34:[function(t,e,i){"use strict";i.__esModule=!0;var n,s=t("../../datastructures/UnorderedSet"),r=t("../../Utils");!function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT"}(n||(n={}));var a=function(){function t(){this.stateList=[],this.inputAlphabet={},this.tapeAlphabet={},this.transitions={},this.initialState=-1,this.finalStates=new s.UnorderedSet,this.numRemovedStates=0,this.currentState=null,this.tape=[],this.headPosition=0,this.calculationSteps=0,this.inputLength=0,this.accepting=!1}return t.prototype.addState=function(t){this.stateList.push(t);var e=this.realNumStates()-1;return this.transitions[e]={},-1==this.initialState&&(this.initialState=e,this.reset()),e},t.prototype.removeState=function(t){var e=this;r.utils.foreach(this.transitions,function(i,n){var s=parseInt(i);r.utils.foreach(n,function(i){n[i].state==t&&e.uncheckedRemoveTransition(s,i),s==t&&e.uncheckedRemoveTransition(t,i)})}),delete this.transitions[t],this.initialState==t&&this.unsetInitialState(),this.finalStates.erase(t),this.stateList[t]=void 0,this.numRemovedStates++},t.prototype.renameState=function(t,e){this.stateList[t]=e},t.prototype.addTransition=function(t,e,i){var n=this.transitions[t],s=i[0],r=i[1],a=this.plainTextToDirection(i[2]);n[s]={state:e,tapeSymbol:r,direction:a},this.isInputSymbol(s)&&this.addInputSymbol(s),this.isInputSymbol(r)&&this.addInputSymbol(r),this.addTapeSymbol(s),this.addTapeSymbol(r)},t.prototype.removeTransition=function(t,e,i){var n=this.transitions[t],s=i[0],r=i[1],a=this.plainTextToDirection(i[2]);if(n.hasOwnProperty(s)){var o=n[s],l=o.state==e;(l=(l=l&&o.tapeSymbol==r)&&o.direction==a)&&this.uncheckedRemoveTransition(t,s)}},t.prototype.uncheckedRemoveTransition=function(t,e){var i=this.transitions[t],n=i[e].tapeSymbol;delete i[e],this.isInputSymbol(e)&&this.removeInputSymbol(e),this.isInputSymbol(n)&&this.removeInputSymbol(n),this.removeTapeSymbol(e),this.removeTapeSymbol(n)},t.prototype.setInitialState=function(t){t<this.realNumStates()&&(this.initialState=t)},t.prototype.unsetInitialState=function(){this.initialState=-1},t.prototype.getInitialState=function(){return this.stateList[this.initialState]},t.prototype.addAcceptingState=function(t){this.finalStates.insert(t)},t.prototype.removeAcceptingState=function(t){this.finalStates.erase(t)},t.prototype.getAcceptingStates=function(){var t=[],e=this;return this.finalStates.forEach(function(i){t.push(e.stateList[i])}),t},t.prototype.getCurrentState=function(){if(null!==this.currentState)return this.stateList[this.currentState]},t.prototype.getStates=function(){return this.stateList.filter(function(t){return void 0!==t})},t.prototype.transitionIteration=function(t){for(var e in this.transitions)if(this.transitions.hasOwnProperty(e)){var i=this.stateList[e],n=this.transitions[e];for(var s in n)if(n.hasOwnProperty(s)){var r=n[s];t(i,{state:this.stateList[r.state],tapeSymbol:r.tapeSymbol,direction:r.direction},s)}}},t.prototype.getInputAlphabet=function(){var t=[];for(var e in this.inputAlphabet)this.inputAlphabet.hasOwnProperty(e)&&t.push(e);return t},t.prototype.getTapeAlphabet=function(){var t=[];for(var e in this.tapeAlphabet)this.tapeAlphabet.hasOwnProperty(e)&&t.push(e);return t},t.prototype.setTapeContent=function(t){this.tape=t,this.headPosition=0,this.calculationSteps=0,this.inputLength=t.length,this.accepting=!1},t.prototype.getTapeContent=function(){return this.tape.slice()},t.prototype.getHeadPosition=function(){return this.headPosition},t.prototype.read=function(){if(!this.error()){var t=!0,e=this.tape[this.headPosition];if(this.transitions.hasOwnProperty(this.currentState+"")){var i=this.transitions[this.currentState];if(i.hasOwnProperty(e)){var n=i[e];this.currentState=n.state,this.tape[this.headPosition]=n.tapeSymbol,this.headPosition+=this.directionToOffset(n.direction),this.calculationSteps++,t=!1}}this.exhausted()&&(t=!0),t&&(this.accepts()&&(this.accepting=!0),this.currentState=null)}},t.prototype.halted=function(){return this.error()},t.prototype.reset=function(){-1==this.initialState?this.currentState=null:this.currentState=this.initialState,this.headPosition=0,this.calculationSteps=0,this.accepting=!1},t.prototype.clear=function(){this.stateList=[],this.inputAlphabet={},this.tapeAlphabet={},this.transitions={},this.unsetInitialState(),this.finalStates.clear(),this.numRemovedStates=0,this.currentState=null,this.tape=[],this.headPosition=0,this.calculationSteps=0,this.accepting=!1},t.prototype.accepts=function(){if(this.accepting)return!0;if(null===this.currentState)return!1;var t=this.finalStates.contains(this.currentState);return t=t&&this.headPosition>=this.tape.length},t.prototype.error=function(){return null===this.currentState},t.prototype.numStates=function(){return this.stateList.length-this.numRemovedStates},t.prototype.exhausted=function(){if(this.accepts())return!1;var t=this.numStates(),e=this.inputLength,i=Object.keys(this.tapeAlphabet).length;return this.calculationSteps>t*e*Math.pow(i,e)},t.prototype.isInputSymbol=function(t){return/[a-z]/.test(t)},t.prototype.plainTextToDirection=function(t){return"<"==t?n.LEFT:n.RIGHT},t.prototype.directionToOffset=function(t){return t==n.LEFT?-1:1},t.prototype.addSymbol=function(t,e){this[t].hasOwnProperty(e)||(this[t][e]=0),this[t][e]++},t.prototype.addInputSymbol=function(t){this.addSymbol("inputAlphabet",t)},t.prototype.addTapeSymbol=function(t){this.addSymbol("tapeAlphabet",t)},t.prototype.removeSymbol=function(t,e){this[t][e]--,0==this[t][e]&&delete this[t][e]},t.prototype.removeInputSymbol=function(t){this.removeSymbol("inputAlphabet",t)},t.prototype.removeTapeSymbol=function(t){this.removeSymbol("tapeAlphabet",t)},t.prototype.realNumStates=function(){return this.stateList.length},t}();i.LBA=a},{"../../Utils":9,"../../datastructures/UnorderedSet":11}],35:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../../Keyboard"),s=t("./LBA"),r=t("../../Prompt"),a=t("../../Settings"),o=t("../../Utils"),l=function(){function t(){this.stateMapping={},this.stepIndex=-1,this.editingCallback=function(){},this.machine=new s.LBA}return t.prototype.edgePrompt=function(t,e){var i=this,s=new r.Prompt(a.Strings.LBA_ENTER_EDGE_CONTENT);return s.addInput({placeholder:a.Strings.LBA_ENTER_EDGE_PLACEHOLDER_1,validator:o.utils.singleSymbolValidator}),s.addInput({placeholder:a.Strings.LBA_ENTER_EDGE_PLACEHOLDER_2,validator:o.utils.singleSymbolValidator}),s.addInput({initializer:function(){var t=o.utils.create("select");return t.appendChild(o.utils.create("option",{innerHTML:n.Keyboard.symbols.leftArrow,value:"<"})),t.appendChild(o.utils.create("option",{innerHTML:n.Keyboard.symbols.rightArrow,value:">"})),t}}),s.onSuccess(function(e){t(e,i.edgeDataToText(e))}),s.onAbort(e),s},t.prototype.edgeDataToText=function(t){var e=n.Keyboard.symbols,i=e.epsilon,s=[t[0]||i,t[1]||i,"<"==t[2]?e.leftArrow:e.rightArrow];return s[0]+", "+s[1]+", "+s[2]},t.prototype.createState=function(t){var e=t.getName(),i=this.machine.addState(e);this.stateMapping[e]=i,t.isInitial()&&this.machine.setInitialState(i),t.isFinal()&&this.machine.addAcceptingState(i),this.editingCallback()},t.prototype.createEdge=function(t,e,i){var n=this.index(t),s=this.index(e);this.machine.addTransition(n,s,i),this.editingCallback()},t.prototype.changeInitialFlag=function(t){t.isInitial()?this.machine.setInitialState(this.index(t)):this.machine.unsetInitialState(),this.editingCallback()},t.prototype.changeFinalFlag=function(t){var e=this.index(t);t.isFinal()?this.machine.addAcceptingState(e):this.machine.removeAcceptingState(e),this.editingCallback()},t.prototype.renameState=function(t,e){var i=this.index(t);delete this.stateMapping[t.getName()],this.stateMapping[e]=i,this.machine.renameState(i,e),this.editingCallback()},t.prototype.deleteState=function(t){this.machine.removeState(this.index(t)),this.editingCallback()},t.prototype.deleteEdge=function(t,e,i){var n=this.index(t),s=this.index(e);this.machine.removeTransition(n,s,i),this.editingCallback()},t.prototype.clear=function(){this.machine.clear(),this.editingCallback()},t.prototype.fastForward=function(t){for(this.machine.reset(),this.machine.setTapeContent(t.split(""));!this.finished(t);)this.machine.read()},t.prototype.step=function(t){this.finished(t)||(-1==this.stepIndex?(this.machine.reset(),this.machine.setTapeContent(t.split(""))):this.machine.read(),this.stepIndex++)},t.prototype.stop=function(){this.stepIndex=-1},t.prototype.reset=function(){this.machine.reset()},t.prototype.finished=function(t){return this.machine.halted()},t.prototype.isStopped=function(){return-1==this.stepIndex},t.prototype.stepPosition=function(){return this.stepIndex},t.prototype.getTapeContent=function(){return this.machine.getTapeContent()},t.prototype.getHeadPosition=function(){return this.machine.getHeadPosition()},t.prototype.currentStates=function(){var t=this.machine.getCurrentState(),e=[];return this.machine.error()||e.push(t),e},t.prototype.accepts=function(){return this.machine.accepts()},t.prototype.exhausted=function(){return this.machine.exhausted()},t.prototype.formalDefinition=function(){var t=this.machine,e=n.Keyboard.symbols.delta,i=n.Keyboard.symbols.gamma,s=n.Keyboard.symbols.sigma,r={tupleSequence:["Q",s,i,e,"q0","B","F"],parameterSequence:["Q",s,i,"q0","B","F",e],parameterValues:{}},a=r.parameterValues;return a.Q=t.getStates(),a[s]=t.getInputAlphabet(),a[i]=t.getTapeAlphabet(),a[e]=this.transitionTable(),a.q0=t.getInitialState(),a.B="_",a.F=t.getAcceptingStates(),r},t.prototype.setEditingCallback=function(t){this.editingCallback=t},t.prototype.applyOperation=function(t){},t.prototype.index=function(t){return this.stateMapping[t.getName()]},t.prototype.transitionTable=function(){var t=n.Keyboard.symbols,e=t.gamma,i=["Q",e,"Q",e,"{"+t.leftArrow+","+t.rightArrow+"}"],s={domain:[i[0],i[1]].join(" x "),codomain:[i[2],i[3],i[4]].join(" x "),header:i,list:[],metadata:[]},r=[n.Keyboard.symbols.leftArrow,n.Keyboard.symbols.rightArrow];return this.machine.transitionIteration(function(t,e,i){s.list.push([t,i,e.state,e.tapeSymbol,r[e.direction]]),s.metadata.push([t,e.state])}),s},t}();i.LBAController=l},{"../../Keyboard":3,"../../Prompt":5,"../../Settings":6,"../../Utils":9,"./LBA":34}],36:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../../Keyboard"),s=t("../../interface/Menu"),r=t("../../Settings"),a=t("../../SignalEmitter"),o=t("../../System"),l=t("../../Utils"),c=function(){function t(){this.shortcutGroup="LBA",this.boundShortcuts=!1}return t.prototype.init=function(){var t=[],e=new s.Menu(r.Strings.RECOGNITION),i=[];this.buildTestCaseInput(i),this.buildRecognitionControls(i),this.buildTape(i),this.buildRecognitionProgress(i),this.addRows(i,e),t.push(e);var n=new s.Menu(r.Strings.MULTIPLE_RECOGNITION);i=[],this.buildMultipleRecognition(i),this.addRows(i,n),t.push(n),this.bindRecognitionEvents(),r.Settings.machines[r.Settings.Machine.LBA].sidebar=t},t.prototype.onEnter=function(){this.bindShortcuts(),o.System.unlockShortcutGroup(this.shortcutGroup)},t.prototype.onExit=function(){this.stopRecognition.click(),o.System.lockShortcutGroup(this.shortcutGroup)},t.prototype.addRows=function(t,e){for(var i=0,n=t;i<n.length;i++){for(var s=n[i],r=l.utils.create("div",{className:"row"}),a=0,o=s;a<o.length;a++){var c=o[a];r.appendChild(c)}e.add(r)}},t.prototype.testCase=function(){return this.testCaseInput.value},t.prototype.buildTestCaseInput=function(t){var e=l.utils.create("input",{type:"text",placeholder:r.Strings.TEST_CASE});t.push([e]),this.testCaseInput=e},t.prototype.highlightCurrentStates=function(){var t=r.Settings.controller().currentStates();a.SignalEmitter.emitSignal({targetID:r.Settings.automatonRendererSignalID,identifier:"recognitionHighlight",data:[t]})},t.prototype.buildRecognitionControls=function(t){var e=r.Settings.disabledButtonClass;this.fastRecognition=l.utils.create("img",{className:"image_button",src:"images/fastforward.svg",title:r.Strings.FAST_RECOGNITION}),this.stopRecognition=l.utils.create("img",{className:"image_button "+e,src:"images/stop.svg",title:r.Strings.STOP_RECOGNITION}),this.stepRecognition=l.utils.create("img",{className:"image_button",src:"images/play.svg",title:r.Strings.STEP_RECOGNITION}),t.push([this.fastRecognition,this.stepRecognition,this.stopRecognition])},t.prototype.buildTape=function(t){this.tapeContainer=l.utils.create("div",{id:"tape"}),this.tapeContainer.style.display="none";for(var e=r.Settings.tapeDisplayedChars,i=0;i<e;i++){var n=l.utils.create("div",{className:"tape_cell"});this.tapeContainer.appendChild(n)}this.tapeContainer.children[(e-1)/2].classList.add("center"),t.push([this.tapeContainer])},t.prototype.buildRecognitionProgress=function(t){this.progressContainer=l.utils.create("div",{id:"recognition_progress"}),this.progressContainer.style.display="none",t.push([this.progressContainer])},t.prototype.buildMultipleRecognition=function(t){this.multipleCaseArea=l.utils.create("textarea"),this.multipleCaseArea.rows=r.Settings.multRecognitionAreaRows,this.multipleCaseArea.cols=r.Settings.multRecognitionAreaCols,this.multipleCaseResults=l.utils.create("div");var e=l.utils.create("div",{id:"multiple_recognition"});e.appendChild(this.multipleCaseArea),e.appendChild(this.multipleCaseResults),t.push([e]),this.multipleCaseButton=l.utils.create("img",{className:"image_button",src:"images/play.svg",title:r.Strings.START_MULTIPLE_RECOGNITION}),t.push([this.multipleCaseButton])},t.prototype.showAcceptanceStatus=function(){var t=r.Settings.controller();t.accepts()?(this.progressContainer.style.color=r.Settings.acceptedTestCaseColor,this.progressContainer.innerHTML=r.Strings.INPUT_ACCEPTED):(this.progressContainer.style.color=r.Settings.rejectedTestCaseColor,t.exhausted()?this.progressContainer.innerHTML=r.Strings.INPUT_LOOPING:this.progressContainer.innerHTML=r.Strings.INPUT_REJECTED)},t.prototype.showTapeContent=function(){var t=r.Settings.controller(),e=t.getTapeContent(),i=t.getHeadPosition(),n=r.Settings.tapeDisplayedChars,s=i-(n-1)/2;if(s<0){for(var a=[],o=0;o<-s;o++)a.push("_");e=a.concat(e),s=0}if(s+n>e.length)for(var l=s+n-e.length,o=0;o<l;o++)e.push("_");for(var c=e.slice(s,s+n),o=0;o<n;o++)this.tapeContainer.children[o].innerHTML=c[o]},t.prototype.bindRecognitionEvents=function(){var t=r.Settings.disabledButtonClass,e=!0,i=!0,n=!1,s=this,o=function(i){e=i,s.fastRecognition.classList[i?"remove":"add"](t)},c=function(e){i=e,s.stepRecognition.classList[e?"remove":"add"](t)},h=function(e){n=e,s.stopRecognition.classList[e?"remove":"add"](t)};this.fastRecognition.addEventListener("click",function(){if(e){a.SignalEmitter.emitSignal({targetID:r.Settings.automatonRendererSignalID,identifier:"lock",data:[]});var t=s.testCase();r.Settings.controller().fastForward(t),s.highlightCurrentStates(),s.progressContainer.style.display="",s.showAcceptanceStatus(),s.tapeContainer.style.display="",s.showTapeContent(),o(!1),c(!1),h(!0),s.testCaseInput.disabled=!0}}),this.stopRecognition.addEventListener("click",function(){n&&(r.Settings.controller().stop(),a.SignalEmitter.emitSignal({targetID:r.Settings.automatonRendererSignalID,identifier:"recognitionDim",data:[]}),a.SignalEmitter.emitSignal({targetID:r.Settings.automatonRendererSignalID,identifier:"unlock",data:[]}),s.progressContainer.style.color="black",s.progressContainer.style.display="none",s.tapeContainer.style.display="none",o(!0),c(!0),h(!1),s.testCaseInput.disabled=!1)}),this.stepRecognition.addEventListener("click",function(){if(i){o(!1),h(!0),s.testCaseInput.disabled=!0;var t=s.testCase(),e=r.Settings.controller();e.isStopped()&&(e.reset(),a.SignalEmitter.emitSignal({targetID:r.Settings.automatonRendererSignalID,identifier:"lock",data:[]}),s.tapeContainer.style.display="");var n=e.finished(t);n||(e.step(t),s.highlightCurrentStates(),n=e.finished(t),s.showTapeContent()),n&&(c(!1),s.progressContainer.style.display="",s.showAcceptanceStatus())}}),this.multipleCaseButton.addEventListener("click",function(){var t=s.multipleCaseArea.value.split("\n"),e=r.Settings.controller();s.multipleCaseResults.innerHTML="";for(var i=0,n=t;i<n.length;i++){var a=n[i];e.fastForward(a);var o=l.utils.create("span");e.accepts()?(o.style.color=r.Settings.acceptedTestCaseColor,o.innerHTML=r.Strings.INPUT_ACCEPTED):(o.style.color=r.Settings.rejectedTestCaseColor,e.exhausted()?o.innerHTML=r.Strings.INPUT_LOOPING.split("<br>").join(" "):o.innerHTML=r.Strings.INPUT_REJECTED),s.multipleCaseResults.appendChild(o)}})},t.prototype.bindShortcuts=function(){var t=this;this.boundShortcuts||(o.System.bindShortcut(r.Settings.shortcuts.focusTestCase,function(){t.testCaseInput.focus()},this.shortcutGroup),o.System.bindShortcut(r.Settings.shortcuts.fastForward,function(){t.fastRecognition.click()},this.shortcutGroup),o.System.bindShortcut(r.Settings.shortcuts.step,function(){t.stepRecognition.click()},this.shortcutGroup),o.System.bindShortcut(r.Settings.shortcuts.stop,function(){t.stopRecognition.click()},this.shortcutGroup),this.boundShortcuts=!0),this.testCaseInput.addEventListener("keydown",function(e){var i=r.Settings.shortcuts.dimTestCase[0];e.keyCode==n.Keyboard.keys[i]&&t.testCaseInput.blur()})},t}();i.initLBA=c},{"../../Keyboard":3,"../../Settings":6,"../../SignalEmitter":7,"../../System":8,"../../Utils":9,"../../interface/Menu":17}],37:[function(t,e,i){"use strict";i.__esModule=!0;var n,s=t("../../datastructures/UnorderedSet"),r=t("../../Utils");!function(t){t[t.NEVER=0]="NEVER",t[t.ACCEPTING_STATE=1]="ACCEPTING_STATE",t[t.EMPTY_STACK=2]="EMPTY_STACK",t[t.BOTH=3]="BOTH"}(n=i.AcceptingHeuristic||(i.AcceptingHeuristic={}));var a=function(){function t(){this.stateList=[],this.inputAlphabet={},this.stackAlphabet={},this.transitions={},this.initialState=-1,this.finalStates=new s.UnorderedSet,this.numRemovedStates=0,this.currentState=null,this.stack=[],this.actionTree=[],this.halt=!0,this.acceptingHeuristic=n.ACCEPTING_STATE}return t.prototype.setAcceptingHeuristic=function(t){this.acceptingHeuristic=t},t.prototype.addState=function(t){this.stateList.push(t);var e=this.realNumStates()-1;return this.transitions[e]={},-1==this.initialState&&(this.initialState=e,this.reset()),e},t.prototype.removeState=function(t){r.utils.foreach(this.transitions,function(e,i){var n=parseInt(e);r.utils.foreach(i,function(e,i){r.utils.foreach(i,function(e,i){for(var s=0;s<i.length;)n==t||i[s][0]==t?i.splice(s,1):s++})})}),delete this.transitions[t],this.initialState==t&&this.unsetInitialState(),this.finalStates.erase(t),this.stateList[t]=void 0,this.numRemovedStates++},t.prototype.renameState=function(t,e){this.stateList[t]=e},t.prototype.addTransition=function(t,e,i){var n=this.transitions[t],s=i[0],r=i[1],a=i[2].split("").reverse().join("");n.hasOwnProperty(s)||(n[s]={}),n[s].hasOwnProperty(r)||(n[s][r]=[]),n[s][r].push([e,a]),this.addInputSymbol(s),this.addStackSymbol(r);for(var o=0;o<a.length;o++)this.addStackSymbol(a[o])},t.prototype.removeTransition=function(t,e,i){var n=this.transitions[t],s=i[0],r=i[1],a=i[2].split("").reverse().join("");if(n.hasOwnProperty(s)&&n[s].hasOwnProperty(r))for(var o=n[s][r],l=0;l<o.length;l++){var c=o[l];if(c[0]==e&&c[1]==a){o.splice(l,1);break}}},t.prototype.setInitialState=function(t){t<this.realNumStates()&&(this.initialState=t)},t.prototype.unsetInitialState=function(){this.initialState=-1},t.prototype.getInitialState=function(){return this.stateList[this.initialState]},t.prototype.addAcceptingState=function(t){this.finalStates.insert(t)},t.prototype.removeAcceptingState=function(t){this.finalStates.erase(t)},t.prototype.getAcceptingStates=function(){var t=[],e=this;return this.finalStates.forEach(function(i){t.push(e.stateList[i])}),t},t.prototype.getCurrentState=function(){if(null!==this.currentState)return this.stateList[this.currentState]},t.prototype.getStates=function(){return this.stateList.filter(function(t){return void 0!==t})},t.prototype.transitionIteration=function(t){var e=this;r.utils.foreach(this.transitions,function(i,n){r.utils.foreach(n,function(n,s){r.utils.foreach(s,function(s,r){for(var a=e.stateList[parseInt(i)],o=0,l=r;o<l.length;o++){var c=l[o],h=e.stateList[c[0]];t(a,[h,c[1]],n,s)}})})})},t.prototype.getInputAlphabet=function(){var t=[];for(var e in this.inputAlphabet)this.inputAlphabet.hasOwnProperty(e)&&t.push(e);return t},t.prototype.getStackAlphabet=function(){var t=[];for(var e in this.stackAlphabet)this.stackAlphabet.hasOwnProperty(e)&&t.push(e);return t},t.prototype.getStackContent=function(){return this.stack},t.prototype.setInput=function(t){this.input=t,this.stack=["$"],this.stepIndex=0,this.actionTree=this.getPossibleActions(),this.halt=!1},t.prototype.getCurrentInput=function(){return this.input},t.prototype.getActionTree=function(){for(var t=[],e=0,i=this.actionTree;e<i.length;e++){var n=i[e];t.push({stepIndex:n.stepIndex,currentInput:n.currentInput,currentStack:n.currentStack,inputRead:n.inputRead,stackWrite:n.stackWrite,targetState:this.stateList[n.targetState]})}return t},t.prototype.read=function(){if(!this.error()){var t=this.actionTree;if(0==this.input.length&&this.accepts())this.halt=!0;else{if(0==t.length)return this.currentState=null,this.input="",void(this.halt=!0);var e=t[t.length-1];this.processAction(e),this.actionTree.pop(),this.halt=!1;for(var i=this.getPossibleActions(),n=0,s=i;n<s.length;n++){var r=s[n];this.actionTree.push(r)}0==i.length&&0==this.input.length&&this.accepts()&&(this.halt=!0)}}},t.prototype.halted=function(){return this.halt},t.prototype.reset=function(){-1==this.initialState?this.currentState=null:this.currentState=this.initialState,this.stack=[],this.stepIndex=0,this.actionTree=[],this.halt=!0},t.prototype.clear=function(){this.stateList=[],this.inputAlphabet={},this.stackAlphabet={},this.transitions={},this.unsetInitialState(),this.finalStates.clear(),this.numRemovedStates=0,this.currentState=null,this.stack=[],this.stepIndex=0,this.actionTree=[],this.halt=!0},t.prototype.accepts=function(){if(null===this.currentState)return!1;var t=!1;return this.acceptingHeuristic&n.ACCEPTING_STATE&&(t=t||this.finalStates.contains(this.currentState)),this.acceptingHeuristic&n.EMPTY_STACK&&(t=t||0==this.stack.length),t},t.prototype.error=function(){return null===this.currentState},t.prototype.numStates=function(){return this.stateList.length-this.numRemovedStates},t.prototype.getPossibleActions=function(){var t=[];return this.input.length>0&&this.handleInputSymbol(this.input[0],t),this.handleInputSymbol("",t),t},t.prototype.handleInputSymbol=function(t,e){if(null!==this.currentState){var i=this.transitions[this.currentState];if(i.hasOwnProperty(t)){var n=i[t],s=this.stack[this.stack.length-1];if(n.hasOwnProperty(s))for(var a=0,o=n[s];a<o.length;a++){var l=o[a];e.push({stepIndex:this.stepIndex+1,currentInput:this.input,currentStack:r.utils.cloneArray(this.stack),inputRead:t,stackWrite:l[1],targetState:l[0]})}}}},t.prototype.processAction=function(t){this.stepIndex=t.stepIndex,this.input=t.currentInput,this.stack=t.currentStack,""!=t.inputRead&&(this.input=this.input.slice(1)),this.stack.pop();for(var e=0;e<t.stackWrite.length;e++)this.stack.push(t.stackWrite[e]);this.currentState=t.targetState},t.prototype.addSymbol=function(t,e){e.length>0&&(this[t].hasOwnProperty(e)||(this[t][e]=0),this[t][e]++)},t.prototype.addInputSymbol=function(t){this.addSymbol("inputAlphabet",t)},t.prototype.addStackSymbol=function(t){this.addSymbol("stackAlphabet",t)},t.prototype.removeSymbol=function(t,e){e.length>0&&(this[t][e]--,0==this[t][e]&&delete this[t][e])},t.prototype.removeInputSymbol=function(t){this.removeSymbol("inputAlphabet",t)},t.prototype.removeStackSymbol=function(t){this.removeSymbol("stackAlphabet",t)},t.prototype.realNumStates=function(){return this.stateList.length},t}();i.PDA=a},{"../../Utils":9,"../../datastructures/UnorderedSet":11}],38:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./PDA"),s=t("../../Keyboard"),r=t("../../Prompt"),a=t("../../Settings"),o=t("../../Utils"),l=function(){function t(){this.stateMapping={},this.stepIndex=-1,this.input=null,this.editingCallback=function(){},this.machine=new n.PDA}return t.prototype.edgePrompt=function(t,e){var i=this,n=new r.Prompt(a.Strings.PDA_ENTER_EDGE_CONTENT);return n.addInput({placeholder:a.Strings.PDA_ENTER_EDGE_PLACEHOLDER_1,validator:o.utils.optionalSymbolValidator}),n.addInput({placeholder:a.Strings.PDA_ENTER_EDGE_PLACEHOLDER_2,validator:o.utils.singleSymbolValidator}),n.addInput({placeholder:a.Strings.PDA_ENTER_EDGE_PLACEHOLDER_3}),n.onSuccess(function(e){t(e,i.edgeDataToText(e))}),n.onAbort(e),n},t.prototype.edgeDataToText=function(t){var e=s.Keyboard.symbols.epsilon;return(t[0]||e)+","+(t[1]||e)+" → "+(t[2]||e)},t.prototype.createState=function(t){var e=t.getName(),i=this.machine.addState(e);this.stateMapping[e]=i,t.isInitial()&&this.machine.setInitialState(i),t.isFinal()&&this.machine.addAcceptingState(i),this.editingCallback()},t.prototype.createEdge=function(t,e,i){var n=this.index(t),s=this.index(e);this.machine.addTransition(n,s,i),this.editingCallback()},t.prototype.changeInitialFlag=function(t){t.isInitial()?this.machine.setInitialState(this.index(t)):this.machine.unsetInitialState(),this.editingCallback()},t.prototype.changeFinalFlag=function(t){var e=this.index(t);t.isFinal()?this.machine.addAcceptingState(e):this.machine.removeAcceptingState(e),this.editingCallback()},t.prototype.renameState=function(t,e){var i=this.index(t);delete this.stateMapping[t.getName()],this.stateMapping[e]=i,this.machine.renameState(i,e),this.editingCallback()},t.prototype.deleteState=function(t){this.machine.removeState(this.index(t)),this.editingCallback()},t.prototype.deleteEdge=function(t,e,i){var n=this.index(t),s=this.index(e);this.machine.removeTransition(n,s,i),this.editingCallback()},t.prototype.clear=function(){this.machine.clear(),this.editingCallback()},t.prototype.fastForward=function(t){for(this.input=t,this.machine.reset(),this.machine.setInput(t);!this.machine.halted();)this.machine.read()},t.prototype.step=function(t){this.input=t,this.finished(t)||(-1==this.stepIndex?(this.machine.reset(),this.machine.setInput(t)):this.machine.read(),this.stepIndex++)},t.prototype.stop=function(){this.input=null,this.stepIndex=-1},t.prototype.reset=function(){this.machine.reset()},t.prototype.finished=function(t){return this.stepIndex>=0&&this.machine.halted()},t.prototype.isStopped=function(){return-1==this.stepIndex},t.prototype.stepPosition=function(){if(null===this.input)return this.stepIndex;var t=this.machine.getCurrentInput();return this.input.length-t.length},t.prototype.getStackContent=function(){return this.machine.getStackContent()},t.prototype.getActionTree=function(){return this.machine.getActionTree()},t.prototype.setAcceptingHeuristic=function(t){this.machine.setAcceptingHeuristic(t)},t.prototype.currentStates=function(){var t=this.machine.getCurrentState(),e=[];return this.machine.error()||e.push(t),e},t.prototype.accepts=function(){return this.machine.accepts()},t.prototype.formalDefinition=function(){var t=this.machine,e=s.Keyboard.symbols.delta,i=s.Keyboard.symbols.gamma,n=s.Keyboard.symbols.sigma,r={tupleSequence:["Q",n,i,e,"q0","Z0","F"],parameterSequence:["Q",n,i,"q0","Z0","F",e],parameterValues:{}},a=r.parameterValues;return a.Q=t.getStates(),a[n]=t.getInputAlphabet(),a[i]=t.getStackAlphabet(),a[e]=this.transitionTable(),a.q0=t.getInitialState(),a.Z0="$",a.F=t.getAcceptingStates(),r},t.prototype.setEditingCallback=function(t){this.editingCallback=t},t.prototype.applyOperation=function(t){},t.prototype.index=function(t){return this.stateMapping[t.getName()]},t.prototype.transitionTable=function(){var t=s.Keyboard.symbols,e=t.epsilon,i=t.gamma,n=["Q",t.sigma+" ∪ {"+e+"}",i,"Q",i+"*"],r={domain:[n[0],"("+n[1]+")",n[2]].join(" x "),codomain:[n[3],n[4]].join(" x "),header:n,list:[],metadata:[]};return this.machine.transitionIteration(function(t,e,i,n){var a=s.Keyboard.symbols.epsilon;i=i||a,n=n||a;var o=e[1]||a;r.list.push([t,i,n,e[0],o]),r.metadata.push([t,e[0]])}),r},t}();i.PDAController=l},{"../../Keyboard":3,"../../Prompt":5,"../../Settings":6,"../../Utils":9,"./PDA":37}],39:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../../Keyboard"),s=t("../../interface/Menu"),r=t("./PDA"),a=t("../../Settings"),o=t("../../SignalEmitter"),l=t("../../System"),c=t("../../interface/Table"),h=t("../../Utils"),u=function(){function t(){this.shortcutGroup="PDA",this.boundShortcuts=!1}return t.prototype.init=function(){var t=[this.buildRecognitionMenu(),this.buildStackContentMenu(),this.buildActionTreeMenu(),this.buildMultipleRecognitionMenu()];this.bindRecognitionEvents(),a.Settings.machines[a.Settings.Machine.PDA].sidebar=t},t.prototype.onEnter=function(){this.bindShortcuts(),l.System.unlockShortcutGroup(this.shortcutGroup)},t.prototype.onExit=function(){this.stopRecognition.click(),l.System.lockShortcutGroup(this.shortcutGroup)},t.prototype.buildRecognitionMenu=function(){var t=new s.Menu(a.Strings.RECOGNITION),e=[];return this.buildTestCaseInput(e),this.buildRecognitionControls(e),this.buildRecognitionOptions(e),this.buildRecognitionProgress(e),this.addRows(e,t),t},t.prototype.buildStackContentMenu=function(){var t=new s.Menu(a.Strings.STACK_MENUBAR),e=[];return this.buildStack(e),this.addRows(e,t),t},t.prototype.buildActionTreeMenu=function(){var t=new s.Menu(a.Strings.ACTION_TREE_MENUBAR),e=[];return this.buildActionTree(e),this.addRows(e,t),t},t.prototype.buildMultipleRecognitionMenu=function(){var t=new s.Menu(a.Strings.MULTIPLE_RECOGNITION),e=[];return this.buildMultipleRecognition(e),this.addRows(e,t),t},t.prototype.addRows=function(t,e){for(var i=0,n=t;i<n.length;i++){for(var s=n[i],r=h.utils.create("div",{className:"row"}),a=0,o=s;a<o.length;a++){var l=o[a];r.appendChild(l)}e.add(r)}},t.prototype.testCase=function(){return this.testCaseInput.value},t.prototype.buildTestCaseInput=function(t){var e=h.utils.create("input",{type:"text",placeholder:a.Strings.TEST_CASE});t.push([e]),this.testCaseInput=e},t.prototype.highlightCurrentStates=function(){var t=a.Settings.controller().currentStates();o.SignalEmitter.emitSignal({targetID:a.Settings.automatonRendererSignalID,identifier:"recognitionHighlight",data:[t]})},t.prototype.buildRecognitionControls=function(t){var e=a.Settings.disabledButtonClass;this.fastRecognition=h.utils.create("img",{className:"image_button",src:"images/fastforward.svg",title:a.Strings.FAST_RECOGNITION}),this.stopRecognition=h.utils.create("img",{className:"image_button "+e,src:"images/stop.svg",title:a.Strings.STOP_RECOGNITION}),this.stepRecognition=h.utils.create("img",{className:"image_button",src:"images/play.svg",title:a.Strings.STEP_RECOGNITION}),t.push([this.fastRecognition,this.stepRecognition,this.stopRecognition])},t.prototype.buildRecognitionOptions=function(t){this.finalStateCheckbox=h.utils.create("input",{checked:!0,type:"checkbox"});var e=h.utils.create("span",{innerHTML:a.Strings.ACCEPT_BY_FINAL_STATE});this.emptyStackCheckbox=h.utils.create("input",{type:"checkbox"});var i=h.utils.create("span",{innerHTML:a.Strings.ACCEPT_BY_EMPTY_STACK});t.push([this.finalStateCheckbox,e]),t.push([this.emptyStackCheckbox,i])},t.prototype.buildStack=function(t){this.stackContainer=h.utils.create("div",{className:"none",id:"stack"}),this.stackContainer.innerHTML=a.Strings.NO_RECOGNITION_IN_PROGRESS,t.push([this.stackContainer])},t.prototype.buildActionTree=function(t){this.actionTreeContainer=h.utils.create("div",{className:"none",id:"action_tree"}),this.actionTreeContainer.innerHTML=a.Strings.NO_RECOGNITION_IN_PROGRESS,t.push([this.actionTreeContainer])},t.prototype.buildRecognitionProgress=function(t){this.progressContainer=h.utils.create("div",{id:"recognition_progress"}),this.progressContainer.style.display="none",t.push([this.progressContainer])},t.prototype.buildMultipleRecognition=function(t){this.multipleCaseArea=h.utils.create("textarea"),this.multipleCaseArea.rows=a.Settings.multRecognitionAreaRows,this.multipleCaseArea.cols=a.Settings.multRecognitionAreaCols,this.multipleCaseResults=h.utils.create("div");var e=h.utils.create("div",{id:"multiple_recognition"});e.appendChild(this.multipleCaseArea),e.appendChild(this.multipleCaseResults),t.push([e]),this.multipleCaseButton=h.utils.create("img",{className:"image_button",src:"images/play.svg",title:a.Strings.START_MULTIPLE_RECOGNITION}),t.push([this.multipleCaseButton])},t.prototype.showAcceptanceStatus=function(){a.Settings.controller().accepts()?(this.progressContainer.style.color=a.Settings.acceptedTestCaseColor,this.progressContainer.innerHTML=a.Strings.INPUT_ACCEPTED):(this.progressContainer.style.color=a.Settings.rejectedTestCaseColor,this.progressContainer.innerHTML=a.Strings.INPUT_REJECTED)},t.prototype.showStackContent=function(){var t=a.Settings.controller().getStackContent();if(t.length>0){this.stackContainer.classList.remove("none"),this.stackContainer.innerHTML="";for(var e=t.length-1;e>=0;e--){var i=h.utils.create("span");i.innerHTML=t[e],this.stackContainer.appendChild(i)}this.stackContainer.children[0].classList.add("top")}else this.stackContainer.classList.add("none"),this.stackContainer.innerHTML=a.Strings.EMPTY_STACK},t.prototype.showActionTree=function(){var t=a.Settings.controller().getActionTree(),e=n.Keyboard.symbols.epsilon;0==t.length?(this.actionTreeContainer.classList.add("none"),this.actionTreeContainer.innerHTML=a.Strings.ACTION_TREE_NO_ACTIONS):(this.actionTreeContainer.classList.remove("none"),this.actionTreeContainer.innerHTML="");for(var i=0,s=t;i<s.length;i++){for(var r=s[i],o=h.utils.create("div",{className:"entry"}),l=h.utils.cloneArray(r.currentStack).reverse().join(""),u=new c.Table(2),p=0,d=[a.Strings.PDA_FIELD_INPUT,r.currentInput,a.Strings.PDA_FIELD_STACK,l,a.Strings.PDA_FIELD_READ_INPUT,r.inputRead||e,a.Strings.PDA_FIELD_WRITE,r.stackWrite||e,a.Strings.PDA_FIELD_TARGET_STATE,r.targetState.toString()];p<d.length;p++){var g=d[p],f=h.utils.create("span",{innerHTML:g});0==g.length&&(f.classList.add("none"),f.innerHTML=a.Strings.EMPTY),u.add(f)}o.appendChild(u.html()),this.actionTreeContainer.appendChild(o)}},t.prototype.clearStackContent=function(){this.stackContainer.classList.add("none"),this.stackContainer.innerHTML=a.Strings.NO_RECOGNITION_IN_PROGRESS},t.prototype.clearActionTree=function(){this.actionTreeContainer.classList.add("none"),this.actionTreeContainer.innerHTML=a.Strings.NO_RECOGNITION_IN_PROGRESS},t.prototype.bindRecognitionEvents=function(){var t=a.Settings.disabledButtonClass,e=!0,i=!0,n=!1,s=!0,l=!1,c=this,u=h.utils.create("span",{className:"parsed_input"}),p=h.utils.create("span",{className:"remaining_input"}),d=!1,g=function(i){e=i,c.fastRecognition.classList[i?"remove":"add"](t)},f=function(e){i=e,c.stepRecognition.classList[e?"remove":"add"](t)},S=function(e){n=e,c.stopRecognition.classList[e?"remove":"add"](t)},y=function(){var t;t=s&&l?r.AcceptingHeuristic.BOTH:s?r.AcceptingHeuristic.ACCEPTING_STATE:l?r.AcceptingHeuristic.EMPTY_STACK:r.AcceptingHeuristic.NEVER,a.Settings.controller().setAcceptingHeuristic(t)};this.fastRecognition.addEventListener("click",function(){if(e){o.SignalEmitter.emitSignal({targetID:a.Settings.automatonRendererSignalID,identifier:"lock",data:[]});var t=c.testCase();a.Settings.controller().fastForward(t),c.highlightCurrentStates(),c.progressContainer.style.display="",d=!1,c.showAcceptanceStatus(),c.showStackContent(),c.showActionTree(),g(!1),f(!1),S(!0),c.testCaseInput.disabled=!0}}),this.stopRecognition.addEventListener("click",function(){n&&(a.Settings.controller().stop(),o.SignalEmitter.emitSignal({targetID:a.Settings.automatonRendererSignalID,identifier:"recognitionDim",data:[]}),o.SignalEmitter.emitSignal({targetID:a.Settings.automatonRendererSignalID,identifier:"unlock",data:[]}),c.progressContainer.style.color="black",c.progressContainer.style.display="none",c.clearStackContent(),c.clearActionTree(),g(!0),f(!0),S(!1),c.testCaseInput.disabled=!1)}),this.stepRecognition.addEventListener("click",function(){if(i){g(!1),S(!0),c.testCaseInput.disabled=!0;var t=c.testCase(),e=a.Settings.controller();e.isStopped()&&(e.reset(),o.SignalEmitter.emitSignal({targetID:a.Settings.automatonRendererSignalID,identifier:"lock",data:[]}),c.progressContainer.style.display="",c.stackContainer.classList.remove("none"),c.actionTreeContainer.classList.remove("none"));var n=e.finished(t);if(n||(e.step(t),c.highlightCurrentStates(),n=e.finished(t),c.showStackContent(),c.showActionTree()),n)f(!1),d=!1,c.showAcceptanceStatus(),c.clearActionTree();else{var s=e.stepPosition();d||(c.progressContainer.innerHTML="",c.progressContainer.appendChild(u),c.progressContainer.appendChild(p),d=!0),u.innerHTML=t.substr(0,s),p.innerHTML=t.substr(s)}}}),this.multipleCaseButton.addEventListener("click",function(){var t=c.multipleCaseArea.value.split("\n"),e=a.Settings.controller();c.multipleCaseResults.innerHTML="";for(var i=0,n=t;i<n.length;i++){var s=n[i];e.fastForward(s);var r=h.utils.create("span");e.accepts()?(r.style.color=a.Settings.acceptedTestCaseColor,r.innerHTML=a.Strings.INPUT_ACCEPTED):(r.style.color=a.Settings.rejectedTestCaseColor,r.innerHTML=a.Strings.INPUT_REJECTED),c.multipleCaseResults.appendChild(r)}}),this.finalStateCheckbox.addEventListener("change",function(t){s=this.checked,y()}),this.emptyStackCheckbox.addEventListener("change",function(t){l=this.checked,y()})},t.prototype.bindShortcuts=function(){var t=this;this.boundShortcuts||(l.System.bindShortcut(a.Settings.shortcuts.focusTestCase,function(){t.testCaseInput.focus()},this.shortcutGroup),l.System.bindShortcut(a.Settings.shortcuts.fastForward,function(){t.fastRecognition.click()},this.shortcutGroup),l.System.bindShortcut(a.Settings.shortcuts.step,function(){t.stepRecognition.click()},this.shortcutGroup),l.System.bindShortcut(a.Settings.shortcuts.stop,function(){t.stopRecognition.click()},this.shortcutGroup),this.boundShortcuts=!0),this.testCaseInput.addEventListener("keydown",function(e){var i=a.Settings.shortcuts.dimTestCase[0];e.keyCode==n.Keyboard.keys[i]&&t.testCaseInput.blur()})},t}();i.initPDA=u},{"../../Keyboard":3,"../../Settings":6,"../../SignalEmitter":7,"../../System":8,"../../Utils":9,"../../interface/Menu":17,"../../interface/Table":21,"./PDA":37}],40:[function(t,e,i){"use strict";function n(t,e){for(var i=0;t[i]==e[i];)i++;return[t.substr(i),e.substr(i)]}function s(t){function e(t){return t.split("").reverse().join("")}var i=/[A-Za-z]+\.[A-Za-z0-9]+(.*)/,n=e(t).match(i);return null===n?"":e(n[1].substr(1))}i.__esModule=!0;var r=t("./Settings"),a=t("./System"),o=t("./interface/UI"),l=t("./Utils");r.Settings.update(),$(document).ready(function(){var t=l.utils.id(r.Settings.mainbarID);if(0!=t.innerHTML.length){t.innerHTML="",l.utils.id(r.Settings.sidebarID).innerHTML="";var e=document.getElementsByTagName("link")[0],i=document.getElementsByTagName("script")[0],c=n(e.href,i.src),h=c[0],u=c[1],p=s(h),d=s(u);console.log("[LIB]",p),console.log("[SRC]",d)}(new o.UI).render();var g=function(){var t=$("body").height()-$("#footer").height();$("#wrapper").css("height",t),$("#sidebar").css("height",t),$("#sidebar_content").css("max-height",t)};$(window).resize(g),g(),document.body.addEventListener("keydown",function(t){var e=document.activeElement.tagName.toLowerCase();return-1!=["input","textarea"].indexOf(e)||a.System.keyEvent(t)})})},{"./Settings":6,"./System":8,"./Utils":9,"./interface/UI":22}],41:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../interface/Edge"),s=t("../interface/EdgeUtils"),r=t("../Settings"),a=t("../SignalEmitter"),o=t("../interface/State"),l=t("../Utils"),c=function(){function t(){}return t.prototype.save=function(t,e,i){for(var n=[r.Settings.Machine[r.Settings.currentMachine],[],[],-1],s=0,a=0,o=t;a<o.length;a++){var l=o[a],c=l.getPosition();n[1].push([l.getName(),l.isFinal()?1:0,c.x,c.y]),l==i&&(n[3]=s),s++}for(var h=0,u=e;h<u.length;h++){var p=u[h];n[2].push([p.getOrigin().getName(),p.getTarget().getName(),p.getDataList()])}return JSON.stringify(n)},t.prototype.load=function(t){var e={aborted:!1,error:!1,initialState:null,stateList:[],edgeList:[]},i=[];try{i=JSON.parse(t)}catch(t){return e.error=!0,e}var n=r.Settings.Machine[r.Settings.currentMachine];if(!(i[1]instanceof Array&&i[2]instanceof Array&&"number"==typeof i[3]&&4==i.length))return e.error=!0,e;if(i[0]!=n){if(!confirm(r.Strings.DIFFERENT_MACHINE_FILE))return e.aborted=!0,e;l.utils.foreach(r.Settings.machines,function(t,e){return e.abbreviatedName!=i[0]||(a.SignalEmitter.emitSignal({targetID:r.Settings.sidebarSignalID,identifier:"changeMachineType",data:[t]}),!1)})}var s={},o=this.loadStates(i,e,function(t){s[t.getName()]={}});return this.loadEdges(i,e,o,s)?e:(e.error=!0,e)},t.prototype.loadStates=function(t,e,i){for(var n={},s=r.Settings.controller(),a=0,l=0,c=t[1];l<c.length;l++){var h=c[l],u=t[3]==a,p=new o.State;p.setName(h[0]),p.setInitial(u),p.setFinal(!!h[1]),p.setPosition(h[2],h[3]),u&&(e.initialState=p),n[h[0]]=a,i(p),e.stateList.push(p),s.createState(p),a++}return n},t.prototype.loadEdges=function(t,e,i,r){for(var a=e.stateList,o=0,l=t[2];o<l.length;o++){var c=l[o];if(3!=c.length)return!1;var h=new n.Edge,u=c[0],p=c[1],d=a[i[u]],g=a[i[p]];h.setOrigin(d),h.setTarget(g),r[p].hasOwnProperty(u)&&(r[p][u].setCurveFlag(!0),h.setCurveFlag(!0));for(var f=0,S=c[2];f<S.length;f++){var y=S[f];s.EdgeUtils.addEdgeData(h,y)}r[u][p]=h,e.edgeList.push(h)}return!0},t}();i.JSONHandler=c},{"../Settings":6,"../SignalEmitter":7,"../Utils":9,"../interface/Edge":13,"../interface/EdgeUtils":14,"../interface/State":20}]},{},[40]);
